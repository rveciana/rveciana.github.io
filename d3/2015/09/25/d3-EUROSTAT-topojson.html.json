{"title":"Mapping EUROSTAT data with D3js: Creating the TopoJSON","contents":"<img width=\"50%\" src=\"/images/d3/d3-nuts/example.png\"/>\n\n<p><a href=\"http://ec.europa.eu/eurostat/statistics-explained/images/a/ae/Urban_rural_typology_for_NUTS3_new.png\">click to see the original map by EUROSTAT</a></p>\n<h2 id=\"creating-nuts-regions-file\">Creating NUTS regions file</h2>\n<p><a href=\"http://ec.europa.eu/eurostat/web/gisco/geodata/reference-data/administrative-units-statistical-units\">Download the NUTS regions in shp format</a></p>\n<p>It&#39;s interesting to have the population associated to each region, so the absolute number of some statistics can be changed to density (number of crimes to crimes/100000 people, for instance). The population data can be downloaded from <a href=\"http://appsso.eurostat.ec.europa.eu/nui/show.do?dataset=demo_r_pjanaggr3&amp;lang=en\">this url</a>:</p>\n<p>Select the population columns\nFormat-&gt;numerical format-&gt;number 11.000.638 --&gt; 11000638\nSave as csv\nRemove headers and appended data</p>\n<p>The header will be:</p>\nGEO,GEO(L)/TIME,2010,2011,2012,2013,2014<p>And I changed it to</p>\nid,name,pop2010,pop2011,pop2012,pop2013,pop2014<p>The reason is that the <em>topojson</em> program failed to take numeric column names (2013, in our case), and the complex <em>GEO(L)/TIME</em>.</p>\n<p>To separate the data into different files for each NUTS level, so the file to load from the browser is smaller:</p>\nogr2ogr  -where &quot;STAT_LEVL_=1&quot; nuts1.shp NUTS_RG_01M_2013.shp<p>For level 1. To get all the levels, levels 0,1,2,3 must be generated.</p>\n<p>To create the final topoJSON for nuts level 1, type:</p>\ntopojson -e demo_r_pjanaggr3.csv --id-property NUTS_ID,id -p nuts_id=NUTS_ID,name,population=+pop2013 -o nuts1.json -- nuts1.shp<h2 id=\"using-the-generated-files\">Using the generated files</h2>\n<p>If yo don&#39;t want to create the same topojson, you can just get them from <a href=\"https://gist.github.com/rveciana/5919944\">this GIST</a>, with the names nuts0.json, nuts1.json, etc.</p>\n<p><a href=\"http://bl.ocks.org/rveciana/4bcc5750c776c22ffda6\">Here</a>, you can see a <a href=\"http://bl.ocks.org/rveciana/4bcc5750c776c22ffda6\">working example</a> too, that gives this result: <img  src=\"/images/d3/d3-nuts/example-gist.png\"/></p>\n","tags":["EUROSTAT","Open Data"],"date":"2015-09-25T00:00:00.000Z"}