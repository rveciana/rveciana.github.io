<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-36383259-2"></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());
		
		  gtag('config', 'UA-36383259-2');
		</script>
		
		<meta charset="utf-8" />
		<link rel="icon" href="/favicon.ico" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="manifest" href="/manifest.json" />
		<meta name="theme-color" content="#cdffcd">
		<!-- HTML Meta Tags -->
		<title>GeoExamples - Roger Veciana</title>
		<meta
			name="description"
			content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time."
		/>
		<!-- Google / Search Engine Tags -->
		<meta itemprop="name" content=">GeoExamples - Roger Veciana" />
		<meta
			itemprop="description"
			content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time."
		/>
		<meta itemprop="image" content="https://geoexamples.com/siteImage.png" />
		<!-- Facebook Meta Tags -->
		<meta property="og:url" content="https://geoexamples.com" />
		<meta property="og:type" content="website" />
		<meta property="og:title" content="GeoExamples - Roger Veciana" />
		<meta
			property="og:description"
			content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time."
		/>
		<meta property="og:image" content="https://geoexamples.com/siteImage.png" />
		<!-- Twitter Meta Tags -->
		<meta name="twitter:card" content="summary" />
		<meta name="twitter:title" content="GeoExamples - Roger Veciana" />
		<meta name="twitter:description"
		  content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time." />
		<meta name="twitter:image" content="https://geoexamples.com/siteImage.png" />
		



<link rel="modulepreload" href="/./staticApp/start-44631b0b.js">
			<link rel="modulepreload" href="/./staticApp/chunks/vendor-ff3d1764.js">
			<link rel="modulepreload" href="/./staticApp/chunks/config-b3bde751.js">
			<link rel="modulepreload" href="/./staticApp/pages\[category]\[year]\[month]\[date]\[slug].svelte-a77716b3.js">
			<link rel="stylesheet" href="/./staticApp/assets/start-34a290f9.css">


		<script type="module">
			import { start } from "/./staticApp/start-44631b0b.js";
			start({
				target: document.querySelector("#svelte"),
				paths: {"base":"","assets":"/."},
				session: {},
				host: location.host,
				route: true,
				hydrate: {
					status: 200,
					error: null,
					nodes: [
						import("/./staticApp/pages\\[category]\\[year]\\[month]\\[date]\\[slug].svelte-a77716b3.js")
					],
					page: {
						host: location.host, // TODO this is redundant
						path: "/svelte/2020/08/05/svelte-konva-mapping.html",
						query: new URLSearchParams(""),
						params: {"category":"svelte","year":"2020","month":"08","date":"05","slug":"svelte-konva-mapping.html"}
					}
				}
			});
		</script>
	</head>
	<body>
		<div id="svelte">


<header class="site-header"><div class="wrapper"><a class="site-title" href="/">GeoExamples - Roger Veciana</a>

<nav class="site-nav"><div href="#" class="menu-icon"><svg viewBox="0 0 18 15"><path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path><path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path><path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path></svg></div>

	<div class="trigger"><a class="page-link" href="/about">About</a><a class="page-link" href="/blog">Blog</a><a class="page-link" href="/projects">Projects</a></div></nav></div></header>

<main class="page-content"><div class="wrapper"><div class="post"><header class="post-header"><h1 class="post-title">Mapping with Svelte and Konva</h1>
<p class="post-meta">Aug 5, 2020</p></header>

	<article class="post-content"><p>After some attempts <a href="https://geoexamples.com/other/2019/12/08/mapping-svelte.html">mapping with Svelte</a>, I missed using canvas instead of SVG. SVG has the advantage that integrates very well with Svelte, since it&#39;s an XML and the nodes can be managed as if they were HTML. On the other hand, Canvas is more efficient, but it has to be generated entirely with JavaScript.</p>
<p>At the same time, I found <a href="https://konvajs.org/">Konva</a>, a promising library to draw Canvas elements and make them interactive in an easy way. It allows animations, Drag and Drop, actions, filters, etc. so it&#39;s possible to do the same things as in SVG. I didn&#39;t find any example of Konva for drawing maps, so here we&#39;ll find a declarative way to do it, using Svelte.</p>
<h1 id="using-konva-with-svelte">Using Konva with Svelte</h1>
<p>Let&#39;s see first how to plot <em>something</em> using Konva and Svelte. <a href="https://svelte.dev/repl/75082b2a3383482d969f99b509f9b7a4?version=3.24.1">You can check the source code at Svelte REPL</a>. Be patient, since it has to load the npm modules!</p>
<p>The code here is short, and we have only one component:</p>
<p><pre><code>
<span class="token operator">&lt;</span>script<span class="token operator">></span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span>onMount<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'svelte'</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> Konva <span class="token keyword">from</span> <span class="token string">'konva'</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> container<span class="token punctuation">;</span>
    <span class="token function">onMount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> stage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Konva<span class="token punctuation">.</span>Stage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        container<span class="token operator">:</span> container<span class="token punctuation">,</span>
        width<span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
        height<span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> layer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Konva<span class="token punctuation">.</span>Layer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> simpleText <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Konva<span class="token punctuation">.</span>Text</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        x<span class="token operator">:</span> stage<span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span>
        y<span class="token operator">:</span> <span class="token number">15</span><span class="token punctuation">,</span>
        text<span class="token operator">:</span> <span class="token string">'Hello Konva'</span><span class="token punctuation">,</span>
        fontSize<span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
        fontFamily<span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span>
        fill<span class="token operator">:</span> <span class="token string">'green'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        layer<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>simpleText<span class="token punctuation">)</span><span class="token punctuation">;</span>
        stage<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>layer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>

<span class="token operator">&lt;</span>div bind<span class="token operator">:</span><span class="token keyword">this</span><span class="token operator">=</span><span class="token punctuation">{</span>container<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
</code></pre>

<ul>
<li>Note how the <em>div</em> container is binded to the variable</li>
<li>Since the component has to be binded, we&#39;ll have to wait until the component is mounted to create the Konva elements</li>
<li>Konva needs a <em>Stage</em> (cimilar to the Canvas element), one or more <em>Layer</em>, where you can actually draw the objects, and any shape, text or whatever we want to draw.</li>
</ul>
<h1 id="konva-as-svelte-components">Konva as Svelte components</h1>
<p>The example is not bad, but it&#39;s not using any Svelte style coding. It would be cool declaring things like:
<pre><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Stage</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Layer</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Element</span> <span class="token attr-name">x</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>100</span> <span class="token attr-name">y</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span>100/</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Layer</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Stage</span><span class="token punctuation">></span></span>
</code></pre></p>
<p>Then, we could use a store to put as many elements as we wanted, for instance. Let&#39;s see how to to that. <a href="https://svelte.dev/repl/db922f45dff8483082e18d6555ad5b50?version=3.24.1">Check the interactive example here</a></p>
<img src="/images/svelte/svelte-konva-mapping/circles.png"/>

<p>We&#39;ll create a component for the Stage, another for the Layer and finally, a Circle component that acually draws a circle.</p>
<p>The Stage component is like this:</p>
<p><pre><code>
<span class="token operator">&lt;</span>script<span class="token operator">></span>
    <span class="token keyword">import</span> Konva <span class="token keyword">from</span> <span class="token string">'konva'</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span> onMount<span class="token punctuation">,</span> setContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'svelte'</span><span class="token punctuation">;</span>

    <span class="token function">setContext</span><span class="token punctuation">(</span><span class="token string">"konva"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">getStage</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> stage
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> container<span class="token punctuation">;</span>
    <span class="token keyword">let</span> stage<span class="token punctuation">;</span> 
    <span class="token function">onMount</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
     stage <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Konva<span class="token punctuation">.</span>Stage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        container<span class="token operator">:</span> container<span class="token punctuation">,</span>
        width<span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
        height<span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>

<span class="token operator">&lt;</span>pre<span class="token operator">></span><span class="token operator">&lt;</span>code<span class="token operator">></span><span class="token operator">&lt;</span>div bind<span class="token operator">:</span><span class="token keyword">this</span><span class="token operator">=</span><span class="token punctuation">{</span>container<span class="token punctuation">}</span><span class="token operator">></span>
    <span class="token punctuation">{</span>#<span class="token keyword">if</span> container<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>slot<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">></span>
    <span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword">if</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>code<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
</code></pre>

<ul>
<li>As in the other case, you&#39;ll see that we need to create the node where we&#39;ll add all the stuff, plus the binding.</li>
<li>The slot will allow us to add children components. Layers in this case.</li>
<li>We create a context. This way, the Layer component will have access to the <em>Konva stage</em> object without passing it in the props. Since this component won&#39;t be touched when creating new drawings, it&#39;s much cleaner.</li>
</ul>
<p>Then the Layer component:</p>
<p><pre><code>
<span class="token operator">&lt;</span>script<span class="token operator">></span>
    <span class="token keyword">import</span> Konva <span class="token keyword">from</span> <span class="token string">'konva'</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span> getContext<span class="token punctuation">,</span> setContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'svelte'</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> getStage <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"konva"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setContext</span><span class="token punctuation">(</span><span class="token string">"konva_layer"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">getLayer</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> layer
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> stage <span class="token operator">=</span> <span class="token function">getStage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> layer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Konva<span class="token punctuation">.</span>Layer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    stage<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>layer<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>


<span class="token operator">&lt;</span>slot<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>slot<span class="token operator">></span>
</code></pre></p>
<ul>
<li>This one is much simpler, since we don&#39;t have to create HTML elements.</li>
<li>We create another context for the layer, so its children can have access to it.</li>
</ul>
<p>Finally, the Circle component is:</p>
<p><pre><code>
<span class="token operator">&lt;</span>script<span class="token operator">></span>
    <span class="token keyword">import</span> Konva <span class="token keyword">from</span> <span class="token string">'konva'</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span> getContext<span class="token punctuation">,</span> onDestroy <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'svelte'</span><span class="token punctuation">;</span>

    <span class="token keyword">export</span> <span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">let</span> y <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">let</span> r <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">let</span> fill <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">let</span> stroke <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">let</span> strokeWidth <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token punctuation">{</span> getLayer <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"konva_layer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> layer <span class="token operator">=</span> <span class="token function">getLayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> circle <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Konva<span class="token punctuation">.</span>Circle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        x<span class="token operator">:</span> x<span class="token punctuation">,</span>
        y<span class="token operator">:</span> y<span class="token punctuation">,</span>
        radius<span class="token operator">:</span> r<span class="token punctuation">,</span>
        fill<span class="token operator">:</span> fill<span class="token punctuation">,</span>
        stroke<span class="token operator">:</span> stroke<span class="token punctuation">,</span>
        strokeWidth<span class="token operator">:</span> strokeWidth<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    layer<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>circle<span class="token punctuation">)</span><span class="token punctuation">;</span>
    layer<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> circle<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>


</code></pre></p>
<ul>
<li>We export most of the parameters so they can be used as props, although they have a default value</li>
<li>We have to call <em>layer.draw()</em> or the object won&#39;t be drawn. That&#39;s because we are creating it before the layer is added into the stage.</li>
<li>We have to destroy the object on deleting the component, or we&#39;ll have memory leaks. Think if we had hundreds of circles appearing and disappearing when a store value changes...</li>
</ul>
<p>And now the cool part. To create the drawing, we only call:</p>
<p><pre><code>
<span class="token operator">&lt;</span>Stage<span class="token operator">></span>
<span class="token operator">&lt;</span>Layer<span class="token operator">></span>
<span class="token operator">&lt;</span>Circle x<span class="token operator">=</span><span class="token number">100</span> y<span class="token operator">=</span><span class="token number">100</span> r<span class="token operator">=</span><span class="token number">23</span> fill<span class="token operator">=</span><span class="token string">"red"</span> strokeWidth<span class="token operator">=</span><span class="token number">3</span><span class="token operator">/</span><span class="token operator">></span>
<span class="token operator">&lt;</span>Circle x<span class="token operator">=</span><span class="token number">200</span> y<span class="token operator">=</span><span class="token number">200</span> r<span class="token operator">=</span><span class="token number">13</span> fill<span class="token operator">=</span><span class="token string">"green"</span> strokeWidth<span class="token operator">=</span><span class="token number">3</span><span class="token operator">/</span><span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Layer<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Stage<span class="token operator">></span>
</code></pre></p>
<h1 id="creating-a-map">Creating a map</h1>
<p>So now, with the knowledge from the previous examples, we can create a map. <a href="https://svelte.dev/repl/7c3e009c6f82414aa011a313b76a5eeb?version=3.24.1">I created an intermediate (simpler) version of the map, in case somebody wants to take a look</a>. <a href="https://svelte.dev/repl/8f38e2c895284c13a3e3f534d01dd171?version=3.24.1">The final version is here</a>.</p>
<img src="/images/svelte/svelte-konva-mapping/map.png"/>

<p>Let&#39;s start from the other side now! The App.svelte file is this one:</p>
<p><pre><code>
<span class="token operator">&lt;</span>script<span class="token operator">></span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span>onMount<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'svelte'</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> Stage <span class="token keyword">from</span> <span class="token string">'./Stage.svelte'</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> Layer <span class="token keyword">from</span> <span class="token string">'./Layer.svelte'</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> Marker <span class="token keyword">from</span> <span class="token string">'./Marker.svelte'</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> BackgroundMap <span class="token keyword">from</span> <span class="token string">'./BackgroundMap.svelte'</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./store.js'</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> message_value<span class="token punctuation">;</span>
    message<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        message_value <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>

<span class="token operator">&lt;</span>Stage<span class="token operator">></span>
    <span class="token operator">&lt;</span>Layer<span class="token operator">></span>
        <span class="token operator">&lt;</span>BackgroundMap <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Layer<span class="token operator">></span>
    <span class="token operator">&lt;</span>Layer<span class="token operator">></span>
        <span class="token operator">&lt;</span>Marker lon<span class="token operator">=</span><span class="token operator">-</span><span class="token number">43.1</span> lat<span class="token operator">=</span><span class="token operator">-</span><span class="token number">22.9068</span> fill<span class="token operator">=</span><span class="token string">"green"</span> markerMessage<span class="token operator">=</span><span class="token string">"Marker: Rio de Janeiro"</span><span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>Marker lon<span class="token operator">=</span><span class="token number">2</span> lat<span class="token operator">=</span><span class="token number">41</span> fill<span class="token operator">=</span><span class="token string">"green"</span> markerMessage<span class="token operator">=</span><span class="token string">"Marker: Barcelona"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Layer<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Stage<span class="token operator">></span>


    <span class="token punctuation">{</span>message_value<span class="token punctuation">}</span>

</code></pre>

<ul>
<li>We are using a <em>BackgroundMap</em> component and as many <em>Marker</em> components as we want.</li>
<li>There&#39;s a writable store where the children will put the name of the hovered feature. In the App component we&#39;ll just render it.</li>
<li>I use two layers because when using one, the markers can&#39;t be detected if they are over a country. z-index is not well managed in konvas.</li>
</ul>
<p>The projection and D3 GeoPath are defined in their own file so they can be accessed from all the components:</p>
<p><pre><code>
<span class="token keyword">import</span> <span class="token punctuation">{</span> geoPath <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>d3<span class="token operator">-</span>geo<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> geoAitoff <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>d3<span class="token operator">-</span>geo<span class="token operator">-</span>projection<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> width <span class="token operator">=</span> <span class="token number">600</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> height <span class="token operator">=</span> <span class="token number">400</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> projection <span class="token operator">=</span> <span class="token function">geoAitoff</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">translate</span><span class="token punctuation">(</span><span class="token punctuation">[</span>width <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> height <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">geoPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">projection</span><span class="token punctuation">(</span>projection<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></p>
<ul>
<li>The size and zooms are fixed. If we wanted a more complex map, we could make this a store and then chenge the values from a slider or a mouse event</li>
</ul>
<p>The BackgroundMap component is:</p>
<p><pre><code>
<span class="token operator">&lt;</span>script<span class="token operator">></span>
<span class="token keyword">import</span> Konva <span class="token keyword">from</span> <span class="token string">'konva'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getContext<span class="token punctuation">,</span> onMount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'svelte'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> feature <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"topojson"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> path <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./projection'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./store.js'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> getLayer <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"konva_layer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> layer <span class="token operator">=</span> <span class="token function">getLayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">onMount</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>
      <span class="token string">"https://gist.githubusercontent.com/denisemauldin/a2fa29af082e85dfaf27d100be01fa47/raw/6b3a5b9b29151739964612c8a7cff23707386d84/readme-world-110m.json"</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> json <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> topoData <span class="token operator">=</span> <span class="token function">feature</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> json<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>countries<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> data <span class="token operator">=</span> topoData<span class="token punctuation">.</span>features<span class="token punctuation">;</span>
    data<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">country</span> <span class="token operator">=></span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> konvaPath <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Konva<span class="token punctuation">.</span>Path</span><span class="token punctuation">(</span><span class="token punctuation">{</span>

        data<span class="token operator">:</span> <span class="token function">path</span><span class="token punctuation">(</span>country<span class="token punctuation">)</span><span class="token punctuation">,</span>
        stroke<span class="token operator">:</span> <span class="token string">'black'</span><span class="token punctuation">,</span>
            strokeWidth<span class="token operator">:</span> <span class="token number">0.5</span>

            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        konvaPath<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mouseover'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        message<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>country<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        layer<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>konvaPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span>

        layer<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>


</code></pre></p>
<ul>
<li>We can only draw when the file with the data is downloaded, so we&#39;ll put this in an <em>onMount</em> element</li>
<li>We iterate for each country and create a Konva element for it. So we&#39;ll have hundreds of them here.</li>
<li>Note how Konva handles the <em>mouseover</em> event.</li>
</ul>
<p>Finally, the markers with animation:</p>
<p><pre><code>
<span class="token operator">&lt;</span>script<span class="token operator">></span>
    <span class="token keyword">import</span> Konva <span class="token keyword">from</span> <span class="token string">'konva'</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span> projection <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./projection'</span><span class="token punctuation">;</span>
  <span class="token keyword">import</span> <span class="token punctuation">{</span> message <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./store.js'</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span> getContext<span class="token punctuation">,</span> onDestroy <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'svelte'</span><span class="token punctuation">;</span>

    <span class="token keyword">export</span> <span class="token keyword">let</span> lon <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">let</span> lat <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">let</span> fill <span class="token operator">=</span> <span class="token string">"black"</span><span class="token punctuation">;</span>
    <span class="token keyword">export</span> <span class="token keyword">let</span> markerMessage <span class="token operator">=</span> <span class="token string">"Marker"</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> coords <span class="token operator">=</span> <span class="token function">projection</span><span class="token punctuation">(</span><span class="token punctuation">[</span>lon<span class="token punctuation">,</span> lat<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token punctuation">{</span> getLayer <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">"konva_layer"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> layer <span class="token operator">=</span> <span class="token function">getLayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> konvaPath <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Konva<span class="token punctuation">.</span>Star</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        x<span class="token operator">:</span> coords<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        y<span class="token operator">:</span> coords<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        fill<span class="token operator">:</span> fill<span class="token punctuation">,</span>
            strokeWidth<span class="token operator">:</span> <span class="token number">0.5</span><span class="token punctuation">,</span>
        numPoints<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        innerRadius<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        outerRadius<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>

            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    konvaPath<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'mouseover'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        message<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>markerMessage<span class="token punctuation">)</span>
     <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    layer<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>konvaPath<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> angularSpeed <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> anim <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Konva<span class="token punctuation">.</span>Animation</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">frame</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> angleDiff <span class="token operator">=</span> <span class="token punctuation">(</span>frame<span class="token punctuation">.</span>timeDiff <span class="token operator">*</span> angularSpeed<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">;</span>
        konvaPath<span class="token punctuation">.</span><span class="token function">rotate</span><span class="token punctuation">(</span>angleDiff<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> layer<span class="token punctuation">)</span><span class="token punctuation">;</span>

      anim<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    layer<span class="token punctuation">.</span><span class="token function">draw</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> konvaPath<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>


</code></pre></p>
<ul>
<li>Very similar to the circle case, but with a Star element in this case.</li>
<li>The animation is a rotation in this case. But the color can be changed too, the size, etc.</li>
<li>I checked using a path instead of a star and a scale must be applied unless your icon has the proper size. Then, an animation that changes this size can&#39;t be used easily. Also, the scale is difficult to find. There&#39;s a width and height prop that isn&#39;t used.</li>
</ul>
<h1 id="conclusions">Conclusions</h1>
<p>I&#39;m very happy with the result. In not many hours, I could make a base for mapping in an easy way with all the Svelte capabilities. Svelte is awesome!</p>
<h1 id="links">Links</h1>
<ul>
<li><a href="https://svelte.dev/repl/75082b2a3383482d969f99b509f9b7a4?version=3.24.1">First example</a> First example: Svelte and Konva</li>
<li><a href="https://svelte.dev/repl/db922f45dff8483082e18d6555ad5b50?version=3.24.1">Second example</a> Second example: Using components</li>
<li><a href="https://svelte.dev/repl/7c3e009c6f82414aa011a313b76a5eeb?version=3.24.1">Intermediate third example</a> Intermediate third example</li>
<li><a href="https://svelte.dev/repl/8f38e2c895284c13a3e3f534d01dd171?version=3.24.1">Third example</a> Second example: Mapping with actions and animations</li>
<li><a href="https://geoexamples.com/other/2019/12/08/mapping-svelte.html">Mapping with Svelte</a></li>
<li><a href="https://konvajs.org/">Konva web site</a></li>
</ul>
</article></div></div></main>
<footer class="site-footer"><div class="wrapper"><div class="footer-col-wrapper"><div class="footer-col  footer-col-1"><ul class="contact-list"><li>GeoExamples - Roger Veciana</li></ul></div>

	<div class="footer-col  footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/rveciana"><span class="icon  icon--github"><svg viewBox="0 0 16 16"><path fill="#89b889" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"></path></svg></span>

						<span class="username">rveciana</span></a></li>

			<li><a href="https://twitter.com/rveciana"><span class="icon  icon--twitter"><svg viewBox="0 0 16 16"><path fill="#89b889" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                    c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"></path></svg></span>

						<span class="username">rveciana</span></a></li>
			<li><a href="https://www.linkedin.com/in/rogerveciana"><span class="icon  icon--twitter"><svg width="16" height="15.28958"><path d="M 0,1.77606 Q 0,1.00386 0.54054,0.50193 1.08108,0 1.94595,0 2.79537,0 3.32047,0.49421 3.86101,1.00386 3.86101,1.8224 q 0,0.74131 -0.5251,1.23552 -0.54054,0.50965 -1.42085,0.50965 l -0.0154,0 q -0.84942,0 -1.37452,-0.50965 Q 4e-5,2.54827 4e-5,1.77606 Z m 0.20078,13.51352 0,-10.3166 3.42857,0 0,10.3166 -3.42857,0 z m 5.32818,0 3.42857,0 0,-5.76062 q 0,-0.54054 0.12355,-0.83398 0.21622,-0.52509 0.65638,-0.88803 0.44015,-0.36293 1.10424,-0.36293 1.72973,0 1.72973,2.33205 l 0,5.51351 3.42857,0 0,-5.91506 Q 16,7.08881 14.91892,5.90734 13.83784,4.72587 12.06178,4.72587 q -1.99228,0 -3.10425,1.71429 l 0,0.0309 -0.0154,0 0.0154,-0.0309 0,-1.46718 -3.42857,0 q 0.0309,0.49421 0.0309,3.07336 0,2.57915 -0.0309,7.24324 z"></path></svg></span>

						<span class="username">rogerveciana</span></a></li></ul></div>

	<div class="footer-col  footer-col-3"><p class="text">I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time.</p>
		<p class="text">Roger Veciana i Rovira</p></div></div></div></footer>



	<script type="svelte-data" url="/summary_pages.json">{"status":200,"statusText":"","headers":{"content-type":"application/json"},"body":"[{\"title\":\"About\",\"permalink\":\"\u002Fabout\",\"excerpt\":\"\u003Cp\u003E{{ site.author.name }}\u003C\u002Fp\u003E\"},{\"title\":\"Projects\",\"permalink\":\"\u002Fprojects\",\"excerpt\":\"\u003Cp\u003ESome of my personal projects:\u003C\u002Fp\u003E\"},{\"title\":\"CV\",\"permalink\":\"\u002Fcv\",\"excerpt\":\"\u003Ch2 id=\\\"jobs\\\"\u003EJobs\u003C\u002Fh2\u003E\",\"avoidMainMenu\":true}]"}</script>

	<script type="svelte-data" url="svelte-konva-mapping.html.json">{"status":200,"statusText":"","headers":{"content-type":"application/json"},"body":"{\"title\":\"Mapping with Svelte and Konva\",\"contents\":\"\u003Cp\u003EAfter some attempts \u003Ca href=\\\"https:\u002F\u002Fgeoexamples.com\u002Fother\u002F2019\u002F12\u002F08\u002Fmapping-svelte.html\\\"\u003Emapping with Svelte\u003C\u002Fa\u003E, I missed using canvas instead of SVG. SVG has the advantage that integrates very well with Svelte, since it&#39;s an XML and the nodes can be managed as if they were HTML. On the other hand, Canvas is more efficient, but it has to be generated entirely with JavaScript.\u003C\u002Fp\u003E\\n\u003Cp\u003EAt the same time, I found \u003Ca href=\\\"https:\u002F\u002Fkonvajs.org\u002F\\\"\u003EKonva\u003C\u002Fa\u003E, a promising library to draw Canvas elements and make them interactive in an easy way. It allows animations, Drag and Drop, actions, filters, etc. so it&#39;s possible to do the same things as in SVG. I didn&#39;t find any example of Konva for drawing maps, so here we&#39;ll find a declarative way to do it, using Svelte.\u003C\u002Fp\u003E\\n\u003Ch1 id=\\\"using-konva-with-svelte\\\"\u003EUsing Konva with Svelte\u003C\u002Fh1\u003E\\n\u003Cp\u003ELet&#39;s see first how to plot \u003Cem\u003Esomething\u003C\u002Fem\u003E using Konva and Svelte. \u003Ca href=\\\"https:\u002F\u002Fsvelte.dev\u002Frepl\u002F75082b2a3383482d969f99b509f9b7a4?version=3.24.1\\\"\u003EYou can check the source code at Svelte REPL\u003C\u002Fa\u003E. Be patient, since it has to load the npm modules!\u003C\u002Fp\u003E\\n\u003Cp\u003EThe code here is short, and we have only one component:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003EonMount\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'svelte'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Konva \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'konva'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E container\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token function\\\"\u003EonMount\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E stage \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"token class-name\\\"\u003EKonva\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003EStage\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n        container\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E container\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        width\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E400\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        height\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E400\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E layer \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"token class-name\\\"\u003EKonva\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003ELayer\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E simpleText \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"token class-name\\\"\u003EKonva\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003EText\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n        x\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E stage\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ewidth\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        y\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E15\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        text\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'Hello Konva'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        fontSize\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E30\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        fontFamily\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'Calibri'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        fill\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'green'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n      \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n        layer\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eadd\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EsimpleText\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n        stage\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eadd\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Elayer\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ediv bind\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003Econtainer\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\\n\u003Cul\u003E\\n\u003Cli\u003ENote how the \u003Cem\u003Ediv\u003C\u002Fem\u003E container is binded to the variable\u003C\u002Fli\u003E\\n\u003Cli\u003ESince the component has to be binded, we&#39;ll have to wait until the component is mounted to create the Konva elements\u003C\u002Fli\u003E\\n\u003Cli\u003EKonva needs a \u003Cem\u003EStage\u003C\u002Fem\u003E (cimilar to the Canvas element), one or more \u003Cem\u003ELayer\u003C\u002Fem\u003E, where you can actually draw the objects, and any shape, text or whatever we want to draw.\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Ch1 id=\\\"konva-as-svelte-components\\\"\u003EKonva as Svelte components\u003C\u002Fh1\u003E\\n\u003Cp\u003EThe example is not bad, but it&#39;s not using any Svelte style coding. It would be cool declaring things like:\\n\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token tag\\\"\u003E\u003Cspan class=\\\"token tag\\\"\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E&lt;\u003C\u002Fspan\u003EStage\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token tag\\\"\u003E\u003Cspan class=\\\"token tag\\\"\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E&lt;\u003C\u002Fspan\u003ELayer\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token tag\\\"\u003E\u003Cspan class=\\\"token tag\\\"\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E&lt;\u003C\u002Fspan\u003EElement\u003C\u002Fspan\u003E \u003Cspan class=\\\"token attr-name\\\"\u003Ex\u003C\u002Fspan\u003E\u003Cspan class=\\\"token attr-value\\\"\u003E\u003Cspan class=\\\"token punctuation attr-equals\\\"\u003E=\u003C\u002Fspan\u003E100\u003C\u002Fspan\u003E \u003Cspan class=\\\"token attr-name\\\"\u003Ey\u003C\u002Fspan\u003E\u003Cspan class=\\\"token attr-value\\\"\u003E\u003Cspan class=\\\"token punctuation attr-equals\\\"\u003E=\u003C\u002Fspan\u003E100\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token tag\\\"\u003E\u003Cspan class=\\\"token tag\\\"\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E&lt;\u003C\u002Fspan\u003ELayer\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token tag\\\"\u003E\u003Cspan class=\\\"token tag\\\"\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E&lt;\u002F\u003C\u002Fspan\u003EStage\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EThen, we could use a store to put as many elements as we wanted, for instance. Let&#39;s see how to to that. \u003Ca href=\\\"https:\u002F\u002Fsvelte.dev\u002Frepl\u002Fdb922f45dff8483082e18d6555ad5b50?version=3.24.1\\\"\u003ECheck the interactive example here\u003C\u002Fa\u003E\u003C\u002Fp\u003E\\n\u003Cimg src=\\\"\u002Fimages\u002Fsvelte\u002Fsvelte-konva-mapping\u002Fcircles.png\\\"\u002F\u003E\\n\\n\u003Cp\u003EWe&#39;ll create a component for the Stage, another for the Layer and finally, a Circle component that acually draws a circle.\u003C\u002Fp\u003E\\n\u003Cp\u003EThe Stage component is like this:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Konva \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'konva'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E onMount\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E setContext \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'svelte'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"token function\\\"\u003EsetContext\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"konva\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token function-variable function\\\"\u003EgetStage\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E stage\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E container\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E stage\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E \\n    \u003Cspan class=\\\"token function\\\"\u003EonMount\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n     stage \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"token class-name\\\"\u003EKonva\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003EStage\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n        container\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E container\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        width\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E400\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        height\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E400\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Epre\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ecode\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ediv bind\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003Econtainer\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E container\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Eslot\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Eslot\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Ecode\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epre\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Ediv\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\\n\u003Cul\u003E\\n\u003Cli\u003EAs in the other case, you&#39;ll see that we need to create the node where we&#39;ll add all the stuff, plus the binding.\u003C\u002Fli\u003E\\n\u003Cli\u003EThe slot will allow us to add children components. Layers in this case.\u003C\u002Fli\u003E\\n\u003Cli\u003EWe create a context. This way, the Layer component will have access to the \u003Cem\u003EKonva stage\u003C\u002Fem\u003E object without passing it in the props. Since this component won&#39;t be touched when creating new drawings, it&#39;s much cleaner.\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003EThen the Layer component:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Konva \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'konva'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E getContext\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E setContext \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'svelte'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E getStage \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EgetContext\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"konva\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token function\\\"\u003EsetContext\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"konva_layer\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token function-variable function\\\"\u003EgetLayer\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E layer\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E stage \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EgetStage\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E layer \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"token class-name\\\"\u003EKonva\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003ELayer\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    stage\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eadd\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Elayer\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\\n\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Eslot\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Eslot\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EThis one is much simpler, since we don&#39;t have to create HTML elements.\u003C\u002Fli\u003E\\n\u003Cli\u003EWe create another context for the layer, so its children can have access to it.\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003EFinally, the Circle component is:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Konva \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'konva'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E getContext\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E onDestroy \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'svelte'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E x \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E y \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E r \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E fill \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"black\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E stroke \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"black\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E strokeWidth \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E getLayer \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EgetContext\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"konva_layer\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E layer \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EgetLayer\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E circle \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"token class-name\\\"\u003EKonva\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003ECircle\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n        x\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E x\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        y\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E y\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        radius\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E r\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        fill\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E fill\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        stroke\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E stroke\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        strokeWidth\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E strokeWidth\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n      \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    layer\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eadd\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ecircle\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    layer\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Edraw\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token function\\\"\u003EonDestroy\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E circle\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Edestroy\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\\n\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EWe export most of the parameters so they can be used as props, although they have a default value\u003C\u002Fli\u003E\\n\u003Cli\u003EWe have to call \u003Cem\u003Elayer.draw()\u003C\u002Fem\u003E or the object won&#39;t be drawn. That&#39;s because we are creating it before the layer is added into the stage.\u003C\u002Fli\u003E\\n\u003Cli\u003EWe have to destroy the object on deleting the component, or we&#39;ll have memory leaks. Think if we had hundreds of circles appearing and disappearing when a store value changes...\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003EAnd now the cool part. To create the drawing, we only call:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003EStage\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003ELayer\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003ECircle x\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E100\u003C\u002Fspan\u003E y\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E100\u003C\u002Fspan\u003E r\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E23\u003C\u002Fspan\u003E fill\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"red\\\"\u003C\u002Fspan\u003E strokeWidth\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E3\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003ECircle x\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E200\u003C\u002Fspan\u003E y\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E200\u003C\u002Fspan\u003E r\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E13\u003C\u002Fspan\u003E fill\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"green\\\"\u003C\u002Fspan\u003E strokeWidth\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E3\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003ELayer\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003EStage\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Ch1 id=\\\"creating-a-map\\\"\u003ECreating a map\u003C\u002Fh1\u003E\\n\u003Cp\u003ESo now, with the knowledge from the previous examples, we can create a map. \u003Ca href=\\\"https:\u002F\u002Fsvelte.dev\u002Frepl\u002F7c3e009c6f82414aa011a313b76a5eeb?version=3.24.1\\\"\u003EI created an intermediate (simpler) version of the map, in case somebody wants to take a look\u003C\u002Fa\u003E. \u003Ca href=\\\"https:\u002F\u002Fsvelte.dev\u002Frepl\u002F8f38e2c895284c13a3e3f534d01dd171?version=3.24.1\\\"\u003EThe final version is here\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\\n\u003Cimg src=\\\"\u002Fimages\u002Fsvelte\u002Fsvelte-konva-mapping\u002Fmap.png\\\"\u002F\u003E\\n\\n\u003Cp\u003ELet&#39;s start from the other side now! The App.svelte file is this one:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003EonMount\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'svelte'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Stage \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'.\u002FStage.svelte'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Layer \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'.\u002FLayer.svelte'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Marker \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'.\u002FMarker.svelte'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E BackgroundMap \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'.\u002FBackgroundMap.svelte'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E message \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'.\u002Fstore.js'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E message_value\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    message\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esubscribe\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Evalue\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n        message_value \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E value\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003EStage\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003ELayer\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003EBackgroundMap \u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003ELayer\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003ELayer\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003EMarker lon\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E43.1\u003C\u002Fspan\u003E lat\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E22.9068\u003C\u002Fspan\u003E fill\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"green\\\"\u003C\u002Fspan\u003E markerMessage\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"Marker: Rio de Janeiro\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003EMarker lon\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E lat\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E41\u003C\u002Fspan\u003E fill\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"green\\\"\u003C\u002Fspan\u003E markerMessage\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"Marker: Barcelona\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003ELayer\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003EStage\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\\n\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003Emessage_value\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\\n\u003Cul\u003E\\n\u003Cli\u003EWe are using a \u003Cem\u003EBackgroundMap\u003C\u002Fem\u003E component and as many \u003Cem\u003EMarker\u003C\u002Fem\u003E components as we want.\u003C\u002Fli\u003E\\n\u003Cli\u003EThere&#39;s a writable store where the children will put the name of the hovered feature. In the App component we&#39;ll just render it.\u003C\u002Fli\u003E\\n\u003Cli\u003EI use two layers because when using one, the markers can&#39;t be detected if they are over a country. z-index is not well managed in konvas.\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003EThe projection and D3 GeoPath are defined in their own file so they can be accessed from all the components:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E geoPath \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003Ed3\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003Egeo\u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E geoAitoff \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003Ed3\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003Egeo\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003Eprojection\u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E width \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E600\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E height \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E400\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E projection \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EgeoAitoff\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Etranslate\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003Ewidth \u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E height \u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Escale\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E110\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E path \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EgeoPath\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eprojection\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eprojection\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EThe size and zooms are fixed. If we wanted a more complex map, we could make this a store and then chenge the values from a slider or a mouse event\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003EThe BackgroundMap component is:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Konva \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'konva'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E getContext\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E onMount \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'svelte'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E feature \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"topojson\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E path \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'.\u002Fprojection'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E message \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'.\u002Fstore.js'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E getLayer \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EgetContext\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"konva_layer\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E layer \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EgetLayer\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token function\\\"\u003EonMount\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E response \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eawait\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003Efetch\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\\n      \u003Cspan class=\\\"token string\\\"\u003E\\\"https:\u002F\u002Fgist.githubusercontent.com\u002Fdenisemauldin\u002Fa2fa29af082e85dfaf27d100be01fa47\u002Fraw\u002F6b3a5b9b29151739964612c8a7cff23707386d84\u002Freadme-world-110m.json\\\"\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E json \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eawait\u003C\u002Fspan\u003E response\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ejson\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E topoData \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003Efeature\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ejson\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E json\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eobjects\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ecountries\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E data \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E topoData\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Efeatures\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    data\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EforEach\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Ecountry\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E konvaPath \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"token class-name\\\"\u003EKonva\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003EPath\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\\n        data\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003Epath\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ecountry\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        stroke\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'black'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n            strokeWidth\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0.5\u003C\u002Fspan\u003E\\n\\n            \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n        konvaPath\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eon\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'mouseover'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n        message\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eset\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ecountry\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eid\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n     \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n        layer\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eadd\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EkonvaPath\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\\n        layer\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Edraw\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\\n\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EWe can only draw when the file with the data is downloaded, so we&#39;ll put this in an \u003Cem\u003EonMount\u003C\u002Fem\u003E element\u003C\u002Fli\u003E\\n\u003Cli\u003EWe iterate for each country and create a Konva element for it. So we&#39;ll have hundreds of them here.\u003C\u002Fli\u003E\\n\u003Cli\u003ENote how Konva handles the \u003Cem\u003Emouseover\u003C\u002Fem\u003E event.\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003EFinally, the markers with animation:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Konva \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'konva'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E projection \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'.\u002Fprojection'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E message \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'.\u002Fstore.js'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E getContext\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E onDestroy \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'svelte'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E lon \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E lat \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E fill \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"black\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E markerMessage \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"Marker\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E coords \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003Eprojection\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003Elon\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E lat\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E getLayer \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EgetContext\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"konva_layer\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E layer \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EgetLayer\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E konvaPath \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"token class-name\\\"\u003EKonva\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003EStar\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n        x\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E coords\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        y\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E coords\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        fill\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E fill\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n            strokeWidth\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0.5\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        numPoints\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E5\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        innerRadius\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E5\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n        outerRadius\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E10\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\\n            \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    konvaPath\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eon\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'mouseover'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n        message\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eset\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EmarkerMessage\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n     \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    layer\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eadd\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EkonvaPath\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E angularSpeed \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E30\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n      \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E anim \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"token class-name\\\"\u003EKonva\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003EAnimation\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Eframe\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E angleDiff \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eframe\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003EtimeDiff \u003Cspan class=\\\"token operator\\\"\u003E*\u003C\u002Fspan\u003E angularSpeed\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E1000\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n        konvaPath\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Erotate\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EangleDiff\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n      \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E layer\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n      anim\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Estart\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n    layer\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Edraw\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token function\\\"\u003EonDestroy\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E konvaPath\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Edestroy\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\\n\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EVery similar to the circle case, but with a Star element in this case.\u003C\u002Fli\u003E\\n\u003Cli\u003EThe animation is a rotation in this case. But the color can be changed too, the size, etc.\u003C\u002Fli\u003E\\n\u003Cli\u003EI checked using a path instead of a star and a scale must be applied unless your icon has the proper size. Then, an animation that changes this size can&#39;t be used easily. Also, the scale is difficult to find. There&#39;s a width and height prop that isn&#39;t used.\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Ch1 id=\\\"conclusions\\\"\u003EConclusions\u003C\u002Fh1\u003E\\n\u003Cp\u003EI&#39;m very happy with the result. In not many hours, I could make a base for mapping in an easy way with all the Svelte capabilities. Svelte is awesome!\u003C\u002Fp\u003E\\n\u003Ch1 id=\\\"links\\\"\u003ELinks\u003C\u002Fh1\u003E\\n\u003Cul\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fsvelte.dev\u002Frepl\u002F75082b2a3383482d969f99b509f9b7a4?version=3.24.1\\\"\u003EFirst example\u003C\u002Fa\u003E First example: Svelte and Konva\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fsvelte.dev\u002Frepl\u002Fdb922f45dff8483082e18d6555ad5b50?version=3.24.1\\\"\u003ESecond example\u003C\u002Fa\u003E Second example: Using components\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fsvelte.dev\u002Frepl\u002F7c3e009c6f82414aa011a313b76a5eeb?version=3.24.1\\\"\u003EIntermediate third example\u003C\u002Fa\u003E Intermediate third example\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fsvelte.dev\u002Frepl\u002F8f38e2c895284c13a3e3f534d01dd171?version=3.24.1\\\"\u003EThird example\u003C\u002Fa\u003E Second example: Mapping with actions and animations\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fgeoexamples.com\u002Fother\u002F2019\u002F12\u002F08\u002Fmapping-svelte.html\\\"\u003EMapping with Svelte\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fkonvajs.org\u002F\\\"\u003EKonva web site\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\",\"tags\":[\"konva\"],\"date\":\"2020-08-05T00:00:00.000Z\"}"}</script>
</div>
	</body>
</html>
