<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-BD6G9PF6NH"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag('js', new Date());

			gtag('config', 'G-BD6G9PF6NH');
		</script>

		<meta charset="utf-8" />
		<link rel="icon" href="/favicon.ico" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="manifest" href="/manifest.json" />
		<meta name="theme-color" content="#cdffcd" />
		<!-- HTML Meta Tags -->
		<meta
			name="description"
			content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time."
		/>
		<!-- Google / Search Engine Tags -->
		<meta itemprop="name" content=">GeoExamples - Roger Veciana" />
		<meta
			itemprop="description"
			content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time."
		/>
		<meta itemprop="image" content="https://geoexamples.com/siteImage.png" />

		<title>GeoExamples - Mapping with supabase and Svelte</title><meta name="twitter:card" content="summary" data-svelte="svelte-4aysgi"><meta name="twitter:title" content="GeoExamples - Mapping with supabase and Svelte" data-svelte="svelte-4aysgi"><meta name="twitter:description" content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time." data-svelte="svelte-4aysgi"><meta name="twitter:image" content="https://geoexamples.com/images/svelte/svelte-supabase/twitter.png" data-svelte="svelte-4aysgi"><meta property="og:url" content="https://geoexamples.com" data-svelte="svelte-4aysgi"><meta property="og:type" content="website" data-svelte="svelte-4aysgi"><meta property="og:title" content="GeoExamples - Mapping with supabase and Svelte" data-svelte="svelte-4aysgi"><meta property="og:description" content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time." data-svelte="svelte-4aysgi"><meta property="og:image" content="https://geoexamples.com/images/svelte/svelte-supabase/twitter.png" data-svelte="svelte-4aysgi">



<link rel="modulepreload" href="/./staticApp/start-b8adad58.js">
			<link rel="modulepreload" href="/./staticApp/chunks/vendor-aee76599.js">
			<link rel="modulepreload" href="/./staticApp/chunks/config-b3bde751.js">
			<link rel="modulepreload" href="/./staticApp/pages\[category]\[year]\[month]\[date]\[slug].svelte-a8f2e1c8.js">
			<link rel="stylesheet" href="/./staticApp/assets/start-2b8dc5e2.css">


		<script type="module">
			import { start } from "/./staticApp/start-b8adad58.js";
			start({
				target: document.querySelector("#svelte"),
				paths: {"base":"","assets":"/."},
				session: {},
				host: location.host,
				route: true,
				hydrate: {
					status: 200,
					error: null,
					nodes: [
						import("/./staticApp/pages\\[category]\\[year]\\[month]\\[date]\\[slug].svelte-a8f2e1c8.js")
					],
					page: {
						host: location.host, // TODO this is redundant
						path: "/svelte/2021/07/18/svelte-supabase-maps.html",
						query: new URLSearchParams(""),
						params: {"category":"svelte","year":"2021","month":"07","date":"18","slug":"svelte-supabase-maps.html"}
					}
				}
			});
		</script>
	</head>
	<body>
		<div id="svelte">


<header class="site-header"><div class="wrapper"><a class="site-title" href="/">GeoExamples - Roger Veciana</a>

<nav class="site-nav"><div href="#" class="menu-icon"><svg viewBox="0 0 18 15"><path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path><path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path><path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path></svg></div>

	<div class="trigger"><a class="page-link" href="/about">About</a><a class="page-link" href="/blog">Blog</a><a class="page-link" href="/projects">Projects</a></div></nav></div></header>

<main class="page-content"><div class="wrapper">
<div class="post"><header class="post-header"><h1 class="post-title">Mapping with supabase and Svelte</h1>
<p class="post-meta">Jul 18, 2021</p></header>

	<article class="post-content"><p>I discovered <a href="https://supabase.io/">supabase</a> some days ago as a substitute for Firebase. As it was using PostgreSQL as the database, I checked if it had extensions and yes! it&#39;s got PostGIS and all its siblings!</p>
<p>Using supabase is not that straightforward, but it&#39;s not that difficult, so supabase can be a great solution if your backend it&#39;s not really complex.</p>
<img src="/images/svelte/svelte-supabase/map.png" />

<p>We&#39;ll show the user&#39;s point data on a map, a list and will let them add new points too.  You can see the <a href="https://bl.ocks.org/rveciana/raw/ca929e406e6bac979cd7a7f263303bad/?raw=true">working example here</a>.</p>
<h2 id="installation">Installation</h2>
<p>The first step will be creating your supabase account, of course. Then, set up a Svelte project.</p>
<p>I used the <a href="https://supabase.io/docs/guides/with-svelte#initialize-a-svelte-app">supabase tutorial for Svelte</a> to do it. Basically, you need to set the <em>.env</em> file with your keys (check at your supabase account)</p>
SVELTE_APP_SUPABASE_URL=THE_URL
SVELTE_APP_SUPABASE_ANON_KEY=THE_KEY<p>This will be used in a file called <em>supabaseClient.js</em> that connects to the service:</p>
<p><pre><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createClient <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@supabase/supabase-js'</span>

<span class="token keyword">const</span> supabaseUrl <span class="token operator">=</span> __api<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">SVELTE_APP_SUPABASE_URL</span>
<span class="token keyword">const</span> supabaseAnonKey <span class="token operator">=</span> __api<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">SVELTE_APP_SUPABASE_ANON_KEY</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> supabase <span class="token operator">=</span> <span class="token function">createClient</span><span class="token punctuation">(</span>supabaseUrl<span class="token punctuation">,</span> supabaseAnonKey<span class="token punctuation">)</span>
</code></pre></p>
<p>Then, the data can be accessed like this (that would get all the elements from the <em>geometries</em> table)</p>
<p><pre><code>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createClient <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@supabase/supabase-js'</span>

<span class="token keyword">const</span> supabaseUrl <span class="token operator">=</span> __api<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">SVELTE_APP_SUPABASE_URL</span>
<span class="token keyword">const</span> supabaseAnonKey <span class="token operator">=</span> __api<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">SVELTE_APP_SUPABASE_ANON_KEY</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> supabase <span class="token operator">=</span> <span class="token function">createClient</span><span class="token punctuation">(</span>supabaseUrl<span class="token punctuation">,</span> supabaseAnonKey<span class="token punctuation">)</span>
</code></pre></p>
<h2 id="creating-the-table">Creating the table</h2>
<p>This is the first place where we find problems, because the wizard doesn&#39;t accept the geometry types.</p>
<p>So first, activate the PostGIS extension at the <em>database -&gt; extensions</em> menu</p>
<p>Then, at the tables section, create a table (I&#39;ll call it <em>geometries</em>) with the id and a name field of type <em>varchar</em></p>
<p>As you can&#39;t add the geom column, go to the <em>sql</em> section and run </p>
<p><pre><code><span class="token constant">SELECT</span> <span class="token function">AddGeometryColumn</span> <span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'geometries'</span><span class="token punctuation">,</span><span class="token string">'geom'</span><span class="token punctuation">,</span><span class="token number">4326</span><span class="token punctuation">,</span><span class="token string">'POINT'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></p>
<p>The first argument is the schema (public or nothing in our case), the second the table and then the column name, type, projection SRID and dimensions</p>
<p>The table can be now used, but we can&#39;t insert geometries unless we have them in WKB format. <a href="https://github.com/cschwarz/wkx">WKX</a> is a library that does this, but I wasn&#39;t able to make it work with Svelte&#39;s rollup. I get this <a href="http://5.9.10.113/44315937/issues-importing-wkx-to-convert-wkb-to-wkt">unsolved bug</a>. Without being able to create the WKB format, we have to use PostGIS to do it for us, but the insert function accepts only values. The solution is using a stored procedure. Open the SQL section and run:
<pre><code>create or replace <span class="token keyword">function</span> <span class="token function">addGeomerty</span> <span class="token punctuation">(</span><span class="token parameter">location_name varchar<span class="token punctuation">,</span> lon float<span class="token punctuation">,</span> lat float</span><span class="token punctuation">)</span>
returns <span class="token constant">SETOF</span> geometries <span class="token keyword">as</span>
$
declare
return_record geometries<span class="token operator">%</span>rowtype<span class="token punctuation">;</span>
begin
  insert into  <span class="token function">geometries</span><span class="token punctuation">(</span>location_name<span class="token punctuation">,</span> geom<span class="token punctuation">)</span> <span class="token function">values</span> <span class="token punctuation">(</span>location_name<span class="token punctuation">,</span> <span class="token function">ST_SetSRID</span><span class="token punctuation">(</span><span class="token function">ST_MakePoint</span><span class="token punctuation">(</span>lon<span class="token punctuation">,</span> lat<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">4326</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   returning <span class="token operator">*</span>
   into return_record<span class="token punctuation">;</span>
  <span class="token keyword">return</span> next return_record<span class="token punctuation">;</span>
end
$
language plpgsql<span class="token punctuation">;</span>
</code></pre></p>
<p>This function will take the name, longitude and latitude and, besides inserting the name, uses postgis to calculate the geometry (<em>st_MakePoint</em>).
It&#39;s returning the new value so we don&#39;t have to query the data again to how the new point.</p>
<img src="/images/svelte/svelte-supabase/table.png"/>

<h2 id="svelte-components">Svelte components</h2>
<p>We&#39;ll use two components, one for the map and the other for the rest. Let&#39;s see the map:</p>
<p><pre><code><span class="token operator">&lt;</span>script<span class="token operator">></span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span> geoEqualEarth<span class="token punctuation">,</span> geoPath <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"d3-geo"</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span> onMount <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"svelte"</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span> feature <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"topojson"</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">let</span> points<span class="token punctuation">;</span>
<span class="token keyword">let</span> data<span class="token punctuation">;</span>
<span class="token keyword">const</span> projection <span class="token operator">=</span> <span class="token function">geoEqualEarth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">geoPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">projection</span><span class="token punctuation">(</span>projection<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">onMount</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>
    <span class="token string">"https://gist.githubusercontent.com/rveciana/502db152b70cddfd554e9d48ee23e279/raw/cc51c1b46199994b123271c629541d417f2f7d86/world-110m.json"</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> json <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> land <span class="token operator">=</span> <span class="token function">feature</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> json<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>land<span class="token punctuation">)</span><span class="token punctuation">;</span>
  data <span class="token operator">=</span> <span class="token function">path</span><span class="token punctuation">(</span>land<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
  <span class="token operator">&lt;</span>style<span class="token operator">></span>
    svg <span class="token punctuation">{</span>
      width<span class="token operator">:</span> <span class="token number">960</span>px<span class="token punctuation">;</span>
      height<span class="token operator">:</span> <span class="token number">500</span>px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span>border <span class="token punctuation">{</span>
      stroke<span class="token operator">:</span> #<span class="token number">444444</span><span class="token punctuation">;</span>
      fill<span class="token operator">:</span> #cccccc<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>style<span class="token operator">></span>
  <span class="token operator">&lt;</span>svg width<span class="token operator">=</span><span class="token string">"960"</span> height<span class="token operator">=</span><span class="token string">"500"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>path d<span class="token operator">=</span><span class="token punctuation">{</span>data<span class="token punctuation">}</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"border"</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token punctuation">{</span>#each points<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token operator">=></span>d<span class="token punctuation">.</span>geom<span class="token punctuation">)</span> <span class="token keyword">as</span> point<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>circle r<span class="token operator">=</span><span class="token number">10</span> cx<span class="token operator">=</span><span class="token punctuation">{</span><span class="token function">projection</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span>geom<span class="token punctuation">.</span>coordinates<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span> cy<span class="token operator">=</span><span class="token punctuation">{</span><span class="token function">projection</span><span class="token punctuation">(</span>point<span class="token punctuation">.</span>geom<span class="token punctuation">.</span>coordinates<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token punctuation">{</span><span class="token operator">/</span>each<span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>svg<span class="token operator">></span>
</code></pre></p>
<p>This is a regular d3 map. <em>export let points;</em> gets the points from the props and adds them on the map. Points are in geoJSON format, and inside the <em>geom</em> column. That&#39;s why the values are got like <em>point.geom.coordinates</em>.</p>
<p>The main component of the site is <em>App.svelte</em>:</p>
<p><pre><code><span class="token operator">&lt;</span>script<span class="token operator">></span>
    <span class="token keyword">import</span> Map <span class="token keyword">from</span> <span class="token string">"./Map.svelte"</span><span class="token punctuation">;</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span> supabase <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./supabaseClient"</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> geometries<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> newPointName<span class="token punctuation">;</span>
    <span class="token keyword">let</span> newPointLon<span class="token punctuation">;</span>
    <span class="token keyword">let</span> newPointLat<span class="token punctuation">;</span>
    <span class="token keyword">let</span> loading <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    $<span class="token operator">:</span> areValuesValid <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>newPointName <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isNaN</span><span class="token punctuation">(</span>newPointLat<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isNaN</span><span class="token punctuation">(</span>newPointLon<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> error <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> supabase
        <span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">'geometries'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">{</span>
        geometries <span class="token operator">=</span> data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> <span class="token function-variable function">handleSubmit</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>areValuesValid<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
            loading <span class="token operator">=</span> <span class="token boolean">true</span>
            <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token operator">:</span> dataInsert<span class="token punctuation">,</span> error <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> supabase<span class="token punctuation">.</span><span class="token function">rpc</span><span class="token punctuation">(</span><span class="token string">'addgeomerty'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>location_name<span class="token operator">:</span> newPointName<span class="token punctuation">,</span> lon<span class="token operator">:</span> newPointLon<span class="token punctuation">,</span> lat<span class="token operator">:</span>newPointLat<span class="token punctuation">}</span><span class="token punctuation">)</span>
            geometries <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>geometries<span class="token punctuation">,</span> <span class="token operator">...</span>dataInsert<span class="token punctuation">]</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token keyword">throw</span> error
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> error<span class="token punctuation">.</span>error_description <span class="token operator">||</span> error<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            loading <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"container"</span> style<span class="token operator">=</span><span class="token string">"padding: 50px 0 100px 0;"</span> use<span class="token operator">:</span>getData<span class="token operator">></span>
    <span class="token punctuation">{</span>#each geometries <span class="token keyword">as</span> <span class="token punctuation">{</span> id<span class="token punctuation">,</span> location_name<span class="token punctuation">,</span> geom <span class="token punctuation">}</span><span class="token punctuation">,</span> i<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>div<span class="token operator">></span><span class="token punctuation">{</span>id<span class="token punctuation">}</span><span class="token operator">-</span><span class="token punctuation">{</span>location_name<span class="token punctuation">}</span><span class="token operator">-</span><span class="token punctuation">{</span>geom <span class="token operator">&amp;&amp;</span> geom<span class="token punctuation">.</span>coordinates<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
    <span class="token punctuation">{</span><span class="token operator">/</span>each<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span>Map points<span class="token operator">=</span><span class="token punctuation">{</span>geometries<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>form <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"row flex flex-center"</span> on<span class="token operator">:</span>submit<span class="token operator">|</span>preventDefault<span class="token operator">=</span><span class="token punctuation">{</span>handleSubmit<span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"col-6 form-widget"</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>p <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"description"</span><span class="token operator">></span>Add a <span class="token keyword">new</span> <span class="token class-name">point</span> to the map
          <span class="token operator">&lt;</span>div<span class="token operator">></span>
            <span class="token operator">&lt;</span>input
              <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"inputField"</span>
              type<span class="token operator">=</span><span class="token string">"name"</span>
              placeholder<span class="token operator">=</span><span class="token string">"Name"</span>
              bind<span class="token operator">:</span>value<span class="token operator">=</span><span class="token punctuation">{</span>newPointName<span class="token punctuation">}</span>
            <span class="token operator">/</span><span class="token operator">></span>
            <span class="token operator">&lt;</span>input
              <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"inputField"</span>
              type<span class="token operator">=</span><span class="token string">"number"</span>
              step<span class="token operator">=</span><span class="token string">"0.01"</span>
              placeholder<span class="token operator">=</span><span class="token string">"Longitude"</span>
              bind<span class="token operator">:</span>value<span class="token operator">=</span><span class="token punctuation">{</span>newPointLon<span class="token punctuation">}</span>
            <span class="token operator">/</span><span class="token operator">></span>
            <span class="token operator">&lt;</span>input
              <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"inputField"</span>
              type<span class="token operator">=</span><span class="token string">"number"</span>
              step<span class="token operator">=</span><span class="token string">"0.01"</span>
              placeholder<span class="token operator">=</span><span class="token string">"Latitude"</span>
              bind<span class="token operator">:</span>value<span class="token operator">=</span><span class="token punctuation">{</span>newPointLat<span class="token punctuation">}</span>
            <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
          <span class="token operator">&lt;</span>div<span class="token operator">></span>
            <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">"submit"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">'button block'</span> value<span class="token operator">=</span><span class="token punctuation">{</span>loading <span class="token operator">?</span> <span class="token string">"Loading"</span> <span class="token operator">:</span> areValuesValid <span class="token operator">?</span> <span class="token string">"Upload point"</span> <span class="token operator">:</span> <span class="token string">"Enter valid values"</span><span class="token punctuation">}</span> disabled<span class="token operator">=</span><span class="token punctuation">{</span>loading <span class="token operator">||</span> <span class="token operator">!</span>areValuesValid<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
</code></pre>

<p>The two <em>supabase</em> related chunks are:</p>
<p><pre><code><span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> error <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> supabase
        <span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">'geometries'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></p>
<p>That retrieves the data (all rows, in a real app this should be limited)</p>
<p><pre><code><span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token operator">:</span> dataInsert<span class="token punctuation">,</span> error <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> supabase<span class="token punctuation">.</span><span class="token function">rpc</span><span class="token punctuation">(</span><span class="token string">'addgeomerty'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>location_name<span class="token operator">:</span> newPointName<span class="token punctuation">,</span> lon<span class="token operator">:</span> newPointLon<span class="token punctuation">,</span> lat<span class="token operator">:</span>newPointLat<span class="token punctuation">}</span><span class="token punctuation">)</span>
geometries <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>geometries<span class="token punctuation">,</span> <span class="token operator">...</span>dataInsert<span class="token punctuation">]</span>
</code></pre>
This calls the function and gets its results. The newly created rows are added to the existing ones so the data is in sync with the server.</p>
<h2 id="links">Links</h2>
<ul>
<li><a href="https://bl.ocks.org/rveciana/raw/ca929e406e6bac979cd7a7f263303bad/?raw=true">Working example</a></li>
<li><a href="https://supabase.io/">supabase</a></li>
<li><a href="https://supabase.io/docs/guides/with-svelte#initialize-a-svelte-app">supabase and Svelte setup tutorial</a></li>
<li><a href="https://github.com/cschwarz/wkx">wkx library</a></li>
<li><a href="http://5.9.10.113/44315937/issues-importing-wkx-to-convert-wkb-to-wkt">wkx bug</a></li>
<li><a href="https://medium.com/geekculture/using-stored-procedures-rpc-in-supabase-to-increment-a-like-counter-9c5b2293a65b">using a PostgreSQL function</a></li>
</ul>
</article></div></div></main>
<footer class="site-footer"><div class="wrapper"><div class="footer-col-wrapper"><div class="footer-col  footer-col-1"><ul class="contact-list"><li>GeoExamples - Roger Veciana</li></ul></div>

	<div class="footer-col  footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/rveciana"><span class="icon  icon--github"><svg viewBox="0 0 16 16"><path fill="#89b889" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"></path></svg></span>

						<span class="username">rveciana</span></a></li>

			<li><a href="https://twitter.com/rveciana"><span class="icon  icon--twitter"><svg viewBox="0 0 16 16"><path fill="#89b889" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                    c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"></path></svg></span>

						<span class="username">rveciana</span></a></li>
			<li><a href="https://www.linkedin.com/in/rogerveciana"><span class="icon  icon--twitter"><svg width="16" height="15.28958"><path d="M 0,1.77606 Q 0,1.00386 0.54054,0.50193 1.08108,0 1.94595,0 2.79537,0 3.32047,0.49421 3.86101,1.00386 3.86101,1.8224 q 0,0.74131 -0.5251,1.23552 -0.54054,0.50965 -1.42085,0.50965 l -0.0154,0 q -0.84942,0 -1.37452,-0.50965 Q 4e-5,2.54827 4e-5,1.77606 Z m 0.20078,13.51352 0,-10.3166 3.42857,0 0,10.3166 -3.42857,0 z m 5.32818,0 3.42857,0 0,-5.76062 q 0,-0.54054 0.12355,-0.83398 0.21622,-0.52509 0.65638,-0.88803 0.44015,-0.36293 1.10424,-0.36293 1.72973,0 1.72973,2.33205 l 0,5.51351 3.42857,0 0,-5.91506 Q 16,7.08881 14.91892,5.90734 13.83784,4.72587 12.06178,4.72587 q -1.99228,0 -3.10425,1.71429 l 0,0.0309 -0.0154,0 0.0154,-0.0309 0,-1.46718 -3.42857,0 q 0.0309,0.49421 0.0309,3.07336 0,2.57915 -0.0309,7.24324 z"></path></svg></span>

						<span class="username">rogerveciana</span></a></li></ul></div>

	<div class="footer-col  footer-col-3"><p class="text">I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time.</p>
		<p class="text">Roger Veciana i Rovira</p></div></div></div></footer>



	<script type="svelte-data" url="/summary_pages.json">{"status":200,"statusText":"","headers":{"content-type":"application/json"},"body":"[{\"title\":\"About\",\"permalink\":\"\u002Fabout\",\"excerpt\":\"\u003Cp\u003E{{ site.author.name }}\u003C\u002Fp\u003E\"},{\"title\":\"Projects\",\"permalink\":\"\u002Fprojects\",\"excerpt\":\"\u003Cp\u003ESome of my personal projects:\u003C\u002Fp\u003E\"},{\"title\":\"CV\",\"permalink\":\"\u002Fcv\",\"excerpt\":\"\u003Ch2 id=\\\"jobs\\\"\u003EJobs\u003C\u002Fh2\u003E\",\"avoidMainMenu\":true}]"}</script>

	<script type="svelte-data" url="svelte-supabase-maps.html.json">{"status":200,"statusText":"","headers":{"content-type":"application/json"},"body":"{\"title\":\"Mapping with supabase and Svelte\",\"contents\":\"\u003Cp\u003EI discovered \u003Ca href=\\\"https:\u002F\u002Fsupabase.io\u002F\\\"\u003Esupabase\u003C\u002Fa\u003E some days ago as a substitute for Firebase. As it was using PostgreSQL as the database, I checked if it had extensions and yes! it&#39;s got PostGIS and all its siblings!\u003C\u002Fp\u003E\\n\u003Cp\u003EUsing supabase is not that straightforward, but it&#39;s not that difficult, so supabase can be a great solution if your backend it&#39;s not really complex.\u003C\u002Fp\u003E\\n\u003Cimg src=\\\"\u002Fimages\u002Fsvelte\u002Fsvelte-supabase\u002Fmap.png\\\" \u002F\u003E\\n\\n\u003Cp\u003EWe&#39;ll show the user&#39;s point data on a map, a list and will let them add new points too.  You can see the \u003Ca href=\\\"https:\u002F\u002Fbl.ocks.org\u002Frveciana\u002Fraw\u002Fca929e406e6bac979cd7a7f263303bad\u002F?raw=true\\\"\u003Eworking example here\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\\n\u003Ch2 id=\\\"installation\\\"\u003EInstallation\u003C\u002Fh2\u003E\\n\u003Cp\u003EThe first step will be creating your supabase account, of course. Then, set up a Svelte project.\u003C\u002Fp\u003E\\n\u003Cp\u003EI used the \u003Ca href=\\\"https:\u002F\u002Fsupabase.io\u002Fdocs\u002Fguides\u002Fwith-svelte#initialize-a-svelte-app\\\"\u003Esupabase tutorial for Svelte\u003C\u002Fa\u003E to do it. Basically, you need to set the \u003Cem\u003E.env\u003C\u002Fem\u003E file with your keys (check at your supabase account)\u003C\u002Fp\u003E\\nSVELTE_APP_SUPABASE_URL=THE_URL\\nSVELTE_APP_SUPABASE_ANON_KEY=THE_KEY\u003Cp\u003EThis will be used in a file called \u003Cem\u003EsupabaseClient.js\u003C\u002Fem\u003E that connects to the service:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E createClient \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'@supabase\u002Fsupabase-js'\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E supabaseUrl \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E __api\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eenv\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token constant\\\"\u003ESVELTE_APP_SUPABASE_URL\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E supabaseAnonKey \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E __api\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eenv\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token constant\\\"\u003ESVELTE_APP_SUPABASE_ANON_KEY\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E supabase \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EcreateClient\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EsupabaseUrl\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E supabaseAnonKey\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EThen, the data can be accessed like this (that would get all the elements from the \u003Cem\u003Egeometries\u003C\u002Fem\u003E table)\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E createClient \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'@supabase\u002Fsupabase-js'\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E supabaseUrl \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E __api\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eenv\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token constant\\\"\u003ESVELTE_APP_SUPABASE_URL\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E supabaseAnonKey \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E __api\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eenv\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token constant\\\"\u003ESVELTE_APP_SUPABASE_ANON_KEY\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E supabase \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EcreateClient\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EsupabaseUrl\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E supabaseAnonKey\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Ch2 id=\\\"creating-the-table\\\"\u003ECreating the table\u003C\u002Fh2\u003E\\n\u003Cp\u003EThis is the first place where we find problems, because the wizard doesn&#39;t accept the geometry types.\u003C\u002Fp\u003E\\n\u003Cp\u003ESo first, activate the PostGIS extension at the \u003Cem\u003Edatabase -&gt; extensions\u003C\u002Fem\u003E menu\u003C\u002Fp\u003E\\n\u003Cp\u003EThen, at the tables section, create a table (I&#39;ll call it \u003Cem\u003Egeometries\u003C\u002Fem\u003E) with the id and a name field of type \u003Cem\u003Evarchar\u003C\u002Fem\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EAs you can&#39;t add the geom column, go to the \u003Cem\u003Esql\u003C\u002Fem\u003E section and run \u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\u003Cspan class=\\\"token constant\\\"\u003ESELECT\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EAddGeometryColumn\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E''\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'geometries'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'geom'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E4326\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'POINT'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EThe first argument is the schema (public or nothing in our case), the second the table and then the column name, type, projection SRID and dimensions\u003C\u002Fp\u003E\\n\u003Cp\u003EThe table can be now used, but we can&#39;t insert geometries unless we have them in WKB format. \u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Fcschwarz\u002Fwkx\\\"\u003EWKX\u003C\u002Fa\u003E is a library that does this, but I wasn&#39;t able to make it work with Svelte&#39;s rollup. I get this \u003Ca href=\\\"http:\u002F\u002F5.9.10.113\u002F44315937\u002Fissues-importing-wkx-to-convert-wkb-to-wkt\\\"\u003Eunsolved bug\u003C\u002Fa\u003E. Without being able to create the WKB format, we have to use PostGIS to do it for us, but the insert function accepts only values. The solution is using a stored procedure. Open the SQL section and run:\\n\u003Cpre\u003E\u003Ccode\u003Ecreate or replace \u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EaddGeomerty\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Elocation_name varchar\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E lon float\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E lat float\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\nreturns \u003Cspan class=\\\"token constant\\\"\u003ESETOF\u003C\u002Fspan\u003E geometries \u003Cspan class=\\\"token keyword\\\"\u003Eas\u003C\u002Fspan\u003E\\n$\\ndeclare\\nreturn_record geometries\u003Cspan class=\\\"token operator\\\"\u003E%\u003C\u002Fspan\u003Erowtype\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\nbegin\\n  insert into  \u003Cspan class=\\\"token function\\\"\u003Egeometries\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Elocation_name\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E geom\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003Evalues\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Elocation_name\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EST_SetSRID\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EST_MakePoint\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Elon\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E lat\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E4326\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n   returning \u003Cspan class=\\\"token operator\\\"\u003E*\u003C\u002Fspan\u003E\\n   into return_record\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"token keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E next return_record\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\nend\\n$\\nlanguage plpgsql\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EThis function will take the name, longitude and latitude and, besides inserting the name, uses postgis to calculate the geometry (\u003Cem\u003Est_MakePoint\u003C\u002Fem\u003E).\\nIt&#39;s returning the new value so we don&#39;t have to query the data again to how the new point.\u003C\u002Fp\u003E\\n\u003Cimg src=\\\"\u002Fimages\u002Fsvelte\u002Fsvelte-supabase\u002Ftable.png\\\"\u002F\u003E\\n\\n\u003Ch2 id=\\\"svelte-components\\\"\u003ESvelte components\u003C\u002Fh2\u003E\\n\u003Cp\u003EWe&#39;ll use two components, one for the map and the other for the rest. Let&#39;s see the map:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E geoEqualEarth\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E geoPath \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"d3-geo\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E onMount \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"svelte\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E feature \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"topojson\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eexport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E points\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E data\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E projection \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EgeoEqualEarth\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E path \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EgeoPath\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eprojection\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eprojection\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token function\\\"\u003EonMount\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E response \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eawait\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003Efetch\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token string\\\"\u003E\\\"https:\u002F\u002Fgist.githubusercontent.com\u002Frveciana\u002F502db152b70cddfd554e9d48ee23e279\u002Fraw\u002Fcc51c1b46199994b123271c629541d417f2f7d86\u002Fworld-110m.json\\\"\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E json \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eawait\u003C\u002Fspan\u003E response\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ejson\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E land \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003Efeature\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ejson\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E json\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eobjects\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eland\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n  data \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003Epath\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eland\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Estyle\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    svg \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n      width\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E960\u003C\u002Fspan\u003Epx\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n      height\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E500\u003C\u002Fspan\u003Epx\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eborder \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n      stroke\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E #\u003Cspan class=\\\"token number\\\"\u003E444444\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n      fill\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E #cccccc\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Estyle\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Esvg width\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"960\\\"\u003C\u002Fspan\u003E height\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"500\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Epath d\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eclass\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"border\\\"\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E#each points\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efilter\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Ed\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003Ed\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Egeom\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eas\u003C\u002Fspan\u003E point\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ecircle r\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E10\u003C\u002Fspan\u003E cx\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eprojection\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Epoint\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Egeom\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ecoordinates\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E cy\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eprojection\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Epoint\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Egeom\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ecoordinates\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Eeach\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Esvg\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EThis is a regular d3 map. \u003Cem\u003Eexport let points;\u003C\u002Fem\u003E gets the points from the props and adds them on the map. Points are in geoJSON format, and inside the \u003Cem\u003Egeom\u003C\u002Fem\u003E column. That&#39;s why the values are got like \u003Cem\u003Epoint.geom.coordinates\u003C\u002Fem\u003E.\u003C\u002Fp\u003E\\n\u003Cp\u003EThe main component of the site is \u003Cem\u003EApp.svelte\u003C\u002Fem\u003E:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Map \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\".\u002FMap.svelte\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E supabase \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efrom\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\".\u002FsupabaseClient\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E geometries\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E newPointName\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E newPointLon\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E newPointLat\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E loading \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token boolean\\\"\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    $\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E areValuesValid \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E!\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E!\u003C\u002Fspan\u003EnewPointName \u003Cspan class=\\\"token operator\\\"\u003E&amp;&amp;\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E!\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EisNaN\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EnewPointLat\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E&amp;&amp;\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E!\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EisNaN\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EnewPointLon\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EgetData\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E data\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E error \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eawait\u003C\u002Fspan\u003E supabase\\n        \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efrom\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'geometries'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eselect\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n        geometries \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E data\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function-variable function\\\"\u003EhandleSubmit\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EareValuesValid\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n            \u003Cspan class=\\\"token keyword\\\"\u003Etry\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n            loading \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token boolean\\\"\u003Etrue\u003C\u002Fspan\u003E\\n            \u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E data\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E dataInsert\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E error \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eawait\u003C\u002Fspan\u003E supabase\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Erpc\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'addgeomerty'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003Elocation_name\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E newPointName\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E lon\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E newPointLon\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E lat\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003EnewPointLat\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n            geometries \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E...\u003C\u002Fspan\u003Egeometries\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E...\u003C\u002Fspan\u003EdataInsert\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\\n            \u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eerror\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Ethrow\u003C\u002Fspan\u003E error\\n        \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Ecatch\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eerror\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n            console\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eerror\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E error\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eerror_description \u003Cspan class=\\\"token operator\\\"\u003E||\u003C\u002Fspan\u003E error\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Emessage\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efinally\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n            loading \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token boolean\\\"\u003Efalse\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ediv \u003Cspan class=\\\"token keyword\\\"\u003Eclass\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"container\\\"\u003C\u002Fspan\u003E style\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"padding: 50px 0 100px 0;\\\"\u003C\u002Fspan\u003E use\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003EgetData\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E#each geometries \u003Cspan class=\\\"token keyword\\\"\u003Eas\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E id\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E location_name\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E geom \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E i\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ediv\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003Eid\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003Elocation_name\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003Egeom \u003Cspan class=\\\"token operator\\\"\u003E&amp;&amp;\u003C\u002Fspan\u003E geom\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ecoordinates\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Ediv\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Eeach\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003EMap points\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003Egeometries\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Eform \u003Cspan class=\\\"token keyword\\\"\u003Eclass\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"row flex flex-center\\\"\u003C\u002Fspan\u003E on\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003Esubmit\u003Cspan class=\\\"token operator\\\"\u003E|\u003C\u002Fspan\u003EpreventDefault\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003EhandleSubmit\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ediv \u003Cspan class=\\\"token keyword\\\"\u003Eclass\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"col-6 form-widget\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n          \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ep \u003Cspan class=\\\"token keyword\\\"\u003Eclass\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"description\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003EAdd a \u003Cspan class=\\\"token keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"token class-name\\\"\u003Epoint\u003C\u002Fspan\u003E to the map\\n          \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ediv\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n            \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Einput\\n              \u003Cspan class=\\\"token keyword\\\"\u003Eclass\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"inputField\\\"\u003C\u002Fspan\u003E\\n              type\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"name\\\"\u003C\u002Fspan\u003E\\n              placeholder\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"Name\\\"\u003C\u002Fspan\u003E\\n              bind\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003Evalue\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003EnewPointName\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n            \u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n            \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Einput\\n              \u003Cspan class=\\\"token keyword\\\"\u003Eclass\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"inputField\\\"\u003C\u002Fspan\u003E\\n              type\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"number\\\"\u003C\u002Fspan\u003E\\n              step\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"0.01\\\"\u003C\u002Fspan\u003E\\n              placeholder\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"Longitude\\\"\u003C\u002Fspan\u003E\\n              bind\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003Evalue\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003EnewPointLon\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n            \u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n            \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Einput\\n              \u003Cspan class=\\\"token keyword\\\"\u003Eclass\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"inputField\\\"\u003C\u002Fspan\u003E\\n              type\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"number\\\"\u003C\u002Fspan\u003E\\n              step\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"0.01\\\"\u003C\u002Fspan\u003E\\n              placeholder\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"Latitude\\\"\u003C\u002Fspan\u003E\\n              bind\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003Evalue\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003EnewPointLat\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n            \u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n          \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Ediv\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n          \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ediv\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n            \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Einput type\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"submit\\\"\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eclass\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'button block'\u003C\u002Fspan\u003E value\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003Eloading \u003Cspan class=\\\"token operator\\\"\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"Loading\\\"\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E areValuesValid \u003Cspan class=\\\"token operator\\\"\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"Upload point\\\"\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"Enter valid values\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E disabled\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003Eloading \u003Cspan class=\\\"token operator\\\"\u003E||\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E!\u003C\u002Fspan\u003EareValuesValid\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n          \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Ediv\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Ediv\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n      \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Eform\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Ediv\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\\n\u003Cp\u003EThe two \u003Cem\u003Esupabase\u003C\u002Fem\u003E related chunks are:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E data\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E error \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eawait\u003C\u002Fspan\u003E supabase\\n        \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efrom\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'geometries'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eselect\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EThat retrieves the data (all rows, in a real app this should be limited)\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E data\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E dataInsert\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E error \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eawait\u003C\u002Fspan\u003E supabase\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Erpc\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'addgeomerty'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003Elocation_name\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E newPointName\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E lon\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E newPointLon\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E lat\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003EnewPointLat\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\ngeometries \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E...\u003C\u002Fspan\u003Egeometries\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E...\u003C\u002Fspan\u003EdataInsert\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\nThis calls the function and gets its results. The newly created rows are added to the existing ones so the data is in sync with the server.\u003C\u002Fp\u003E\\n\u003Ch2 id=\\\"links\\\"\u003ELinks\u003C\u002Fh2\u003E\\n\u003Cul\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fbl.ocks.org\u002Frveciana\u002Fraw\u002Fca929e406e6bac979cd7a7f263303bad\u002F?raw=true\\\"\u003EWorking example\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fsupabase.io\u002F\\\"\u003Esupabase\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fsupabase.io\u002Fdocs\u002Fguides\u002Fwith-svelte#initialize-a-svelte-app\\\"\u003Esupabase and Svelte setup tutorial\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Fcschwarz\u002Fwkx\\\"\u003Ewkx library\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"http:\u002F\u002F5.9.10.113\u002F44315937\u002Fissues-importing-wkx-to-convert-wkb-to-wkt\\\"\u003Ewkx bug\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fmedium.com\u002Fgeekculture\u002Fusing-stored-procedures-rpc-in-supabase-to-increment-a-like-counter-9c5b2293a65b\\\"\u003Eusing a PostgreSQL function\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\",\"tags\":[\"supabase\",\"postgis\"],\"date\":\"2021-07-18T18:40:53.000Z\",\"thumbnail\":\"\u002Fimages\u002Fsvelte\u002Fsvelte-supabase\u002Ftwitter.png\"}"}</script>
</div>
	</body>
</html>
