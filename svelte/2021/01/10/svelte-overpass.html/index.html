<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="/favicon.ico" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="manifest" href="/manifest.json" />
		<meta name="theme-color" content="#cdffcd">
		<!-- HTML Meta Tags -->
		<title>GeoExamples - Roger Veciana</title>
		<meta
			name="description"
			content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time."
		/>
		<!-- Google / Search Engine Tags -->
		<meta itemprop="name" content=">GeoExamples - Roger Veciana" />
		<meta
			itemprop="description"
			content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time."
		/>
		<meta itemprop="image" content="https://geoexamples.com/siteImage.png" />
		<!-- Facebook Meta Tags -->
		<meta property="og:url" content="https://geoexamples.com" />
		<meta property="og:type" content="website" />
		<meta property="og:title" content="GeoExamples - Roger Veciana" />
		<meta
			property="og:description"
			content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time."
		/>
		<meta property="og:image" content="https://geoexamples.com/siteImage.png" />
		<!-- Twitter Meta Tags -->
		<meta name="twitter:card" content="summary" />
		<meta name="twitter:title" content="GeoExamples - Roger Veciana" />
		<meta name="twitter:description"
		  content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time." />
		<meta name="twitter:image" content="https://geoexamples.com/siteImage.png" />
		



<link rel="modulepreload" href="/./_app/start-44631b0b.js">
			<link rel="modulepreload" href="/./_app/chunks/vendor-ff3d1764.js">
			<link rel="modulepreload" href="/./_app/chunks/config-b3bde751.js">
			<link rel="modulepreload" href="/./_app/pages\[category]\[year]\[month]\[date]\[slug].svelte-a77716b3.js">
			<link rel="stylesheet" href="/./_app/assets/start-34a290f9.css">


		<script type="module">
			import { start } from "/./_app/start-44631b0b.js";
			start({
				target: document.querySelector("#svelte"),
				paths: {"base":"","assets":"/."},
				session: {},
				host: location.host,
				route: true,
				hydrate: {
					status: 200,
					error: null,
					nodes: [
						import("/./_app/pages\\[category]\\[year]\\[month]\\[date]\\[slug].svelte-a77716b3.js")
					],
					page: {
						host: location.host, // TODO this is redundant
						path: "/svelte/2021/01/10/svelte-overpass.html",
						query: new URLSearchParams(""),
						params: {"category":"svelte","year":"2021","month":"01","date":"10","slug":"svelte-overpass.html"}
					}
				}
			});
		</script>
	</head>
	<body>
		<div id="svelte">


<header class="site-header"><div class="wrapper"><a class="site-title" href="/">GeoExamples - Roger Veciana</a>

<nav class="site-nav"><div href="#" class="menu-icon"><svg viewBox="0 0 18 15"><path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path><path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path><path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path></svg></div>

	<div class="trigger"><a class="page-link" href="/about">About</a><a class="page-link" href="/blog">Blog</a><a class="page-link" href="/projects">Projects</a></div></nav></div></header>

<main class="page-content"><div class="wrapper"><div class="post"><header class="post-header"><h1 class="post-title">Playing with OSM Overpass and Svelte</h1>
<p class="post-meta">Jan 10, 2021</p></header>

	<article class="post-content"><p>It&#39;s been quite a long time since I wanted to play with the OVerpass API, so I made an example app. I wanted to do it with Svelte too. Finally, the API options I use are quite simple and most of it is done with canvas, but here&#39;s what I learnt!</p>
<h1 id="the-app">The App</h1>
<p>You can check the App <a href="https://geoexamples.com/svelte-overpass/">here</a>. As you can see in the picture, it shows the nearest bars (and more!) around you, taking the data from the Overpass API. It&#39;s a <a href="https://en.wikipedia.org/wiki/Progressive_web_application">PWA</a>, so you can install it as a mobile phone application just by clicking a button.</p>
<p><a href="https://geoexamples.com/svelte-overpass/"><img src="/images/svelte/svelte-overpass/app.gif" width="300"/></a></p>
<p>The final code can be found at the <a href="https://github.com/rveciana/svelte-overpass">GitHub repo</a>.</p>
<h1 id="overpass">Overpass</h1>
<p>The <a href="https://wiki.openstreetmap.org/wiki/Overpass_API#:~:text=The%20Overpass%20API%20(formerly%20known,that%20corresponds%20to%20the%20query.">Overpass API</a> is a read-only API that server data from the OpenStreetMap project using different query languages. Using it, the whole map for a region could be drawn on the browser (or the backend).</p>
<p>I&#39;ve used the <a href="https://overpass.kumi.systems/">Kumi</a> site for the data, since it doesn&#39;t have limitations and I saw that other sites were using it successfully.</p>
<p>The used query id this one:</p>
<pre><code>const address = `https://overpass.kumi.systems/api/interpreter?data=[out:json][timeout:25000];node[&quot;amenity&quot;=&quot;${amenity}&quot;](around:${radius},${lat},${lng});out body;&gt;;out skel qt;`</code></pre><p>All the text after the <code>data=</code> part is an <a href="https://wiki.openstreetmap.org/wiki/Overpass_API/Overpass_QL">Overpass QL query</a>. It&#39;s a simple one, and quite easy to understand:</p>
<ul>
<li>Output format is set to JSON (it can be XML, CSV, etc)</li>
<li>A timeout is set (I don&#39;t know if this is strictly necessary)</li>
<li>After the semicolon (that indicates a new statement), the nodes that are of type <code>amenity=bar</code> are queried.<ul>
<li>This could be a path, instead of a node</li>
<li>The output is send to the <em>default set</em></li>
<li>A filter must be added so we don&#39;t download all OSM database! So we only download the data around a radius.</li>
</ul>
</li>
<li>The final statements set the output format<ul>
<li><code>out body</code> asks to put all the information to use the data. This is the tags associated to each node in the OSM database (name of the bar, address, website, etc). We will be using the name.</li>
<li><code>out skel</code> prints all the data for geometry</li>
<li><code>qt</code> sorts by <code>quadtile</code>, a geometry index that makes it faster. I took the queries from examples, and removing it doesn&#39;t change the result.</li>
</ul>
</li>
</ul>
<p>There are libraries to convert the data into a GeoJSON, but since we are using points, taking the longitude and latitude is really easy. The format is:</p>
<p><pre><code>
<span class="token punctuation">{</span>
<span class="token string">"version"</span><span class="token operator">:</span> <span class="token number">0.6</span><span class="token punctuation">,</span>
<span class="token string">"generator"</span><span class="token operator">:</span> <span class="token string">"Overpass API 0.7.56.8 7d656e78"</span><span class="token punctuation">,</span>
<span class="token string">"osm3s"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
<span class="token string">"timestamp_osm_base"</span><span class="token operator">:</span> <span class="token string">"2021-01-09T16:31:03Z"</span><span class="token punctuation">,</span>
<span class="token string">"copyright"</span><span class="token operator">:</span> <span class="token string">"The data included in this document is from &lt;a href="</span>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>openstreetmap<span class="token punctuation">.</span>org<span class="token string">">www.openstreetmap.org&lt;/a>. The data is made available under ODbL."</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token string">"elements"</span><span class="token operator">:</span> <span class="token punctuation">[</span>

<span class="token punctuation">{</span>
<span class="token string">"type"</span><span class="token operator">:</span> <span class="token string">"node"</span><span class="token punctuation">,</span>
<span class="token string">"id"</span><span class="token operator">:</span> <span class="token number">1305366218</span><span class="token punctuation">,</span>
<span class="token string">"lat"</span><span class="token operator">:</span> <span class="token number">41.3937290</span><span class="token punctuation">,</span>
<span class="token string">"lon"</span><span class="token operator">:</span> <span class="token number">2.1495210</span><span class="token punctuation">,</span>
<span class="token string">"tags"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
<span class="token string">"addr:street"</span><span class="token operator">:</span> <span class="token string">"Diagonal"</span><span class="token punctuation">,</span>
<span class="token string">"amenity"</span><span class="token operator">:</span> <span class="token string">"bar"</span><span class="token punctuation">,</span>
<span class="token string">"name"</span><span class="token operator">:</span> <span class="token string">"Bar Teo"</span><span class="token punctuation">,</span>
<span class="token string">"outdoor_seating"</span><span class="token operator">:</span> <span class="token string">"yes"</span><span class="token punctuation">,</span>
<span class="token string">"toilets:wheelchair"</span><span class="token operator">:</span> <span class="token string">"no"</span><span class="token punctuation">,</span>
<span class="token string">"wheelchair"</span><span class="token operator">:</span> <span class="token string">"no"</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token operator">...</span>
<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></p>
<p>So for each object in <code>elements</code> we can find all the information for one of the results. The code to process the data is:</p>
<p><pre><code>
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">data</span> <span class="token operator">=></span><span class="token punctuation">{</span>features <span class="token operator">=</span> data<span class="token punctuation">.</span>elements<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token operator">=></span><span class="token punctuation">{</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>easting<span class="token operator">:</span> dataX<span class="token punctuation">,</span> northing<span class="token operator">:</span> dataY<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">fromLatLon</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>lat<span class="token punctuation">,</span> d<span class="token punctuation">.</span>lon<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> dist <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span>dataX <span class="token operator">-</span> utmX<span class="token punctuation">)</span><span class="token operator">&lt;</span>strong<span class="token operator">></span><span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span>dataY <span class="token operator">-</span> utmY<span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>strong<span class="token operator">></span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> dir <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">180</span><span class="token operator">/</span>Math<span class="token punctuation">.</span><span class="token constant">PI</span><span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">atan2</span><span class="token punctuation">(</span><span class="token punctuation">(</span>dataX <span class="token operator">-</span> utmX<span class="token punctuation">)</span><span class="token operator">/</span>dist<span class="token punctuation">,</span> <span class="token punctuation">(</span>dataY <span class="token operator">-</span> utmY<span class="token punctuation">)</span><span class="token operator">/</span>dist<span class="token punctuation">)</span>
<span class="token keyword">return</span><span class="token punctuation">{</span>name<span class="token operator">:</span> d<span class="token punctuation">.</span>tags<span class="token punctuation">.</span>name<span class="token punctuation">,</span> lng<span class="token operator">:</span> d<span class="token punctuation">.</span>lon<span class="token punctuation">,</span> lat<span class="token operator">:</span> d<span class="token punctuation">.</span>lat<span class="token punctuation">,</span> dist<span class="token punctuation">,</span> dir<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token operator">=></span> d<span class="token punctuation">.</span>name<span class="token operator">!==</span><span class="token keyword">undefined</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span><span class="token operator">=></span> a<span class="token punctuation">.</span>dist <span class="token operator">-</span> b<span class="token punctuation">.</span>dist<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></p>
<ul>
<li>fromLatLon is a small library that converts from latlon to utm coordinates. This way, we can calculate distances and directions from our current position (see <em>compass</em> section)</li>
</ul>
<h1 id="the-svelte-app">The Svelte App</h1>
<p>I created the app using the instructions from the <a href="https://svelte.dev/blog/svelte-and-typescript">Svelte TypeScript post</a>. I had to touch a pair of things</p>
<ul>
<li><p>The paths on <code>index.html</code> to <code>bundle.js</code>, <code>bundle.css</code> and so on are by default on the root path. If you don&#39;t have a dedicated domain, this will make the app fail when deployed, since <em>Svelte</em> doesn&#39;t have a <em>basepath</em> option as <em>sapper</em> (or I didn&#39;t find it). Luckily, just making the paths relative works, so:</p>
<p>&lt;script defer src=&#39;/build/bundle.js&#39;&gt;&lt;/script&gt;</p>
</li>
</ul>
<p>becomes</p>
<pre><code>&lt;script defer src=&#39;/build/bundle.js&#39;&amp;gt;&amp;lt;/script&gt;</code></pre><ul>
<li>I added several tags so <em>lighthouse</em> improves the score. Like <code>apple-touch-icon</code>, <code>Description</code>, etc. The default template misses several things of this style.</li>
</ul>
<p>The App.svelte file is quite simple. It has only the canvas element and the selector. All the other stuff is to initialize the PWA and compass, as we will see. The data is drawn in a separate file.</p>
<ul>
<li><p>I struggled a little with the canvas component, because I was setting the size. When doing so, the app got stuck depending on the situation. So the best is creating it like:</p>
  <canvas bind:this={canvas}>

</li>
</ul>
<p>and getting the desired size in a reactive variable like:</p>
<pre><code>$: canvasSize = Math.min(containerWidth&gt;containerHeight?containerHeight:containerWidth, 500);</code></pre><p>This makes the size to be always adjusted to the container shortest size with a max of 500px. To get the container size, the <code>clientWidth</code> property can be bound on the container element:</p>
<pre><code>&lt;main bind:clientWidth={containerWidth} bind:clientHeight={containerHeight}&gt;</code></pre><p>Svelte is so cool ;)!</p>
<h1 id="the-compass">The compass</h1>
<p>The nice part of the app is the moving compass. To get it, we need three things:</p>
<ul>
<li>Getting the geograpgical coordinates</li>
<li>Getting the device orientation (the geographical one) and the screen orientation (landscape or portrait)</li>
<li>Drawing the data</li>
</ul>
<p>Getting the location is quite standard, just listening to <code>navigator.geolocation.watchPosition</code> and calling a callback. The browser will ask for permission.</p>
<p>The orientation seemed easy too, but it&#39;s not. I found a <a href="https://lamplightdev.github.io/compass/">compass example</a> (with an error, always points to the initial device position) but many browsers require special configurations to allow the orientation to be read.</p>
<p>The event to listen to is <code>window.addEventListener(&quot;deviceorientationabsolute&quot;, setHeading);</code> (not a navigator event!?). And it&#39;s using a callback too. In this case, an angle has to be added if the device is in landscape mode (and it can have two positions in landscape mode). The screen orientation lives in the <code>screen</code> object.</p>
<p><pre><code>

<span class="token keyword">const</span> screenOrientation <span class="token operator">=</span> <span class="token punctuation">(</span>screen<span class="token operator">?.</span>orientation<span class="token operator">?.</span>type<span class="token operator">??</span><span class="token string">"portrait-primary"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> adjustment <span class="token operator">=</span> screenOrientation<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">"portrait"</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token number">90</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> adjustment2 <span class="token operator">=</span> screenOrientation<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">"secondary"</span> <span class="token operator">?</span> adjustment <span class="token operator">-</span> <span class="token number">180</span><span class="token operator">:</span> adjustment<span class="token punctuation">;</span>
heading <span class="token operator">=</span> adjustment2 <span class="token operator">-</span> ev<span class="token punctuation">.</span>alpha<span class="token punctuation">;</span>

</code></pre></p>
<p>Again, Svelte makes really easy everything. If something in the function arguments change, the function is called. It&#39;s like the <code>useEffect</code> in react, but better!</p>
<pre><code>$: drawCompass(canvas, canvasSize, features, heading);</code></pre><p>The same hapens to fire the fetch data function. If <code>amenity</code>, <code>lon</code> or <code>lat</code> change, the code is run again.</p>
<p>To draw the data, I separated the code to a function <code>drawCompass</code> with its own file <code>draw-compass.ts</code>. The funtion uses the typical functions for canvas, so I won&#39;t copy all the code here.</p>
<h1 id="pwa">PWA</h1>
<p>This web is a clear candidate to become a PWA since it&#39;s much better on a mobile device that has orientation sensor. To do it I found a <a href="https://github.com/NileshSP/personalprofile/blob/master/src/components/biodetails.svelte">single example</a> in Svelte.</p>
<p>The first thing was adding the following line to <code>public/index.html</code>:</p>
<p>&lt;link rel=&#39;manifest&#39; href=&#39;manifest.json&#39;&gt;</p>
<p>And create the <code>manifest.json</code> file in the same folder:</p>
<p><pre><code>
<span class="token punctuation">{</span>
<span class="token string">"background_color"</span><span class="token operator">:</span> <span class="token string">"#ffffff"</span><span class="token punctuation">,</span>
<span class="token string">"theme_color"</span><span class="token operator">:</span> <span class="token string">"#ffebcd"</span><span class="token punctuation">,</span>
<span class="token string">"name"</span><span class="token operator">:</span> <span class="token string">"Svelte Overpass"</span><span class="token punctuation">,</span>
<span class="token string">"short_name"</span><span class="token operator">:</span> <span class="token string">"overpass"</span><span class="token punctuation">,</span>
<span class="token string">"display"</span><span class="token operator">:</span> <span class="token string">"standalone"</span><span class="token punctuation">,</span>
<span class="token string">"start_url"</span><span class="token operator">:</span> <span class="token string">"./"</span><span class="token punctuation">,</span>
<span class="token string">"icons"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
<span class="token punctuation">{</span>
<span class="token string">"src"</span><span class="token operator">:</span> <span class="token string">"images/svelte-overpass-192.png"</span><span class="token punctuation">,</span>
<span class="token string">"sizes"</span><span class="token operator">:</span> <span class="token string">"192x192"</span><span class="token punctuation">,</span>
<span class="token string">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span><span class="token punctuation">,</span>
<span class="token string">"purpose"</span><span class="token operator">:</span> <span class="token string">"any maskable"</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">{</span>
<span class="token string">"src"</span><span class="token operator">:</span> <span class="token string">"images/svelte-overpass-512.png"</span><span class="token punctuation">,</span>
<span class="token string">"sizes"</span><span class="token operator">:</span> <span class="token string">"512x512"</span><span class="token punctuation">,</span>
<span class="token string">"type"</span><span class="token operator">:</span> <span class="token string">"image/png"</span>
<span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token string">"splash_pages"</span><span class="token operator">:</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>
</code></pre></p>
<p>Some lines seem unnecessary but if they are not there, the browser won&#39;t allow the user to save the app on the desktop.</p>
<p>The next step is adding the service worker. This is also necessary. It must have the <code>fetch</code> method, that many times is omitted.</p>
<p><pre><code>

<span class="token keyword">var</span> cacheName <span class="token operator">=</span> <span class="token string">"svelte-overpass-cache-"</span> <span class="token operator">+</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> filesToCache <span class="token operator">=</span> <span class="token punctuation">[</span>
<span class="token string">"/"</span><span class="token punctuation">,</span>
<span class="token string">"./index.html"</span><span class="token punctuation">,</span>
<span class="token string">"./build/bundle.css"</span><span class="token punctuation">,</span>
<span class="token string">"./build/bundle.js"</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"install"</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
e<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span>
caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span>cacheName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">cache</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">return</span> cache<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>filesToCache<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"activate"</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
e<span class="token punctuation">.</span><span class="token function">waitUntil</span><span class="token punctuation">(</span>
caches<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">cacheNames</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>
cacheNames<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">thisCacheName</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>thisCacheName <span class="token operator">!==</span> cacheName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">return</span> caches<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>thisCacheName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"fetch"</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
e<span class="token punctuation">.</span><span class="token function">respondWith</span><span class="token punctuation">(</span>
<span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> caches<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> response <span class="token operator">||</span> <span class="token function">fetch</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></p>
<ul>
<li>Be careful with the paths on the cache! If something fails, the service worker is not installed.</li>
<li>There&#39;s a dedicated section to check that in the dev tools (first two on the <code>application</code> tab)</li>
</ul>
<p>Once this is done, the site must listen to the <code>beforeunnstallprompt</code> event:</p>
<pre><code>window.addEventListener(&quot;beforeinstallprompt&quot;,handleInstall);</code></pre><p>Once the event is stored, it&#39;s possible to call it when clicking a button. Here the function to prepare and the one that actually installs:</p>
<p><pre><code>
<span class="token keyword">const</span> <span class="token function-variable function">handleInstall</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span>Event</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>code<span class="token operator">></span>app install called<span class="token operator">&lt;</span><span class="token operator">/</span>code<span class="token operator">></span><span class="token punctuation">)</span>
e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
deferredPrompt <span class="token operator">=</span> e<span class="token punctuation">;</span>
btnInstallAppVisible <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>code<span class="token operator">></span>app install call complete<span class="token operator">&lt;</span><span class="token operator">/</span>code<span class="token operator">></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">installApp</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token operator">:</span>Event</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
btnInstallAppVisible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
deferredPrompt<span class="token punctuation">.</span><span class="token function">prompt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
deferredPrompt<span class="token punctuation">.</span>userChoice
<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">choiceResult</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>choiceResult<span class="token punctuation">.</span>outcome <span class="token operator">===</span> <span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>accepted<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
btnInstallAppVisible <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>User accepted the <span class="token constant">A2HS</span> prompt<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>User dismissed the <span class="token constant">A2HS</span> prompt<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
deferredPrompt <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span>pre<span class="token operator">></span><span class="token operator">&lt;</span>code<span class="token operator">></span>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>code<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">></span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></p>
<ul>
<li>Unistall app before trying again! I was stuck on this and it&#39;s really frustrating because nothing happens and it&#39;s difficult to know why... To uninstall, open the app and click on the second icon at the top when in a computer.</li>
<li>If the <code>handleInstall</code> function is not logging anything, check the dev tools for some tip.</li>
<li><code>btnInstallAppVisible</code> is the variable that hides the button when the app is installed and the button is not needed anymore.</li>
</ul>
<h1 id="deploying-to-github">Deploying to GitHub</h1>
<p>I have the blog hosted on GitHub pages. It&#39;s easy and everything works in a single account. I never deployed svelte apps there before, so here&#39;s how:</p>
<p><code>npm install gh-pages</code></p>
<p>On <code>package.json</code>, add a <code>deploy</code> script:</p>
<p><code>&quot;deploy&quot;: &quot;gh-pages -d public/&quot;</code></p>
<p>Run it at any moment with:</p>
<p><code>npm run deploy</code></p>
<p>This will build tha app and deploy a <code>gh-pages</code> branch with everything inside <code>public</code> to the repo. What GitHub needs to show the site.</p>
<h1 id="browsers">Browsers</h1>
<p>The app shoud work in most modern browsers. But I&#39;ve found at least, problems with:</p>
<ul>
<li>Safari: It&#39;s supposed to work with some permissions. <a href="https://github.com/aframevr/aframe/issues/3976">Found in an issue</a></li>
<li>Brave: Works with enabling <code>Motion sensors</code> and <code>Location</code> and then changing device orientation. <a href="https://github.com/brave/brave-browser/issues/7964">Found in an issue</a></li>
</ul>
<h1 id="final-thoughts">Final thoughts</h1>
<p>The possibilities are realy cool, but some browsers don&#39;t accept the orientation by default, meaning that most of their users will leave the app without giving the seconds to solve issues. I thing that converting it to a native app shouldn&#39;t be that difficult and would work. Adding the &quot;works better with Chrome&quot; text in an alert is a workaround, but i hate these messages...</p>
<p>Svelte with typescript it&#39;s still compicated to configure for VSCode. I hope that the new <a href="https://svelte.dev/blog/whats-the-deal-with-sveltekit">SvelteKit</a> is better.</p>
<p>And it&#39;s a really fast example, the errors should be handled, I&#39;m sure there&#39;s some bug, etc. Don&#39;t test it too much...</p>
<h1 id="links">Links</h1>
<ul>
<li><a href="https://geoexamples.com/svelte-overpass/">App Link</a></li>
<li><a href="https://en.wikipedia.org/wiki/Progressive_web_application">PWA</a></li>
<li><a href="https://github.com/rveciana/svelte-overpass">GitHub repo</a></li>
<li><a href="https://wiki.openstreetmap.org/wiki/Overpass_API#:~:text=The%20Overpass%20API%20(formerly%20known,that%20corresponds%20to%20the%20query.">Overpass API</a></li>
<li><a href="https://overpass.kumi.systems/">Kumi Overpass Site</a></li>
<li><a href="https://wiki.openstreetmap.org/wiki/Overpass_API/Overpass_QL">Overpass QL</a></li>
<li><a href="https://svelte.dev/blog/svelte-and-typescript">Svelte TypeScript</a></li>
<li><a href="https://svelte.dev/blog/whats-the-deal-with-sveltekit">SvelteKit</a></li>
<li><a href="https://lamplightdev.github.io/compass/">Compass example app</a></li>
<li><a href="https://github.com/NileshSP/personalprofile/blob/master/src/components/biodetails.svelte">PWA example</a></li>
<li><a href="https://github.com/aframevr/aframe/issues/3976">Safari Issue</a></li>
<li><a href="https://github.com/brave/brave-browser/issues/7964">Brave Issue</a></li>
</ul>
</article></div></div></main>
<footer class="site-footer"><div class="wrapper"><div class="footer-col-wrapper"><div class="footer-col  footer-col-1"><ul class="contact-list"><li>GeoExamples - Roger Veciana</li></ul></div>

	<div class="footer-col  footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/rveciana"><span class="icon  icon--github"><svg viewBox="0 0 16 16"><path fill="#89b889" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"></path></svg></span>

						<span class="username">rveciana</span></a></li>

			<li><a href="https://twitter.com/rveciana"><span class="icon  icon--twitter"><svg viewBox="0 0 16 16"><path fill="#89b889" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                    c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"></path></svg></span>

						<span class="username">rveciana</span></a></li>
			<li><a href="https://www.linkedin.com/in/rogerveciana"><span class="icon  icon--twitter"><svg width="16" height="15.28958"><path d="M 0,1.77606 Q 0,1.00386 0.54054,0.50193 1.08108,0 1.94595,0 2.79537,0 3.32047,0.49421 3.86101,1.00386 3.86101,1.8224 q 0,0.74131 -0.5251,1.23552 -0.54054,0.50965 -1.42085,0.50965 l -0.0154,0 q -0.84942,0 -1.37452,-0.50965 Q 4e-5,2.54827 4e-5,1.77606 Z m 0.20078,13.51352 0,-10.3166 3.42857,0 0,10.3166 -3.42857,0 z m 5.32818,0 3.42857,0 0,-5.76062 q 0,-0.54054 0.12355,-0.83398 0.21622,-0.52509 0.65638,-0.88803 0.44015,-0.36293 1.10424,-0.36293 1.72973,0 1.72973,2.33205 l 0,5.51351 3.42857,0 0,-5.91506 Q 16,7.08881 14.91892,5.90734 13.83784,4.72587 12.06178,4.72587 q -1.99228,0 -3.10425,1.71429 l 0,0.0309 -0.0154,0 0.0154,-0.0309 0,-1.46718 -3.42857,0 q 0.0309,0.49421 0.0309,3.07336 0,2.57915 -0.0309,7.24324 z"></path></svg></span>

						<span class="username">rogerveciana</span></a></li></ul></div>

	<div class="footer-col  footer-col-3"><p class="text">I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time.</p>
		<p class="text">Roger Veciana i Rovira</p></div></div></div></footer>



	<script type="svelte-data" url="/summary_pages.json">{"status":200,"statusText":"","headers":{"content-type":"application/json"},"body":"[{\"title\":\"About\",\"permalink\":\"\u002Fabout\",\"excerpt\":\"\u003Cp\u003E{{ site.author.name }}\u003C\u002Fp\u003E\"},{\"title\":\"Projects\",\"permalink\":\"\u002Fprojects\",\"excerpt\":\"\u003Cp\u003ESome of my personal projects:\u003C\u002Fp\u003E\"},{\"title\":\"CV\",\"permalink\":\"\u002Fcv\",\"excerpt\":\"\u003Ch2 id=\\\"jobs\\\"\u003EJobs\u003C\u002Fh2\u003E\",\"avoidMainMenu\":true}]"}</script>

	<script type="svelte-data" url="svelte-overpass.html.json">{"status":200,"statusText":"","headers":{"content-type":"application/json"},"body":"{\"title\":\"Playing with OSM Overpass and Svelte\",\"contents\":\"\u003Cp\u003EIt&#39;s been quite a long time since I wanted to play with the OVerpass API, so I made an example app. I wanted to do it with Svelte too. Finally, the API options I use are quite simple and most of it is done with canvas, but here&#39;s what I learnt!\u003C\u002Fp\u003E\\n\u003Ch1 id=\\\"the-app\\\"\u003EThe App\u003C\u002Fh1\u003E\\n\u003Cp\u003EYou can check the App \u003Ca href=\\\"https:\u002F\u002Fgeoexamples.com\u002Fsvelte-overpass\u002F\\\"\u003Ehere\u003C\u002Fa\u003E. As you can see in the picture, it shows the nearest bars (and more!) around you, taking the data from the Overpass API. It&#39;s a \u003Ca href=\\\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FProgressive_web_application\\\"\u003EPWA\u003C\u002Fa\u003E, so you can install it as a mobile phone application just by clicking a button.\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Ca href=\\\"https:\u002F\u002Fgeoexamples.com\u002Fsvelte-overpass\u002F\\\"\u003E\u003Cimg src=\\\"\u002Fimages\u002Fsvelte\u002Fsvelte-overpass\u002Fapp.gif\\\" width=\\\"300\\\"\u002F\u003E\u003C\u002Fa\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EThe final code can be found at the \u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Frveciana\u002Fsvelte-overpass\\\"\u003EGitHub repo\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\\n\u003Ch1 id=\\\"overpass\\\"\u003EOverpass\u003C\u002Fh1\u003E\\n\u003Cp\u003EThe \u003Ca href=\\\"https:\u002F\u002Fwiki.openstreetmap.org\u002Fwiki\u002FOverpass_API#:~:text=The%20Overpass%20API%20(formerly%20known,that%20corresponds%20to%20the%20query.\\\"\u003EOverpass API\u003C\u002Fa\u003E is a read-only API that server data from the OpenStreetMap project using different query languages. Using it, the whole map for a region could be drawn on the browser (or the backend).\u003C\u002Fp\u003E\\n\u003Cp\u003EI&#39;ve used the \u003Ca href=\\\"https:\u002F\u002Foverpass.kumi.systems\u002F\\\"\u003EKumi\u003C\u002Fa\u003E site for the data, since it doesn&#39;t have limitations and I saw that other sites were using it successfully.\u003C\u002Fp\u003E\\n\u003Cp\u003EThe used query id this one:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Econst address = `https:\u002F\u002Foverpass.kumi.systems\u002Fapi\u002Finterpreter?data=[out:json][timeout:25000];node[&quot;amenity&quot;=&quot;${amenity}&quot;](around:${radius},${lat},${lng});out body;&gt;;out skel qt;`\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EAll the text after the \u003Ccode\u003Edata=\u003C\u002Fcode\u003E part is an \u003Ca href=\\\"https:\u002F\u002Fwiki.openstreetmap.org\u002Fwiki\u002FOverpass_API\u002FOverpass_QL\\\"\u003EOverpass QL query\u003C\u002Fa\u003E. It&#39;s a simple one, and quite easy to understand:\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EOutput format is set to JSON (it can be XML, CSV, etc)\u003C\u002Fli\u003E\\n\u003Cli\u003EA timeout is set (I don&#39;t know if this is strictly necessary)\u003C\u002Fli\u003E\\n\u003Cli\u003EAfter the semicolon (that indicates a new statement), the nodes that are of type \u003Ccode\u003Eamenity=bar\u003C\u002Fcode\u003E are queried.\u003Cul\u003E\\n\u003Cli\u003EThis could be a path, instead of a node\u003C\u002Fli\u003E\\n\u003Cli\u003EThe output is send to the \u003Cem\u003Edefault set\u003C\u002Fem\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003EA filter must be added so we don&#39;t download all OSM database! So we only download the data around a radius.\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003C\u002Fli\u003E\\n\u003Cli\u003EThe final statements set the output format\u003Cul\u003E\\n\u003Cli\u003E\u003Ccode\u003Eout body\u003C\u002Fcode\u003E asks to put all the information to use the data. This is the tags associated to each node in the OSM database (name of the bar, address, website, etc). We will be using the name.\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ccode\u003Eout skel\u003C\u002Fcode\u003E prints all the data for geometry\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ccode\u003Eqt\u003C\u002Fcode\u003E sorts by \u003Ccode\u003Equadtile\u003C\u002Fcode\u003E, a geometry index that makes it faster. I took the queries from examples, and removing it doesn&#39;t change the result.\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003EThere are libraries to convert the data into a GeoJSON, but since we are using points, taking the longitude and latitude is really easy. The format is:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"version\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0.6\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"generator\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"Overpass API 0.7.56.8 7d656e78\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"osm3s\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"timestamp_osm_base\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"2021-01-09T16:31:03Z\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"copyright\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"The data included in this document is from &lt;a href=\\\"\u003C\u002Fspan\u003Ehttp\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Ewww\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eopenstreetmap\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eorg\u003Cspan class=\\\"token string\\\"\u003E\\\"\u003Ewww.openstreetmap.org&lt;\u002Fa\u003E. The data is made available under ODbL.\\\"\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"elements\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"type\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"node\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"id\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E1305366218\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"lat\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E41.3937290\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"lon\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E2.1495210\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"tags\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"addr:street\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"Diagonal\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"amenity\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"bar\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"name\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"Bar Teo\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"outdoor_seating\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"yes\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"toilets:wheelchair\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"no\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"wheelchair\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"no\\\"\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E...\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003ESo for each object in \u003Ccode\u003Eelements\u003C\u002Fcode\u003E we can find all the information for one of the results. The code to process the data is:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ethen\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Edata\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003Efeatures \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E data\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eelements\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Emap\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Ed\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003Eeasting\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E dataX\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E northing\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E dataY\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EfromLatLon\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ed\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Elat\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E d\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Elon\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E dist \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E Math\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esqrt\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EdataX \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E utmX\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Estrong\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EdataY \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E utmY\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Estrong\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E dir \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E180\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003EMath\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token constant\\\"\u003EPI\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E*\u003C\u002Fspan\u003E Math\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eatan2\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EdataX \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E utmX\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edist\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EdataY \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E utmY\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edist\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003Ename\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E d\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Etags\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ename\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E lng\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E d\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Elon\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E lat\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E d\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Elat\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E dist\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E dir\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efilter\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Ed\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E d\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ename\u003Cspan class=\\\"token operator\\\"\u003E!==\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Eundefined\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esort\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Ea\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E b\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E a\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Edist \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E b\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Edist\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EfromLatLon is a small library that converts from latlon to utm coordinates. This way, we can calculate distances and directions from our current position (see \u003Cem\u003Ecompass\u003C\u002Fem\u003E section)\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Ch1 id=\\\"the-svelte-app\\\"\u003EThe Svelte App\u003C\u002Fh1\u003E\\n\u003Cp\u003EI created the app using the instructions from the \u003Ca href=\\\"https:\u002F\u002Fsvelte.dev\u002Fblog\u002Fsvelte-and-typescript\\\"\u003ESvelte TypeScript post\u003C\u002Fa\u003E. I had to touch a pair of things\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003E\u003Cp\u003EThe paths on \u003Ccode\u003Eindex.html\u003C\u002Fcode\u003E to \u003Ccode\u003Ebundle.js\u003C\u002Fcode\u003E, \u003Ccode\u003Ebundle.css\u003C\u002Fcode\u003E and so on are by default on the root path. If you don&#39;t have a dedicated domain, this will make the app fail when deployed, since \u003Cem\u003ESvelte\u003C\u002Fem\u003E doesn&#39;t have a \u003Cem\u003Ebasepath\u003C\u002Fem\u003E option as \u003Cem\u003Esapper\u003C\u002Fem\u003E (or I didn&#39;t find it). Luckily, just making the paths relative works, so:\u003C\u002Fp\u003E\\n\u003Cp\u003E&lt;script defer src=&#39;\u002Fbuild\u002Fbundle.js&#39;&gt;&lt;\u002Fscript&gt;\u003C\u002Fp\u003E\\n\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003Ebecomes\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003E&lt;script defer src=&#39;\u002Fbuild\u002Fbundle.js&#39;&amp;gt;&amp;lt;\u002Fscript&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cul\u003E\\n\u003Cli\u003EI added several tags so \u003Cem\u003Elighthouse\u003C\u002Fem\u003E improves the score. Like \u003Ccode\u003Eapple-touch-icon\u003C\u002Fcode\u003E, \u003Ccode\u003EDescription\u003C\u002Fcode\u003E, etc. The default template misses several things of this style.\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003EThe App.svelte file is quite simple. It has only the canvas element and the selector. All the other stuff is to initialize the PWA and compass, as we will see. The data is drawn in a separate file.\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003E\u003Cp\u003EI struggled a little with the canvas component, because I was setting the size. When doing so, the app got stuck depending on the situation. So the best is creating it like:\u003C\u002Fp\u003E\\n  \u003Ccanvas bind:this={canvas}\u003E\\n\\n\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003Eand getting the desired size in a reactive variable like:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003E$: canvasSize = Math.min(containerWidth&gt;containerHeight?containerHeight:containerWidth, 500);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EThis makes the size to be always adjusted to the container shortest size with a max of 500px. To get the container size, the \u003Ccode\u003EclientWidth\u003C\u002Fcode\u003E property can be bound on the container element:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003E&lt;main bind:clientWidth={containerWidth} bind:clientHeight={containerHeight}&gt;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003ESvelte is so cool ;)!\u003C\u002Fp\u003E\\n\u003Ch1 id=\\\"the-compass\\\"\u003EThe compass\u003C\u002Fh1\u003E\\n\u003Cp\u003EThe nice part of the app is the moving compass. To get it, we need three things:\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EGetting the geograpgical coordinates\u003C\u002Fli\u003E\\n\u003Cli\u003EGetting the device orientation (the geographical one) and the screen orientation (landscape or portrait)\u003C\u002Fli\u003E\\n\u003Cli\u003EDrawing the data\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003EGetting the location is quite standard, just listening to \u003Ccode\u003Enavigator.geolocation.watchPosition\u003C\u002Fcode\u003E and calling a callback. The browser will ask for permission.\u003C\u002Fp\u003E\\n\u003Cp\u003EThe orientation seemed easy too, but it&#39;s not. I found a \u003Ca href=\\\"https:\u002F\u002Flamplightdev.github.io\u002Fcompass\u002F\\\"\u003Ecompass example\u003C\u002Fa\u003E (with an error, always points to the initial device position) but many browsers require special configurations to allow the orientation to be read.\u003C\u002Fp\u003E\\n\u003Cp\u003EThe event to listen to is \u003Ccode\u003Ewindow.addEventListener(&quot;deviceorientationabsolute&quot;, setHeading);\u003C\u002Fcode\u003E (not a navigator event!?). And it&#39;s using a callback too. In this case, an angle has to be added if the device is in landscape mode (and it can have two positions in landscape mode). The screen orientation lives in the \u003Ccode\u003Escreen\u003C\u002Fcode\u003E object.\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E screenOrientation \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Escreen\u003Cspan class=\\\"token operator\\\"\u003E?.\u003C\u002Fspan\u003Eorientation\u003Cspan class=\\\"token operator\\\"\u003E?.\u003C\u002Fspan\u003Etype\u003Cspan class=\\\"token operator\\\"\u003E??\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"portrait-primary\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esplit\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"-\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E adjustment \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E screenOrientation\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E===\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"portrait\\\"\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E?\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E90\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E adjustment2 \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E screenOrientation\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E===\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"secondary\\\"\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E?\u003C\u002Fspan\u003E adjustment \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E180\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E adjustment\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\nheading \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E adjustment2 \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E ev\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ealpha\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EAgain, Svelte makes really easy everything. If something in the function arguments change, the function is called. It&#39;s like the \u003Ccode\u003EuseEffect\u003C\u002Fcode\u003E in react, but better!\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003E$: drawCompass(canvas, canvasSize, features, heading);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EThe same hapens to fire the fetch data function. If \u003Ccode\u003Eamenity\u003C\u002Fcode\u003E, \u003Ccode\u003Elon\u003C\u002Fcode\u003E or \u003Ccode\u003Elat\u003C\u002Fcode\u003E change, the code is run again.\u003C\u002Fp\u003E\\n\u003Cp\u003ETo draw the data, I separated the code to a function \u003Ccode\u003EdrawCompass\u003C\u002Fcode\u003E with its own file \u003Ccode\u003Edraw-compass.ts\u003C\u002Fcode\u003E. The funtion uses the typical functions for canvas, so I won&#39;t copy all the code here.\u003C\u002Fp\u003E\\n\u003Ch1 id=\\\"pwa\\\"\u003EPWA\u003C\u002Fh1\u003E\\n\u003Cp\u003EThis web is a clear candidate to become a PWA since it&#39;s much better on a mobile device that has orientation sensor. To do it I found a \u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002FNileshSP\u002Fpersonalprofile\u002Fblob\u002Fmaster\u002Fsrc\u002Fcomponents\u002Fbiodetails.svelte\\\"\u003Esingle example\u003C\u002Fa\u003E in Svelte.\u003C\u002Fp\u003E\\n\u003Cp\u003EThe first thing was adding the following line to \u003Ccode\u003Epublic\u002Findex.html\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\\n\u003Cp\u003E&lt;link rel=&#39;manifest&#39; href=&#39;manifest.json&#39;&gt;\u003C\u002Fp\u003E\\n\u003Cp\u003EAnd create the \u003Ccode\u003Emanifest.json\u003C\u002Fcode\u003E file in the same folder:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"background_color\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"#ffffff\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"theme_color\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"#ffebcd\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"name\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"Svelte Overpass\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"short_name\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"overpass\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"display\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"standalone\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"start_url\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\".\u002F\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"icons\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"src\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"images\u002Fsvelte-overpass-192.png\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"sizes\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"192x192\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"type\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"image\u002Fpng\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"purpose\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"any maskable\\\"\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"src\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"images\u002Fsvelte-overpass-512.png\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"sizes\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"512x512\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"type\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"image\u002Fpng\\\"\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"splash_pages\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Enull\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003ESome lines seem unnecessary but if they are not there, the browser won&#39;t allow the user to save the app on the desktop.\u003C\u002Fp\u003E\\n\u003Cp\u003EThe next step is adding the service worker. This is also necessary. It must have the \u003Ccode\u003Efetch\u003C\u002Fcode\u003E method, that many times is omitted.\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E cacheName \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"svelte-overpass-cache-\\\"\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E Date\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Enow\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E filesToCache \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\"\u002F\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\".\u002Findex.html\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\".\u002Fbuild\u002Fbundle.css\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token string\\\"\u003E\\\".\u002Fbuild\u002Fbundle.js\\\"\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\nself\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EaddEventListener\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"install\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Ee\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\ne\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EwaitUntil\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\\ncaches\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eopen\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EcacheName\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ethen\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Ecache\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E cache\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EaddAll\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EfilesToCache\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\nself\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EaddEventListener\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"activate\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token parameter\\\"\u003Ee\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\ne\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EwaitUntil\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\\ncaches\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ekeys\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ethen\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003EcacheNames\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E Promise\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eall\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\\ncacheNames\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Emap\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003EthisCacheName\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EthisCacheName \u003Cspan class=\\\"token operator\\\"\u003E!==\u003C\u002Fspan\u003E cacheName\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E caches\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Edelete\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EthisCacheName\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\nself\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EaddEventListener\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"fetch\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token parameter\\\"\u003Ee\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\ne\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003ErespondWith\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E response \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eawait\u003C\u002Fspan\u003E caches\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ematch\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ee\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Erequest\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E response \u003Cspan class=\\\"token operator\\\"\u003E||\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003Efetch\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ee\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Erequest\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EBe careful with the paths on the cache! If something fails, the service worker is not installed.\u003C\u002Fli\u003E\\n\u003Cli\u003EThere&#39;s a dedicated section to check that in the dev tools (first two on the \u003Ccode\u003Eapplication\u003C\u002Fcode\u003E tab)\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003EOnce this is done, the site must listen to the \u003Ccode\u003Ebeforeunnstallprompt\u003C\u002Fcode\u003E event:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Ewindow.addEventListener(&quot;beforeinstallprompt&quot;,handleInstall);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EOnce the event is stored, it&#39;s possible to call it when clicking a button. Here the function to prepare and the one that actually installs:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function-variable function\\\"\u003EhandleInstall\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Ee\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003EEvent\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\nconsole\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ecode\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003Eapp install called\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Ecode\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\ne\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EpreventDefault\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\ndeferredPrompt \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E e\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\nbtnInstallAppVisible \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token boolean\\\"\u003Etrue\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\nconsole\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ecode\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003Eapp install call complete\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Ecode\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function-variable function\\\"\u003EinstallApp\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Ee\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003EEvent\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\nbtnInstallAppVisible \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token boolean\\\"\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\ndeferredPrompt\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eprompt\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\ndeferredPrompt\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003EuserChoice\\n\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ethen\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003EchoiceResult\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EchoiceResult\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eoutcome \u003Cspan class=\\\"token operator\\\"\u003E===\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003Eaccepted\u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\nbtnInstallAppVisible \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token boolean\\\"\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\nconsole\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003EUser accepted the \u003Cspan class=\\\"token constant\\\"\u003EA2HS\u003C\u002Fspan\u003E prompt\u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\nconsole\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003EUser dismissed the \u003Cspan class=\\\"token constant\\\"\u003EA2HS\u003C\u002Fspan\u003E prompt\u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\ndeferredPrompt \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Enull\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Epre\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ecode\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E    \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Ecode\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epre\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EUnistall app before trying again! I was stuck on this and it&#39;s really frustrating because nothing happens and it&#39;s difficult to know why... To uninstall, open the app and click on the second icon at the top when in a computer.\u003C\u002Fli\u003E\\n\u003Cli\u003EIf the \u003Ccode\u003EhandleInstall\u003C\u002Fcode\u003E function is not logging anything, check the dev tools for some tip.\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ccode\u003EbtnInstallAppVisible\u003C\u002Fcode\u003E is the variable that hides the button when the app is installed and the button is not needed anymore.\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Ch1 id=\\\"deploying-to-github\\\"\u003EDeploying to GitHub\u003C\u002Fh1\u003E\\n\u003Cp\u003EI have the blog hosted on GitHub pages. It&#39;s easy and everything works in a single account. I never deployed svelte apps there before, so here&#39;s how:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Ccode\u003Enpm install gh-pages\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EOn \u003Ccode\u003Epackage.json\u003C\u002Fcode\u003E, add a \u003Ccode\u003Edeploy\u003C\u002Fcode\u003E script:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Ccode\u003E&quot;deploy&quot;: &quot;gh-pages -d public\u002F&quot;\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003ERun it at any moment with:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Ccode\u003Enpm run deploy\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EThis will build tha app and deploy a \u003Ccode\u003Egh-pages\u003C\u002Fcode\u003E branch with everything inside \u003Ccode\u003Epublic\u003C\u002Fcode\u003E to the repo. What GitHub needs to show the site.\u003C\u002Fp\u003E\\n\u003Ch1 id=\\\"browsers\\\"\u003EBrowsers\u003C\u002Fh1\u003E\\n\u003Cp\u003EThe app shoud work in most modern browsers. But I&#39;ve found at least, problems with:\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003ESafari: It&#39;s supposed to work with some permissions. \u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Faframevr\u002Faframe\u002Fissues\u002F3976\\\"\u003EFound in an issue\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003EBrave: Works with enabling \u003Ccode\u003EMotion sensors\u003C\u002Fcode\u003E and \u003Ccode\u003ELocation\u003C\u002Fcode\u003E and then changing device orientation. \u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Fbrave\u002Fbrave-browser\u002Fissues\u002F7964\\\"\u003EFound in an issue\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Ch1 id=\\\"final-thoughts\\\"\u003EFinal thoughts\u003C\u002Fh1\u003E\\n\u003Cp\u003EThe possibilities are realy cool, but some browsers don&#39;t accept the orientation by default, meaning that most of their users will leave the app without giving the seconds to solve issues. I thing that converting it to a native app shouldn&#39;t be that difficult and would work. Adding the &quot;works better with Chrome&quot; text in an alert is a workaround, but i hate these messages...\u003C\u002Fp\u003E\\n\u003Cp\u003ESvelte with typescript it&#39;s still compicated to configure for VSCode. I hope that the new \u003Ca href=\\\"https:\u002F\u002Fsvelte.dev\u002Fblog\u002Fwhats-the-deal-with-sveltekit\\\"\u003ESvelteKit\u003C\u002Fa\u003E is better.\u003C\u002Fp\u003E\\n\u003Cp\u003EAnd it&#39;s a really fast example, the errors should be handled, I&#39;m sure there&#39;s some bug, etc. Don&#39;t test it too much...\u003C\u002Fp\u003E\\n\u003Ch1 id=\\\"links\\\"\u003ELinks\u003C\u002Fh1\u003E\\n\u003Cul\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fgeoexamples.com\u002Fsvelte-overpass\u002F\\\"\u003EApp Link\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FProgressive_web_application\\\"\u003EPWA\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Frveciana\u002Fsvelte-overpass\\\"\u003EGitHub repo\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fwiki.openstreetmap.org\u002Fwiki\u002FOverpass_API#:~:text=The%20Overpass%20API%20(formerly%20known,that%20corresponds%20to%20the%20query.\\\"\u003EOverpass API\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Foverpass.kumi.systems\u002F\\\"\u003EKumi Overpass Site\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fwiki.openstreetmap.org\u002Fwiki\u002FOverpass_API\u002FOverpass_QL\\\"\u003EOverpass QL\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fsvelte.dev\u002Fblog\u002Fsvelte-and-typescript\\\"\u003ESvelte TypeScript\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fsvelte.dev\u002Fblog\u002Fwhats-the-deal-with-sveltekit\\\"\u003ESvelteKit\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Flamplightdev.github.io\u002Fcompass\u002F\\\"\u003ECompass example app\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002FNileshSP\u002Fpersonalprofile\u002Fblob\u002Fmaster\u002Fsrc\u002Fcomponents\u002Fbiodetails.svelte\\\"\u003EPWA example\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Faframevr\u002Faframe\u002Fissues\u002F3976\\\"\u003ESafari Issue\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Fbrave\u002Fbrave-browser\u002Fissues\u002F7964\\\"\u003EBrave Issue\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\",\"tags\":[\"osm\",\"overpass\"],\"date\":\"2021-01-10T00:00:00.000Z\"}"}</script>
</div>
	</body>
</html>
