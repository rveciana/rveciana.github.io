<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=G-BD6G9PF6NH"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag('js', new Date());

			gtag('config', 'G-BD6G9PF6NH');
		</script>

		<meta charset="utf-8" />
		<link rel="icon" href="/favicon.ico" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="manifest" href="/manifest.json" />
		<meta name="theme-color" content="#cdffcd" />
		<!-- HTML Meta Tags -->
		<meta
			name="description"
			content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time."
		/>
		<!-- Google / Search Engine Tags -->
		<meta itemprop="name" content=">GeoExamples - Roger Veciana" />
		<meta
			itemprop="description"
			content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time."
		/>
		<meta itemprop="image" content="https://geoexamples.com/siteImage.png" />

		<title>GeoExamples - Using RxPY to process GIS files dependencies</title><meta name="twitter:card" content="summary" data-svelte="svelte-w2s84v"><meta name="twitter:title" content="GeoExamples - Using RxPY to process GIS files dependencies" data-svelte="svelte-w2s84v"><meta name="twitter:description" content="&lt;p&gt;&lt;a href=&quot;http://r" data-svelte="svelte-w2s84v"><meta name="twitter:image" content="https://geoexamples.com/images/python/rxpy/twitter.png" data-svelte="svelte-w2s84v"><meta property="og:url" content="https://geoexamples.com" data-svelte="svelte-w2s84v"><meta property="og:type" content="website" data-svelte="svelte-w2s84v"><meta property="og:title" content="GeoExamples - Using RxPY to process GIS files dependencies" data-svelte="svelte-w2s84v"><meta property="og:description" content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time." data-svelte="svelte-w2s84v"><meta property="og:image" content="https://geoexamples.com/images/python/rxpy/twitter.png" data-svelte="svelte-w2s84v">

		

		<link rel="modulepreload" href="/_app/start-9934143f.js">
		<link rel="modulepreload" href="/_app/chunks/vendor-f4f84e30.js">
		<link rel="modulepreload" href="/_app/pages/__layout.svelte-b5745e7e.js">
		<link rel="modulepreload" href="/_app/chunks/config-b3bde751.js">
		<link rel="modulepreload" href="/_app/pages/[category]/[year]/[month]/[date]/[slug].svelte-dcec41b3.js">
		<link rel="stylesheet" href="/_app/assets/start-a8cd1609.css">
		<link rel="stylesheet" href="/_app/assets/pages/__layout.svelte-294fb61c.css">

		<script type="module">
			import { start } from "/_app/start-9934143f.js";
			start({
				target: document.querySelector("#svelte"),
				paths: {"base":"","assets":""},
				session: {},
				host: location.host,
				route: true,
				spa: false,
				trailing_slash: "never",
				hydrate: {
					status: 200,
					error: null,
					nodes: [
						import("/_app/pages/__layout.svelte-b5745e7e.js"),
						import("/_app/pages/[category]/[year]/[month]/[date]/[slug].svelte-dcec41b3.js")
					],
					page: {
						host: location.host, // TODO this is redundant
						path: "/python/2021/10/12/dependencies-rx.html",
						query: new URLSearchParams(""),
						params: {"category":"python","year":"2021","month":"10","date":"12","slug":"dependencies-rx.html"}
					}
				}
			});
		</script>
	</head>
	<body>
		<div id="svelte">


<header class="site-header"><div class="wrapper"><a class="site-title" href="/">GeoExamples - Roger Veciana</a>

<nav class="site-nav"><div href="#" class="menu-icon"><svg viewBox="0 0 18 15"><path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path><path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path><path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path></svg></div>

	<div class="trigger"><a class="page-link" href="/about">About</a><a class="page-link" href="/blog">Blog</a><a class="page-link" href="/projects">Projects</a></div></nav></div></header>

<main class="page-content"><div class="wrapper">
<div class="post"><header class="post-header"><h1 class="post-title">Using RxPY to process GIS files dependencies</h1>
<p class="post-meta">Oct 12, 2021</p></header>

	<article class="post-content"><!-- HTML_TAG_START --><p><a href="http://reactivex.io/">Reactive programming</a> is amazing. Hard to understand when you first see it, it solves problems that are really difficult to code without it. It&#39;s available in many languages and very well-known by AngularJS users, because it makes an extensive use of it. </p>
<h1 id="the-problem">The problem</h1>
<p>Let&#39;s see what&#39;s reactive programming before seeing a &quot;real&quot; use case. The easiest way to define it (for me) is comparing it to an Excel file:
<img src="/images/python/rxpy/spreadsheet.png" /></p>
<ul>
<li>The first two columns are independent values</li>
<li>Columns C and D depend on A and B</li>
<li>Column E depends on column D</li>
<li>Note that some columns are <em>subscribed</em> to other columns and that all any column can be <em>subscribed</em> by others. </li>
<li>Values in E depend on D, which depends on A and B, but E doesn&#39;t know or better, doesn&#39;t care about this. <ul>
<li>You can change the formula for D and E will still work.</li>
</ul>
</li>
</ul>
<p>Let&#39;s imagine a GIS example now. <a href="https://github.com/meteocat/pypros">pypros</a> is a software I contributed in some time ago when working at the Catalan Meteorological Service. </p>
<p>Basically, it takes the temperature field, the relative humidity (or dew point temperature), the radar signal and outputs a file where each pixel has a value depending on the type of precipitation. You can <a href="https://www.meteo.cat/observacions/plujaONeu">see it in action here</a>.</p>
<img src="/images/python/rxpy/flow.png" />

<ul>
<li>With temperature and the Dew point, we get what would happen if there was precipitation in a given point</li>
<li>With the previous result and the radar image, we can get the final product</li>
<li>The main problem to code this is that the frequencies aren&#39;t equal for all the fields, so coding it directly means remembering the latest processed images and so on</li>
<li>Complicating the diagram is easy with reactive programming because each step will be watching only the interesting observables</li>
</ul>
<h1 id="the-code">The code</h1>
<p>As usual, you can <a href="https://github.com/rveciana/rxpyexample">get the code at GitHub</a>.</p>
<p>So the first thing to do is act when some file appears. The file could be a temperature, dew point or radar file. To do it, we&#39;ll use the <a href="https://python-watchdog.readthedocs.io/en/stable/"><em>watchdog</em> library</a></p>
<p><pre><code><span class="token keyword">import</span> time
from watchdog<span class="token punctuation">.</span>events <span class="token keyword">import</span> FileSystemEventHandler
from watchdog<span class="token punctuation">.</span>observers <span class="token keyword">import</span> Observer
from observables <span class="token keyword">import</span> source

<span class="token keyword">class</span> <span class="token class-name">MyHandler</span><span class="token punctuation">(</span>FileSystemEventHandler<span class="token punctuation">)</span><span class="token operator">:</span>
    def <span class="token function">next_source</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token operator">:</span>
        source<span class="token punctuation">.</span><span class="token function">on_next</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    def <span class="token function">on_created</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token operator">:</span>
        self<span class="token punctuation">.</span><span class="token function">next_source</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>src_path<span class="token punctuation">)</span>
    def <span class="token function">on_modified</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token operator">:</span>
        self<span class="token punctuation">.</span><span class="token function">next_source</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>src_path<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token operator">:</span>
    path <span class="token operator">=</span> <span class="token string">'./data'</span>
    event_handler <span class="token operator">=</span> <span class="token function">MyHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    observer <span class="token operator">=</span> <span class="token function">Observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    observer<span class="token punctuation">.</span><span class="token function">schedule</span><span class="token punctuation">(</span>event_handler<span class="token punctuation">,</span> path<span class="token punctuation">,</span> recursive<span class="token operator">=</span>True<span class="token punctuation">)</span>
    observer<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token operator">:</span>
        <span class="token keyword">while</span> True<span class="token operator">:</span>
            time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    finally<span class="token operator">:</span>
        observer<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        observer<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></p>
<ul>
<li>The <em>Observer</em> object will call the methods in <em>MyHandler</em> when some change occurs in the path</li>
<li><em>source</em> is the RxPY thing that we&#39;ll see next. When something changes, the <em>on_next</em> method is called with the path for the file that changed</li>
</ul>
<p>Let&#39;s see now a first version of the <em>RxPY</em> part
<pre><code><span class="token keyword">import</span> time
from os<span class="token punctuation">.</span>path <span class="token keyword">import</span> basename
from pathlib <span class="token keyword">import</span> Path
<span class="token keyword">import</span> rx
from rx <span class="token keyword">import</span> operators <span class="token keyword">as</span> ops
from rx<span class="token punctuation">.</span>subject <span class="token keyword">import</span> Subject

def <span class="token function">get_date</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">:</span>
    <span class="token keyword">return</span> x<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">".tiff"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>

def <span class="token function">process_potential_ros</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">:</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"CREATING POTENTIAL ROS"</span><span class="token punctuation">,</span> <span class="token string">'./data/pot_pon_'</span><span class="token operator">+</span><span class="token function">get_date</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"-"</span><span class="token operator">+</span><span class="token function">get_date</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">".tiff"</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">Path</span><span class="token punctuation">(</span><span class="token string">'./data/pot_ros_'</span><span class="token operator">+</span><span class="token function">get_date</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"-"</span><span class="token operator">+</span><span class="token function">get_date</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">".tiff"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

def <span class="token function">process_ros</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">:</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"CREATING ROS FILE"</span><span class="token punctuation">,</span> <span class="token string">'./data/pon_'</span><span class="token operator">+</span><span class="token function">get_date</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"-"</span><span class="token operator">+</span><span class="token function">get_date</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">".tiff"</span><span class="token punctuation">)</span>
    time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token function">Path</span><span class="token punctuation">(</span><span class="token string">'./data/ros_'</span><span class="token operator">+</span><span class="token function">get_date</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"-"</span><span class="token operator">+</span><span class="token function">get_date</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">".tiff"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

source <span class="token operator">=</span> <span class="token function">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

td <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>ops<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>lambda text<span class="token operator">:</span> text<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'td'</span><span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
temp <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>ops<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>lambda text<span class="token operator">:</span> text<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'temp'</span><span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
radar <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>ops<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>lambda text<span class="token operator">:</span> text<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'radar'</span><span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
pot_ros <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>ops<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>lambda text<span class="token operator">:</span> text<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'pot_ros'</span><span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

rx<span class="token punctuation">.</span><span class="token function">combine_latest</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> td<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>process_potential_ros<span class="token punctuation">)</span>
rx<span class="token punctuation">.</span><span class="token function">combine_latest</span><span class="token punctuation">(</span>pot_ros<span class="token punctuation">,</span> radar<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>process_ros<span class="token punctuation">)</span>
</code></pre></p>
<ul>
<li>The first functions are just mock functions that simulate the creation of the actual files. That&#39;s why the <em>time.sleep()</em> is there</li>
<li><em>source</em> is a <em>Subject</em>, that can recieve the <em>on_next</em> method and be subscribed. Basically, whan any file changes, the <em>source</em> will emit its path</li>
<li>The next lines are <em>observables</em> subscribed to source. They filter the path so they will only emit when the string appears in the path. To when a temperature file appears, the path is emitted by <em>temp</em></li>
<li>Finally, <em>combine_latest</em> takes two observables and emits an event with the latest values for each one. You can <a href="https://rxmarbles.com/#combineLatest">check the diagram here</a><ul>
<li>The first one creates the <em>potential RoS</em> file that will trigger the <em>source</em> again, because it creates a file</li>
<li>The second one takes the previpusly created file and the radar to create the final image</li>
</ul>
</li>
</ul>
<p>The output is something similar to:
<pre><code>
<span class="token constant">CREATING</span> <span class="token constant">POTENTIAL</span> <span class="token constant">ROS</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pot_pon_202101010000<span class="token operator">-</span><span class="token number">202101010000.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">ROS</span> <span class="token constant">FILE</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pon_202101010000<span class="token operator">-</span><span class="token number">202101010000.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">ROS</span> <span class="token constant">FILE</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pon_202101010000<span class="token operator">-</span><span class="token number">202101010006.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">ROS</span> <span class="token constant">FILE</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pon_202101010000<span class="token operator">-</span><span class="token number">202101010012.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">ROS</span> <span class="token constant">FILE</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pon_202101010000<span class="token operator">-</span><span class="token number">202101010018.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">ROS</span> <span class="token constant">FILE</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pon_202101010000<span class="token operator">-</span><span class="token number">202101010024.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">ROS</span> <span class="token constant">FILE</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pon_202101010000<span class="token operator">-</span><span class="token number">202101010030.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">ROS</span> <span class="token constant">FILE</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pon_202101010000<span class="token operator">-</span><span class="token number">202101010036.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">ROS</span> <span class="token constant">FILE</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pon_202101010000<span class="token operator">-</span><span class="token number">202101010042.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">ROS</span> <span class="token constant">FILE</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pon_202101010000<span class="token operator">-</span><span class="token number">202101010048.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">ROS</span> <span class="token constant">FILE</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pon_202101010000<span class="token operator">-</span><span class="token number">202101010054.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">ROS</span> <span class="token constant">FILE</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pon_202101010000<span class="token operator">-</span><span class="token number">202101010100.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">POTENTIAL</span> <span class="token constant">ROS</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pot_pon_202101010100<span class="token operator">-</span><span class="token number">202101010000.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">POTENTIAL</span> <span class="token constant">ROS</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pot_pon_202101010100<span class="token operator">-</span><span class="token number">202101010100.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">ROS</span> <span class="token constant">FILE</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pon_202101010000<span class="token operator">-</span><span class="token number">202101010106.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">ROS</span> <span class="token constant">FILE</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pon_202101010000<span class="token operator">-</span><span class="token number">202101010106.</span>tiff
<span class="token constant">CREATING</span> <span class="token constant">ROS</span> <span class="token constant">FILE</span> <span class="token punctuation">.</span><span class="token operator">/</span>data<span class="token operator">/</span>pon_202101010100<span class="token operator">-</span><span class="token number">202101010106.</span>tiff 
</code></pre></p>
<p>To do it, I created a file that generates radar and temperature and td files like this:</p>
<p><pre><code>from pathlib <span class="token keyword">import</span> Path
<span class="token keyword">import</span> time

<span class="token function">Path</span><span class="token punctuation">(</span><span class="token string">'./data/temp-202101010000.tiff'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">Path</span><span class="token punctuation">(</span><span class="token string">'./data/radar-202101010000.tiff'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">Path</span><span class="token punctuation">(</span><span class="token string">'./data/td-202101010000.tiff'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">Path</span><span class="token punctuation">(</span><span class="token string">'./data/radar-202101010006.tiff'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">...</span>
</code></pre></p>
<h1 id="improving-the-code-by-using-more-rxpy">Improving the code by using more RxPY</h1>
<p>The previous code has three problems (at least)</p>
<ol>
<li>The <em>Potential Rain Or Snow</em> is saved in a file. This is not wring but it&#39;s an intermediate step and maybe we don&#39;t want to save it</li>
<li>There are two <em>Potential Rain Or Snow</em> created at the end. This is because <em>combine_latest</em> will emit twice when eiter Td or Temperature appear. Usually, we only want this to be created if the dates for both files are identical (they should appear more or less at the same time)</li>
<li><em>time.sleep()</em> will block the process. If the file generation lasts a lot, some events will have to wait. It would be much nicer if this calculation happens in another process and when is finished, emits the event (or saves the file)</li>
</ol>
<p>To solve the first point, we&#39;ll use <em>map</em>, that converts the input value to another thing, as in functional programming:</p>
<p><pre><code>pot_ros <span class="token operator">=</span> rx<span class="token punctuation">.</span><span class="token function">combine_latest</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> td<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>ops<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>create_pot_data<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></p>
<p>Then, when subscribing to the <em>pot_ros observable</em> we could receive the calculated field (calculated in <em>create_pot_data</em>) without having to save</p>
<p>To avoid <em>create_pot_data</em> to be run twice when <em>td</em> and <em>temperature</em> are different, a filter can be used:</p>
<p><pre><code>pot_ros <span class="token operator">=</span> rx<span class="token punctuation">.</span><span class="token function">combine_latest</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> td<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>ops<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>lambda values<span class="token operator">:</span> <span class="token function">get_date</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">get_date</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ops<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>create_pot_data<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></p>
<p>This way, only the elements that match the filter function will pass to the map.</p>
<p>Finally, to solve the process blocking, we can add a <em>ops.subscribe_on(thread_pool_scheduler)</em>. This will make each subscription to run in a different process. I added a long sleep time to the file creation to show that in the same pipe, everything i in the same process. Probably this can be avoided with<a href="https://rxpy.readthedocs.io/en/latest/get_started.html"><em>flat_map</em> and <em>from_future</em></a>, but I&#39;m not sure that it&#39;s a nice feature in a real case.</p>
<p><pre><code><span class="token keyword">import</span> multiprocessing
<span class="token keyword">import</span> time
from os<span class="token punctuation">.</span>path <span class="token keyword">import</span> basename
from pathlib <span class="token keyword">import</span> Path

<span class="token keyword">import</span> rx
from rx <span class="token keyword">import</span> operators <span class="token keyword">as</span> ops
from rx<span class="token punctuation">.</span>core<span class="token punctuation">.</span>typing <span class="token keyword">import</span> Observable
from rx<span class="token punctuation">.</span>scheduler <span class="token keyword">import</span> ThreadPoolScheduler
from rx<span class="token punctuation">.</span>subject <span class="token keyword">import</span> Subject

thread_count <span class="token operator">=</span> multiprocessing<span class="token punctuation">.</span><span class="token function">cpu_count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
thread_pool_scheduler <span class="token operator">=</span> <span class="token function">ThreadPoolScheduler</span><span class="token punctuation">(</span>thread_count<span class="token punctuation">)</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"Cpu count is : {0}"</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>thread_count<span class="token punctuation">)</span><span class="token punctuation">)</span>

def <span class="token function">get_date</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">:</span>
    <span class="token keyword">return</span> x<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">".tiff"</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>

def <span class="token function">process_ros</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">:</span>
    fut <span class="token operator">=</span> asyncio<span class="token punctuation">.</span><span class="token function">create_task</span><span class="token punctuation">(</span><span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    def <span class="token function">when_finished</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>em<span class="token operator">></span>fut<span class="token punctuation">)</span><span class="token operator">:</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"CREATING ROS FILE"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
        <span class="token function">Path</span><span class="token punctuation">(</span><span class="token string">'./data/ros&lt;/em>'</span><span class="token operator">+</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"-"</span><span class="token operator">+</span><span class="token function">get_date</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">".tiff"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">touch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    fut<span class="token punctuation">.</span><span class="token function">add_done_callback</span><span class="token punctuation">(</span>when_finished<span class="token punctuation">)</span>

def <span class="token function">create_pot_data</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">:</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"CREATING POT ROS DATA"</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span>
    time<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token function">get_date</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

source <span class="token operator">=</span> <span class="token function">Subject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

td <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>ops<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>lambda text<span class="token operator">:</span> text<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'td'</span><span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ops<span class="token punctuation">.</span><span class="token function">subscribe_on</span><span class="token punctuation">(</span>thread_pool_scheduler<span class="token punctuation">)</span><span class="token punctuation">)</span>
temp <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>ops<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>lambda text<span class="token operator">:</span> text<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'temp'</span><span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ops<span class="token punctuation">.</span><span class="token function">subscribe_on</span><span class="token punctuation">(</span>thread_pool_scheduler<span class="token punctuation">)</span><span class="token punctuation">)</span>
radar <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>ops<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>lambda text<span class="token operator">:</span> text<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token string">'radar'</span><span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

pot_ros <span class="token operator">=</span> rx<span class="token punctuation">.</span><span class="token function">combine_latest</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> td<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span> ops<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>lambda values<span class="token operator">:</span> <span class="token function">get_date</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token function">get_date</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ops<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>create_pot_data<span class="token punctuation">)</span><span class="token punctuation">,</span> ops<span class="token punctuation">.</span><span class="token function">subscribe_on</span><span class="token punctuation">(</span>thread_pool_scheduler<span class="token punctuation">)</span><span class="token punctuation">)</span>
rx<span class="token punctuation">.</span><span class="token function">combine_latest</span><span class="token punctuation">(</span>pot_ros<span class="token punctuation">,</span> radar<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>process_ros<span class="token punctuation">,</span> scheduler<span class="token operator">=</span>thread_pool_scheduler<span class="token punctuation">)</span>
</code></pre></p>
<h1 id="links">Links</h1>
<ul>
<li><a href="https://github.com/rveciana/rxpyexample">Post code on GitHub</a></li>
<li><a href="http://reactivex.io/">ReactiveX</a></li>
<li><a href="https://github.com/meteocat/pypros">PyPROS, precipitation type calculation: rain or snow</a></li>
<li><a href="https://www.meteo.cat/observacions/plujaONeu">Rain or snow operative output</a></li>
<li><a href="https://python-watchdog.readthedocs.io/en/stable/">Watchdog library</a></li>
<li><a href="https://rxmarbles.com/">Rx Marbles site</a></li>
<li><a href="https://rxmarbles.com/#combineLatest"><em>combine_latest</em> diagram</a></li>
<li><a href="https://stackoverflow.com/questions/43989153/how-to-wait-for-rxpy-parallel-threads-to-complete">RxPY parallel threads</a></li>
<li><a href="https://rxpy.readthedocs.io/en/latest/get_started.html"><em>from_future</em> example</a></li>
</ul>
<!-- HTML_TAG_END --></article></div></div></main>
<footer class="site-footer"><div class="wrapper"><div class="footer-col-wrapper"><div class="footer-col  footer-col-1"><ul class="contact-list"><li>GeoExamples - Roger Veciana</li></ul></div>

	<div class="footer-col  footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/rveciana"><span class="icon  icon--github"><svg viewBox="0 0 16 16"><path fill="#89b889" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"></path></svg></span>

						<span class="username">rveciana</span></a></li>

			<li><a href="https://twitter.com/rveciana"><span class="icon  icon--twitter"><svg viewBox="0 0 16 16"><path fill="#89b889" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                    c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"></path></svg></span>

						<span class="username">rveciana</span></a></li>
			<li><a href="https://www.linkedin.com/in/rogerveciana"><span class="icon  icon--twitter"><svg width="16" height="15.28958"><path d="M 0,1.77606 Q 0,1.00386 0.54054,0.50193 1.08108,0 1.94595,0 2.79537,0 3.32047,0.49421 3.86101,1.00386 3.86101,1.8224 q 0,0.74131 -0.5251,1.23552 -0.54054,0.50965 -1.42085,0.50965 l -0.0154,0 q -0.84942,0 -1.37452,-0.50965 Q 4e-5,2.54827 4e-5,1.77606 Z m 0.20078,13.51352 0,-10.3166 3.42857,0 0,10.3166 -3.42857,0 z m 5.32818,0 3.42857,0 0,-5.76062 q 0,-0.54054 0.12355,-0.83398 0.21622,-0.52509 0.65638,-0.88803 0.44015,-0.36293 1.10424,-0.36293 1.72973,0 1.72973,2.33205 l 0,5.51351 3.42857,0 0,-5.91506 Q 16,7.08881 14.91892,5.90734 13.83784,4.72587 12.06178,4.72587 q -1.99228,0 -3.10425,1.71429 l 0,0.0309 -0.0154,0 0.0154,-0.0309 0,-1.46718 -3.42857,0 q 0.0309,0.49421 0.0309,3.07336 0,2.57915 -0.0309,7.24324 z"></path></svg></span>

						<span class="username">rogerveciana</span></a></li></ul></div>

	<div class="footer-col  footer-col-3"><p class="text">I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time.</p>
		<p class="text">Roger Veciana i Rovira</p></div></div></div></footer>



	<script type="application/json" data-type="svelte-data" data-url="/summary_pages.json">{"status":200,"statusText":"","headers":{"content-type":"application/json; charset=utf-8"},"body":"[{\"title\":\"About\",\"permalink\":\"\u002Fabout\",\"excerpt\":\"\u003Cp\u003E{{ site.author.name }}\u003C\u002Fp\u003E\"},{\"title\":\"CV\",\"permalink\":\"\u002Fcv\",\"excerpt\":\"\u003Ch2 id=\\\"jobs\\\"\u003EJobs\u003C\u002Fh2\u003E\",\"avoidMainMenu\":true},{\"title\":\"Projects\",\"permalink\":\"\u002Fprojects\",\"excerpt\":\"\u003Cp\u003ESome of my personal projects:\u003C\u002Fp\u003E\"}]"}</script>

	<script type="application/json" data-type="svelte-data" data-url="dependencies-rx.html.json">{"status":200,"statusText":"","headers":{"content-type":"application/json; charset=utf-8"},"body":"{\"title\":\"Using RxPY to process GIS files dependencies\",\"contents\":\"\u003Cp\u003E\u003Ca href=\\\"http:\u002F\u002Freactivex.io\u002F\\\"\u003EReactive programming\u003C\u002Fa\u003E is amazing. Hard to understand when you first see it, it solves problems that are really difficult to code without it. It&#39;s available in many languages and very well-known by AngularJS users, because it makes an extensive use of it. \u003C\u002Fp\u003E\\n\u003Ch1 id=\\\"the-problem\\\"\u003EThe problem\u003C\u002Fh1\u003E\\n\u003Cp\u003ELet&#39;s see what&#39;s reactive programming before seeing a &quot;real&quot; use case. The easiest way to define it (for me) is comparing it to an Excel file:\\n\u003Cimg src=\\\"\u002Fimages\u002Fpython\u002Frxpy\u002Fspreadsheet.png\\\" \u002F\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EThe first two columns are independent values\u003C\u002Fli\u003E\\n\u003Cli\u003EColumns C and D depend on A and B\u003C\u002Fli\u003E\\n\u003Cli\u003EColumn E depends on column D\u003C\u002Fli\u003E\\n\u003Cli\u003ENote that some columns are \u003Cem\u003Esubscribed\u003C\u002Fem\u003E to other columns and that all any column can be \u003Cem\u003Esubscribed\u003C\u002Fem\u003E by others. \u003C\u002Fli\u003E\\n\u003Cli\u003EValues in E depend on D, which depends on A and B, but E doesn&#39;t know or better, doesn&#39;t care about this. \u003Cul\u003E\\n\u003Cli\u003EYou can change the formula for D and E will still work.\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003ELet&#39;s imagine a GIS example now. \u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Fmeteocat\u002Fpypros\\\"\u003Epypros\u003C\u002Fa\u003E is a software I contributed in some time ago when working at the Catalan Meteorological Service. \u003C\u002Fp\u003E\\n\u003Cp\u003EBasically, it takes the temperature field, the relative humidity (or dew point temperature), the radar signal and outputs a file where each pixel has a value depending on the type of precipitation. You can \u003Ca href=\\\"https:\u002F\u002Fwww.meteo.cat\u002Fobservacions\u002FplujaONeu\\\"\u003Esee it in action here\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\\n\u003Cimg src=\\\"\u002Fimages\u002Fpython\u002Frxpy\u002Fflow.png\\\" \u002F\u003E\\n\\n\u003Cul\u003E\\n\u003Cli\u003EWith temperature and the Dew point, we get what would happen if there was precipitation in a given point\u003C\u002Fli\u003E\\n\u003Cli\u003EWith the previous result and the radar image, we can get the final product\u003C\u002Fli\u003E\\n\u003Cli\u003EThe main problem to code this is that the frequencies aren&#39;t equal for all the fields, so coding it directly means remembering the latest processed images and so on\u003C\u002Fli\u003E\\n\u003Cli\u003EComplicating the diagram is easy with reactive programming because each step will be watching only the interesting observables\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Ch1 id=\\\"the-code\\\"\u003EThe code\u003C\u002Fh1\u003E\\n\u003Cp\u003EAs usual, you can \u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Frveciana\u002Frxpyexample\\\"\u003Eget the code at GitHub\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\\n\u003Cp\u003ESo the first thing to do is act when some file appears. The file could be a temperature, dew point or radar file. To do it, we&#39;ll use the \u003Ca href=\\\"https:\u002F\u002Fpython-watchdog.readthedocs.io\u002Fen\u002Fstable\u002F\\\"\u003E\u003Cem\u003Ewatchdog\u003C\u002Fem\u003E library\u003C\u002Fa\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E time\\nfrom watchdog\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eevents \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E FileSystemEventHandler\\nfrom watchdog\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eobservers \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Observer\\nfrom observables \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E source\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Eclass\u003C\u002Fspan\u003E \u003Cspan class=\\\"token class-name\\\"\u003EMyHandler\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EFileSystemEventHandler\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\\n    def \u003Cspan class=\\\"token function\\\"\u003Enext_source\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eself\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E path\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\\n        source\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eon_next\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Epath\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n    def \u003Cspan class=\\\"token function\\\"\u003Eon_created\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eself\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E event\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\\n        self\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Enext_source\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eevent\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Esrc_path\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n    def \u003Cspan class=\\\"token function\\\"\u003Eon_modified\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eself\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E event\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\\n        self\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Enext_source\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eevent\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Esrc_path\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E __name__ \u003Cspan class=\\\"token operator\\\"\u003E==\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E\\\"__main__\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\\n    path \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'.\u002Fdata'\u003C\u002Fspan\u003E\\n    event_handler \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EMyHandler\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n    observer \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EObserver\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n    observer\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eschedule\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eevent_handler\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E path\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E recursive\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003ETrue\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n    observer\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Estart\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Etry\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token keyword\\\"\u003Ewhile\u003C\u002Fspan\u003E True\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\\n            time\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esleep\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n    finally\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\\n        observer\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Estop\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n        observer\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ejoin\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EThe \u003Cem\u003EObserver\u003C\u002Fem\u003E object will call the methods in \u003Cem\u003EMyHandler\u003C\u002Fem\u003E when some change occurs in the path\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Cem\u003Esource\u003C\u002Fem\u003E is the RxPY thing that we&#39;ll see next. When something changes, the \u003Cem\u003Eon_next\u003C\u002Fem\u003E method is called with the path for the file that changed\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003ELet&#39;s see now a first version of the \u003Cem\u003ERxPY\u003C\u002Fem\u003E part\\n\u003Cpre\u003E\u003Ccode\u003E\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E time\\nfrom os\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Epath \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E basename\\nfrom pathlib \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Path\\n\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E rx\\nfrom rx \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E operators \u003Cspan class=\\\"token keyword\\\"\u003Eas\u003C\u002Fspan\u003E ops\\nfrom rx\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Esubject \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Subject\\n\\ndef \u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E x\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esplit\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"-\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ereplace\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\".tiff\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\\ndef \u003Cspan class=\\\"token function\\\"\u003Eprocess_potential_ros\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token function\\\"\u003Eprint\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"CREATING POTENTIAL ROS\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'.\u002Fdata\u002Fpot_pon_'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"-\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\".tiff\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n    time\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esleep\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token function\\\"\u003EPath\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'.\u002Fdata\u002Fpot_ros_'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"-\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\".tiff\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Etouch\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\\ndef \u003Cspan class=\\\"token function\\\"\u003Eprocess_ros\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token function\\\"\u003Eprint\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"CREATING ROS FILE\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token string\\\"\u003E'.\u002Fdata\u002Fpon_'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"-\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\".tiff\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n    time\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esleep\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token function\\\"\u003EPath\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'.\u002Fdata\u002Fros_'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"-\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\".tiff\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Etouch\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\\nsource \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003ESubject\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\\ntd \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E source\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Epipe\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eops\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efilter\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Elambda text\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E text\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efind\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'td'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\ntemp \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E source\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Epipe\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eops\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efilter\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Elambda text\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E text\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efind\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'temp'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\nradar \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E source\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Epipe\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eops\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efilter\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Elambda text\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E text\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efind\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'radar'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\npot_ros \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E source\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Epipe\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eops\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efilter\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Elambda text\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E text\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efind\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'pot_ros'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\\nrx\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ecombine_latest\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Etemp\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E td\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esubscribe\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eprocess_potential_ros\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\nrx\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ecombine_latest\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Epot_ros\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E radar\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esubscribe\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eprocess_ros\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EThe first functions are just mock functions that simulate the creation of the actual files. That&#39;s why the \u003Cem\u003Etime.sleep()\u003C\u002Fem\u003E is there\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Cem\u003Esource\u003C\u002Fem\u003E is a \u003Cem\u003ESubject\u003C\u002Fem\u003E, that can recieve the \u003Cem\u003Eon_next\u003C\u002Fem\u003E method and be subscribed. Basically, whan any file changes, the \u003Cem\u003Esource\u003C\u002Fem\u003E will emit its path\u003C\u002Fli\u003E\\n\u003Cli\u003EThe next lines are \u003Cem\u003Eobservables\u003C\u002Fem\u003E subscribed to source. They filter the path so they will only emit when the string appears in the path. To when a temperature file appears, the path is emitted by \u003Cem\u003Etemp\u003C\u002Fem\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003EFinally, \u003Cem\u003Ecombine_latest\u003C\u002Fem\u003E takes two observables and emits an event with the latest values for each one. You can \u003Ca href=\\\"https:\u002F\u002Frxmarbles.com\u002F#combineLatest\\\"\u003Echeck the diagram here\u003C\u002Fa\u003E\u003Cul\u003E\\n\u003Cli\u003EThe first one creates the \u003Cem\u003Epotential RoS\u003C\u002Fem\u003E file that will trigger the \u003Cem\u003Esource\u003C\u002Fem\u003E again, because it creates a file\u003C\u002Fli\u003E\\n\u003Cli\u003EThe second one takes the previpusly created file and the radar to create the final image\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003EThe output is something similar to:\\n\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EPOTENTIAL\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epot_pon_202101010000\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010000.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EFILE\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epon_202101010000\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010000.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EFILE\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epon_202101010000\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010006.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EFILE\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epon_202101010000\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010012.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EFILE\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epon_202101010000\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010018.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EFILE\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epon_202101010000\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010024.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EFILE\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epon_202101010000\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010030.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EFILE\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epon_202101010000\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010036.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EFILE\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epon_202101010000\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010042.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EFILE\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epon_202101010000\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010048.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EFILE\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epon_202101010000\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010054.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EFILE\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epon_202101010000\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010100.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EPOTENTIAL\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epot_pon_202101010100\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010000.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EPOTENTIAL\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epot_pon_202101010100\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010100.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EFILE\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epon_202101010000\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010106.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EFILE\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epon_202101010000\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010106.\u003C\u002Fspan\u003Etiff\\n\u003Cspan class=\\\"token constant\\\"\u003ECREATING\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EROS\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EFILE\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edata\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epon_202101010100\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E202101010106.\u003C\u002Fspan\u003Etiff \\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003ETo do it, I created a file that generates radar and temperature and td files like this:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003Efrom pathlib \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Path\\n\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E time\\n\\n\u003Cspan class=\\\"token function\\\"\u003EPath\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'.\u002Fdata\u002Ftemp-202101010000.tiff'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Etouch\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\ntime\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esleep\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token function\\\"\u003EPath\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'.\u002Fdata\u002Fradar-202101010000.tiff'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Etouch\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\ntime\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esleep\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token function\\\"\u003EPath\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'.\u002Fdata\u002Ftd-202101010000.tiff'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Etouch\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\ntime\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esleep\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token function\\\"\u003EPath\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'.\u002Fdata\u002Fradar-202101010006.tiff'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Etouch\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E...\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Ch1 id=\\\"improving-the-code-by-using-more-rxpy\\\"\u003EImproving the code by using more RxPY\u003C\u002Fh1\u003E\\n\u003Cp\u003EThe previous code has three problems (at least)\u003C\u002Fp\u003E\\n\u003Col\u003E\\n\u003Cli\u003EThe \u003Cem\u003EPotential Rain Or Snow\u003C\u002Fem\u003E is saved in a file. This is not wring but it&#39;s an intermediate step and maybe we don&#39;t want to save it\u003C\u002Fli\u003E\\n\u003Cli\u003EThere are two \u003Cem\u003EPotential Rain Or Snow\u003C\u002Fem\u003E created at the end. This is because \u003Cem\u003Ecombine_latest\u003C\u002Fem\u003E will emit twice when eiter Td or Temperature appear. Usually, we only want this to be created if the dates for both files are identical (they should appear more or less at the same time)\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Cem\u003Etime.sleep()\u003C\u002Fem\u003E will block the process. If the file generation lasts a lot, some events will have to wait. It would be much nicer if this calculation happens in another process and when is finished, emits the event (or saves the file)\u003C\u002Fli\u003E\\n\u003C\u002Fol\u003E\\n\u003Cp\u003ETo solve the first point, we&#39;ll use \u003Cem\u003Emap\u003C\u002Fem\u003E, that converts the input value to another thing, as in functional programming:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003Epot_ros \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E rx\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ecombine_latest\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Etemp\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E td\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Epipe\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eops\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Emap\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ecreate_pot_data\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EThen, when subscribing to the \u003Cem\u003Epot_ros observable\u003C\u002Fem\u003E we could receive the calculated field (calculated in \u003Cem\u003Ecreate_pot_data\u003C\u002Fem\u003E) without having to save\u003C\u002Fp\u003E\\n\u003Cp\u003ETo avoid \u003Cem\u003Ecreate_pot_data\u003C\u002Fem\u003E to be run twice when \u003Cem\u003Etd\u003C\u002Fem\u003E and \u003Cem\u003Etemperature\u003C\u002Fem\u003E are different, a filter can be used:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003Epot_ros \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E rx\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ecombine_latest\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Etemp\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E td\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Epipe\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eops\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efilter\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Elambda values\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Evalues\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E==\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Evalues\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E ops\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Emap\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ecreate_pot_data\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EThis way, only the elements that match the filter function will pass to the map.\u003C\u002Fp\u003E\\n\u003Cp\u003EFinally, to solve the process blocking, we can add a \u003Cem\u003Eops.subscribe_on(thread_pool_scheduler)\u003C\u002Fem\u003E. This will make each subscription to run in a different process. I added a long sleep time to the file creation to show that in the same pipe, everything i in the same process. Probably this can be avoided with\u003Ca href=\\\"https:\u002F\u002Frxpy.readthedocs.io\u002Fen\u002Flatest\u002Fget_started.html\\\"\u003E\u003Cem\u003Eflat_map\u003C\u002Fem\u003E and \u003Cem\u003Efrom_future\u003C\u002Fem\u003E\u003C\u002Fa\u003E, but I&#39;m not sure that it&#39;s a nice feature in a real case.\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E multiprocessing\\n\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E time\\nfrom os\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Epath \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E basename\\nfrom pathlib \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Path\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E rx\\nfrom rx \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E operators \u003Cspan class=\\\"token keyword\\\"\u003Eas\u003C\u002Fspan\u003E ops\\nfrom rx\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ecore\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Etyping \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Observable\\nfrom rx\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Escheduler \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E ThreadPoolScheduler\\nfrom rx\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Esubject \u003Cspan class=\\\"token keyword\\\"\u003Eimport\u003C\u002Fspan\u003E Subject\\n\\nthread_count \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E multiprocessing\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ecpu_count\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\nthread_pool_scheduler \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003EThreadPoolScheduler\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ethread_count\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token function\\\"\u003Eprint\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"Cpu count is : {0}\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eformat\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ethread_count\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\\ndef \u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E x\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esplit\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"-\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ereplace\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\".tiff\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\\ndef \u003Cspan class=\\\"token function\\\"\u003Eprocess_ros\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\\n    fut \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E asyncio\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ecreate_task\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efoo\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n    def \u003Cspan class=\\\"token function\\\"\u003Ewhen_finished\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Eem\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003Efut\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token function\\\"\u003Eprint\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"CREATING ROS FILE\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E x\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n        time\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esleep\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E10\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token function\\\"\u003EPath\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'.\u002Fdata\u002Fros&lt;\u002Fem\u003E'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"-\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\".tiff\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Etouch\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n    fut\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eadd_done_callback\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ewhen_finished\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\\ndef \u003Cspan class=\\\"token function\\\"\u003Ecreate_pot_data\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token function\\\"\u003Eprint\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"CREATING POT ROS DATA\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E x\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n    time\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esleep\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\\nsource \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003ESubject\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\\ntd \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E source\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Epipe\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eops\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efilter\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Elambda text\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E text\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efind\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'td'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E ops\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esubscribe_on\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ethread_pool_scheduler\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\ntemp \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E source\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Epipe\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eops\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efilter\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Elambda text\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E text\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efind\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'temp'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E ops\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esubscribe_on\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ethread_pool_scheduler\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\nradar \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E source\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Epipe\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eops\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efilter\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Elambda text\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E text\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efind\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E'radar'\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\\npot_ros \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E rx\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ecombine_latest\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Etemp\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E td\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Epipe\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E ops\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Efilter\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Elambda values\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Evalues\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E==\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eget_date\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Evalues\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E ops\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Emap\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ecreate_pot_data\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E ops\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esubscribe_on\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ethread_pool_scheduler\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\nrx\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ecombine_latest\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Epot_ros\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E radar\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esubscribe\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eprocess_ros\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E scheduler\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003Ethread_pool_scheduler\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Ch1 id=\\\"links\\\"\u003ELinks\u003C\u002Fh1\u003E\\n\u003Cul\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Frveciana\u002Frxpyexample\\\"\u003EPost code on GitHub\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"http:\u002F\u002Freactivex.io\u002F\\\"\u003EReactiveX\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Fmeteocat\u002Fpypros\\\"\u003EPyPROS, precipitation type calculation: rain or snow\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fwww.meteo.cat\u002Fobservacions\u002FplujaONeu\\\"\u003ERain or snow operative output\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fpython-watchdog.readthedocs.io\u002Fen\u002Fstable\u002F\\\"\u003EWatchdog library\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Frxmarbles.com\u002F\\\"\u003ERx Marbles site\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Frxmarbles.com\u002F#combineLatest\\\"\u003E\u003Cem\u003Ecombine_latest\u003C\u002Fem\u003E diagram\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fstackoverflow.com\u002Fquestions\u002F43989153\u002Fhow-to-wait-for-rxpy-parallel-threads-to-complete\\\"\u003ERxPY parallel threads\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Frxpy.readthedocs.io\u002Fen\u002Flatest\u002Fget_started.html\\\"\u003E\u003Cem\u003Efrom_future\u003C\u002Fem\u003E example\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\",\"tags\":[\"RxPy\"],\"date\":\"2021-10-12T00:00:00.000Z\",\"thumbnail\":\"\u002Fimages\u002Fpython\u002Frxpy\u002Ftwitter.png\"}"}</script>
</div>
	</body>
</html>
