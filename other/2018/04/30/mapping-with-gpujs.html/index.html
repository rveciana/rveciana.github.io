<!DOCTYPE html>
<html lang="en">
	<head>
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-36383259-2"></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());
		
		  gtag('config', 'UA-36383259-2');
		</script>
		
		<meta charset="utf-8" />
		<link rel="icon" href="/favicon.ico" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="manifest" href="/manifest.json" />
		<meta name="theme-color" content="#cdffcd">
		<!-- HTML Meta Tags -->
		<title>GeoExamples - Roger Veciana</title>
		<meta
			name="description"
			content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time."
		/>
		<!-- Google / Search Engine Tags -->
		<meta itemprop="name" content=">GeoExamples - Roger Veciana" />
		<meta
			itemprop="description"
			content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time."
		/>
		<meta itemprop="image" content="https://geoexamples.com/siteImage.png" />
		<!-- Facebook Meta Tags -->
		<meta property="og:url" content="https://geoexamples.com" />
		<meta property="og:type" content="website" />
		<meta property="og:title" content="GeoExamples - Roger Veciana" />
		<meta
			property="og:description"
			content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time."
		/>
		<meta property="og:image" content="https://geoexamples.com/siteImage.png" />
		<!-- Twitter Meta Tags -->
		<meta name="twitter:card" content="summary" />
		<meta name="twitter:title" content="GeoExamples - Roger Veciana" />
		<meta name="twitter:description"
		  content="I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time." />
		<meta name="twitter:image" content="https://geoexamples.com/siteImage.png" />
		



<link rel="modulepreload" href="/./staticApp/start-44631b0b.js">
			<link rel="modulepreload" href="/./staticApp/chunks/vendor-ff3d1764.js">
			<link rel="modulepreload" href="/./staticApp/chunks/config-b3bde751.js">
			<link rel="modulepreload" href="/./staticApp/pages\[category]\[year]\[month]\[date]\[slug].svelte-a77716b3.js">
			<link rel="stylesheet" href="/./staticApp/assets/start-34a290f9.css">


		<script type="module">
			import { start } from "/./staticApp/start-44631b0b.js";
			start({
				target: document.querySelector("#svelte"),
				paths: {"base":"","assets":"/."},
				session: {},
				host: location.host,
				route: true,
				hydrate: {
					status: 200,
					error: null,
					nodes: [
						import("/./staticApp/pages\\[category]\\[year]\\[month]\\[date]\\[slug].svelte-a77716b3.js")
					],
					page: {
						host: location.host, // TODO this is redundant
						path: "/other/2018/04/30/mapping-with-gpujs.html",
						query: new URLSearchParams(""),
						params: {"category":"other","year":"2018","month":"04","date":"30","slug":"mapping-with-gpujs.html"}
					}
				}
			});
		</script>
	</head>
	<body>
		<div id="svelte">


<header class="site-header"><div class="wrapper"><a class="site-title" href="/">GeoExamples - Roger Veciana</a>

<nav class="site-nav"><div href="#" class="menu-icon"><svg viewBox="0 0 18 15"><path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"></path><path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"></path><path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"></path></svg></div>

	<div class="trigger"><a class="page-link" href="/about">About</a><a class="page-link" href="/blog">Blog</a><a class="page-link" href="/projects">Projects</a></div></nav></div></header>

<main class="page-content"><div class="wrapper"><div class="post"><header class="post-header"><h1 class="post-title">Mapping with gpu.js</h1>
<p class="post-meta">Apr 30, 2018</p></header>

	<article class="post-content"><p><a href="http://gpu.rocks">gpu.js</a> is a JavaScript Acceleration library for <a href="https://en.wikipedia.org/wiki/General-purpose_computing_on_graphics_processing_units">GPGPU (General purpose computing on GPUs)</a> in Javascript. This means, basically, using the GPU instead of the CPU for the calculations, and coding in simple JavaScript.</p>
<p>The library is awesome, but I found some issues trying to run my things, so I will try to put all my steps here, which will help me in first place.</p>
<h2 id="including-the-library">Including the library</h2>
<p>From a regular web page, just include:</p>
<p><pre><code>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"/path/to/js/gpu.min.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>


</code></pre></p>
<p>then, initialize the library calling</p>
<p><pre><code>
<span class="token keyword">const</span> gpu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GPU</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></p>
<p>It&#39;s possible to pass to the GPU constructor the options:</p>
<pre><code>{mode: &#39;gpu&#39;} or {mode: &#39;cpu&#39;}</code></pre><p>Setting it forces the use of the CPU, which can be nice for performance comparison.</p>
<p>Using node, just install it with:</p>
<pre><code>npm install gpu.js</code></pre><p>And require the module with:</p>
<pre><code>const gpujs = require(&quot;gpu.js&quot;);
const gpu = new gpujs();</code></pre><h3 id="observablehq">ObservableHQ</h3>
<p><a href="https://observablehq.com">ObservableHQ</a> is a new and awesome site to publish interactive examples. Requiring libraries is possible, but they have to be in UMD or AMD, which is not the case of <a href="http://gpu.rocks">gpu.js</a>. A working solution is using the <a href="https://wzrd.in/">wzrd</a> service</p>
<p><pre><code>
<span class="token constant">GPU</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"https://wzrd.in/standalone/gpu.js&amp;#39;"</span><span class="token operator">></span>https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>wzrd<span class="token punctuation">.</span>in<span class="token operator">/</span>standalone<span class="token operator">/</span>gpu<span class="token punctuation">.</span>js<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><span class="token punctuation">)</span>
</code></pre></p>
<h2 id="first-working-example">First working example</h2>
<p>Let&#39;s see the simplest calculation using node:</p>
<p><pre><code>
<span class="token keyword">var</span> <span class="token constant">GPU</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"gpu.js"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> gpu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GPU</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> gpuKernel <span class="token operator">=</span> gpu<span class="token punctuation">.</span><span class="token function">createKernel</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOutput</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token function">gpuKernel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></p>
<ul>
<li>After initializing the class, a kernel is created with <em>createKernel</em><ul>
<li>The function that calculates every point is passed as the parameter
This function has the <em>this.thread.x, this.thread.y and this.thread.z</em> variables that return the position in the matrix to calculate</li>
<li>In the <em>setOutput</em> method, the size of the matrix is set</li>
</ul>
</li>
<li>Just call the created kernel to calculate the values</li>
</ul>
<p>Some more things about this functions:</p>
<ul>
<li><p>They can take array arguments</p>
<p>function(points){...}</p>
</li>
</ul>
<p>and call it</p>
<p>gpuKernel([1,2,3])</p>
<ul>
<li>The size of the matrix is not accessible, unless a constant is declared</li>
</ul>
<p><pre><code>
<span class="token keyword">var</span> gpuKernel <span class="token operator">=</span> gpu<span class="token punctuation">.</span><span class="token function">createKernel</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span><span class="token keyword">this</span><span class="token punctuation">.</span>constants<span class="token punctuation">.</span>xSize<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token operator">...</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOutput</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">setConstants</span><span class="token punctuation">(</span><span class="token punctuation">{</span>xSize<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span> ySize<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></p>
<ul>
<li>The JavaScript operators that can be called inside the kernel functions are quite limited. <a href="https://github.com/gpujs/gpu.js?utm_source=recordnotfound.com#supported-math-functions">Here&#39;s the list</a>. Also, no <em>console.log</em> and many other functions can go there.</li>
</ul>
<h2 id="drawing-directly-on-a-canvas">Drawing directly on a Canvas</h2>
<p>One of the points that make <a href="http://gpu.rocks">gnu.js</a> really interesting is that the gpu function can draw directly on a Canvas element, which is what we need when mapping. Here&#39;s a simple example, to run directly on the browser:</p>
<p><pre><code>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token constant">DOCTYPE</span> html<span class="token operator">></span>
<span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token operator">></span>
<span class="token operator">&lt;</span>body<span class="token operator">></span>
    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"gpu.min.js"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
<span class="token operator">&lt;</span>script<span class="token operator">></span>
<span class="token keyword">const</span> gpu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GPU</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> render <span class="token operator">=</span> gpu<span class="token punctuation">.</span><span class="token function">createKernel</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">color</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token operator">/</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>y<span class="token operator">/</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setOutput</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setGraphical</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> canvas <span class="token operator">=</span> render<span class="token punctuation">.</span><span class="token function">getCanvas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>body<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span>
</code></pre></p>
<ul>
<li>The method <em>setGraphical(true)</em> has to be called to make the kernel draw on a Canvas. The <em>setOutput</em> method will set now the Canvas size</li>
<li>Later, get the Canvas with <em>getCanvas()</em></li>
<li>Inside the function, set the <em>this.color</em> field with four values (rgba) from 0 to 1</li>
<li>The y axis goes bottom to top! This is the opposite of the usual notation</li>
</ul>
<p>It&#39;s easy! The result looks like this:</p>
<img src="/images/other/gpujs-mapping/result1.png"/>

<h2 id="some-algorithms">Some algorithms</h2>
<h3 id="inverse-of-the-distance">Inverse of the distance</h3>
<p>In <a href="http://geoexamples.blogspot.com.es/2012/05/creating-grid-from-scattered-data-using.html">one of the first posts of this blog</a> I made a python script for drawing a grid from a set of scattered points. Using gpu.js this can be done at real-time and see the results when changing the parameters, as in <a href="https://beta.observablehq.com/@rveciana/most-basic-gpu-js-example">this ObservableHQ notebook</a></p>
<p>The function to calculate the values is:
<pre><code>
<span class="token function-variable function">invDist</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">xpos<span class="token punctuation">,</span> ypos<span class="token punctuation">,</span> values<span class="token punctuation">,</span> smoothing<span class="token punctuation">,</span> colorScale</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">var</span> nominator<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> denominator<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> flagDist <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>constants<span class="token punctuation">.</span>numPoints<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">var</span> dist <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token operator">-</span>xpos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&lt;</span>em<span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token operator">-</span>xpos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>
<span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>y<span class="token operator">-</span>ypos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>em<span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>y<span class="token operator">-</span>ypos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> smoothing<span class="token operator">*</span>smoothing<span class="token punctuation">)</span><span class="token punctuation">;</span>
nominator<span class="token operator">=</span>nominator<span class="token operator">+</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/</span>dist<span class="token punctuation">)</span>
denominator<span class="token operator">=</span>denominator<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>dist<span class="token punctuation">)</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>dist <span class="token operator">&lt;</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
flagDist <span class="token operator">=</span> i<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span>pre<span class="token operator">></span><span class="token operator">&lt;</span>code<span class="token operator">></span><span class="token punctuation">}</span>
<span class="token keyword">var</span> value<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>flagDist <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    value <span class="token operator">=</span> values<span class="token punctuation">[</span>flagDist<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    value <span class="token operator">=</span> nominator<span class="token operator">/</span>denominator<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> c <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span><span class="token number">255</span> <span class="token operator">*</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">color</span><span class="token punctuation">(</span>colorScale<span class="token punctuation">[</span>c<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">,</span> colorScale<span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">+</span> c<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">,</span> colorScale<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">+</span> c<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>code<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">></span>
<span class="token punctuation">}</span>
</code></pre></p>
<ul>
<li>We only iterate the points, but not hte pixels, referenced by <em>this.thread.x</em> and <em>this.thread.y</em>, that will be done in parallel</li>
</ul>
<h3 id="hillshade">Hillshade</h3>
<p>The hillshade algorithm depends on the current pixel and the one around it, so it&#39;s possible <a href="https://beta.observablehq.com/@rveciana/shaded-relief-with-gpujs-and-d3js">to use gpu.js easily</a>:</p>
<p><pre><code>
<span class="token keyword">function</span> <span class="token function">hillshade</span><span class="token punctuation">(</span><span class="token parameter">demData</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">let</span> azimuthrad <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>constants<span class="token punctuation">.</span>azimuth _ <span class="token number">0.017453292519943295</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> altituderad <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>constants<span class="token punctuation">.</span>angleAltitude _ <span class="token number">0.017453292519943295</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> gradX<span class="token punctuation">,</span> gradY<span class="token punctuation">;</span>

<span class="token keyword">let</span> yPos <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>constants<span class="token punctuation">.</span>ySize <span class="token operator">-</span> <span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>y<span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> gradX <span class="token operator">=</span> demData<span class="token punctuation">[</span>yPos<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> demData<span class="token punctuation">[</span>yPos<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token operator">==</span><span class="token keyword">this</span><span class="token punctuation">.</span>constants<span class="token punctuation">.</span>xSize<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> gradX <span class="token operator">=</span> demData<span class="token punctuation">[</span>yPos<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token punctuation">]</span> <span class="token operator">-</span> demData<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">else</span> gradX <span class="token operator">=</span> <span class="token punctuation">(</span>demData<span class="token punctuation">[</span>yPos<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> demData<span class="token punctuation">[</span>yPos<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span>demData<span class="token punctuation">[</span>yPos<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token punctuation">]</span> <span class="token operator">-</span> demData<span class="token punctuation">[</span>yPos<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span>yPos<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span> gradY <span class="token operator">=</span> demData<span class="token punctuation">[</span>yPos<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token punctuation">]</span> <span class="token operator">-</span> demData<span class="token punctuation">[</span>yPos<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>yPos<span class="token operator">==</span><span class="token keyword">this</span><span class="token punctuation">.</span>constants<span class="token punctuation">.</span>ySize<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> gradY <span class="token operator">=</span> demData<span class="token punctuation">[</span>yPos<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token punctuation">]</span> <span class="token operator">-</span> demData<span class="token punctuation">[</span>yPos<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">else</span> gradY <span class="token operator">=</span> <span class="token punctuation">(</span>demData<span class="token punctuation">[</span>yPos<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token punctuation">]</span> <span class="token operator">-</span> demData<span class="token punctuation">[</span>yPos<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token punctuation">(</span>demData<span class="token punctuation">[</span>yPos<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token punctuation">]</span> <span class="token operator">-</span> demData<span class="token punctuation">[</span>yPos<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> slope <span class="token operator">=</span> <span class="token number">3.141593</span><span class="token operator">/</span><span class="token number">2</span> <span class="token operator">-</span> Math<span class="token punctuation">.</span><span class="token function">atan</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span>gradX<span class="token operator">&lt;</span>em<span class="token operator">></span>gradX <span class="token operator">+</span> gradY<span class="token operator">&lt;</span><span class="token operator">/</span>em<span class="token operator">></span>gradY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> aspect <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">atan</span><span class="token punctuation">(</span><span class="token operator">-</span>gradY<span class="token punctuation">,</span> gradX<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//should be atan2, but not working!</span>

<span class="token keyword">let</span> hs<span class="token operator">&lt;</span>em<span class="token operator">></span>value <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>altituderad<span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">sin</span><span class="token punctuation">(</span>slope<span class="token punctuation">)</span> <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>altituderad<span class="token punctuation">)</span> _ Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>slope<span class="token punctuation">)</span> \<span class="token operator">&lt;</span><span class="token operator">/</span>em<span class="token operator">></span> Math<span class="token punctuation">.</span><span class="token function">cos</span><span class="token punctuation">(</span>azimuthrad <span class="token operator">-</span> aspect<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">color</span><span class="token punctuation">(</span>hs_value<span class="token punctuation">,</span> hs_value<span class="token punctuation">,</span> hs_value<span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></p>
<ul>
<li>If you compare it with the <a href="https://beta.observablehq.com/@rveciana/shaded-relief">original hillshade example</a>, the main difference is that no <em>for loops</em> have to be used to calculate all the pixel values. Instead, the <em>this.thread.x</em> and <em>this.thread.y</em> variables are used, and all the points will be done at once.</li>
<li>Note that <em>Math.atan</em> is used instead of <em>Math.atan2</em>. This is because the <em>GSLS</em> functions have to be used instead of the ones in JavaScript. All the available functions are <a href="http://www.shaderific.com/glsl-functions/">referenced in their docs</a></li>
</ul>
<h2 id="using-it-with-leaflet">Using it with Leaflet</h2>
<p>Until now, the examples don&#39;t show an easy way to put a map on the result. A nice option is using Leaflet. Since gpu.js returns a canvas element and Leaflet has the possibility to show it, merging both is not difficult.
I&#39;m using <a href="https://gist.github.com/Sumbera/11114288">a small class called canvasOverlay</a>.</p>
<p>As you can see in <a href="https://beta.observablehq.com/@rveciana/leaflet-gpu-js-canvas">this observable</a>, the function to call from the canvasOverlay would be like:
<pre><code>
<span class="token function-variable function">drawCanvas</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">canvasOverlay<span class="token punctuation">,</span> params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

<span class="token keyword">let</span> canvas <span class="token operator">=</span> params<span class="token punctuation">.</span>canvas<span class="token punctuation">;</span>
<span class="token keyword">let</span> context <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token number">2</span>d<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
context<span class="token punctuation">.</span>globalAlpha <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> gl <span class="token operator">=</span> params<span class="token punctuation">.</span>canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span>webgl2<span class="token operator">&amp;</span>#<span class="token number">39</span><span class="token punctuation">;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>premultipliedAlpha<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> gpu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GPU</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
canvas<span class="token punctuation">,</span>
webGl<span class="token operator">:</span> gl
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> krender <span class="token operator">=</span> gpu<span class="token punctuation">.</span><span class="token function">createKernel</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">xpos<span class="token punctuation">,</span> ypos<span class="token punctuation">,</span> values<span class="token punctuation">,</span> colorScale</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">&lt;</span>pre<span class="token operator">></span><span class="token operator">&lt;</span>code<span class="token operator">></span><span class="token keyword">var</span> nominator<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> denominator<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> flagDist <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>constants<span class="token punctuation">.</span>numPoints<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">var</span> dist <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token operator">-</span>xpos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>x<span class="token operator">-</span>xpos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span>
        <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>y<span class="token operator">-</span>ypos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>thread<span class="token punctuation">.</span>y<span class="token operator">-</span>ypos<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        nominator<span class="token operator">=</span>nominator<span class="token operator">+</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">/</span>dist<span class="token punctuation">)</span>
        denominator<span class="token operator">=</span>denominator<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">/</span>dist<span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>dist <span class="token operator">&lt;</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            flagDist <span class="token operator">=</span> i<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
<span class="token keyword">var</span> value<span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>flagDist <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    value <span class="token operator">=</span> values<span class="token punctuation">[</span>flagDist<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    value <span class="token operator">=</span> nominator<span class="token operator">/</span>denominator<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> c <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span><span class="token number">255</span> <span class="token operator">*</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">color</span><span class="token punctuation">(</span>colorScale<span class="token punctuation">[</span>c<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">,</span> colorScale<span class="token punctuation">[</span><span class="token number">1</span> <span class="token operator">+</span> c<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">,</span> colorScale<span class="token punctuation">[</span><span class="token number">2</span> <span class="token operator">+</span> c<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">/</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token operator">&lt;</span><span class="token operator">/</span>code<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>pre<span class="token operator">></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">setConstants</span><span class="token punctuation">(</span><span class="token punctuation">{</span> numPoints<span class="token operator">:</span> points<span class="token punctuation">.</span>length <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">setDebug</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">setOutput</span><span class="token punctuation">(</span><span class="token punctuation">[</span>canvas<span class="token punctuation">.</span>width<span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>height<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">setGraphical</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> xPos <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> yPos <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

points<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">d</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
values<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> coords <span class="token operator">=</span> canvasOverlay<span class="token punctuation">.</span>_map<span class="token punctuation">.</span><span class="token function">latLngToContainerPoint</span><span class="token punctuation">(</span>
<span class="token constant">L</span><span class="token punctuation">.</span><span class="token function">latLng</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span>lat<span class="token punctuation">,</span> d<span class="token punctuation">.</span>lon<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
xPos<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>coords<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
yPos<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>coords<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">krender</span><span class="token punctuation">(</span>xPos<span class="token punctuation">,</span> yPos<span class="token punctuation">,</span> values<span class="token punctuation">,</span> csImageData<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> result <span class="token operator">=</span> krender<span class="token punctuation">.</span><span class="token function">getCanvas</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
context<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>result<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></p>
<ul>
<li>Get the gpujs canvas with <em>getCanvas()</em></li>
<li>Draw in in the leaflet canvas with <em>context.drawImage(result, 0, 0)</em></li>
</ul>
<h2 id="links">Links</h2>
<ul>
<li><a href="http://gpu.rocks">The gpu.js web site</a></li>
<li><a href="https://en.wikipedia.org/wiki/General-purpose_computing_on_graphics_processing_units">GPGPU Wikipedia page</a></li>
<li><a href="https://observablehq.com">ObservableHQ</a></li>
<li><a href="https://wzrd.in/">wzrd.in</a></li>
<li><a href="https://hackernoon.com/introducing-gpu-js-gpu-accelerated-javascript-ba11a6069327">generateMatrices source</a></li>
<li><a href="https://github.com/gpujs/gpu.js?utm_source=recordnotfound.com#supported-math-functions">List of gpu.js supported math functions</a></li>
<li><a href="http://geoexamples.blogspot.com.es/2012/05/creating-grid-from-scattered-data-using.html">Creating a grid from scattered data using inverse of the distance with python (gdal_grid approach)</a></li>
<li><a href="https://gist.github.com/Sumbera/11114288">canvasOverlay</a></li>
<li><a href="http://www.shaderific.com/glsl-functions/">GSLS functions reference</a></li>
</ul>
<h3 id="observablehq-notebooks">ObservableHQ notebooks</h3>
<ul>
<li><a href="https://beta.observablehq.com/@rveciana/most-basic-gpu-js-example">Most basic gpu.js example</a></li>
<li><a href="https://beta.observablehq.com/@rveciana/gpu-js-check-execution-time">Most basic gpu.js example with performance test</a></li>
<li><a href="https://beta.observablehq.com/@rveciana/basic-gpu-js-canvas-example">Basic gpu.js canvas example</a></li>
<li><a href="https://beta.observablehq.com/@rveciana/inverse-of-the-distance-with-gpu-js">Inverse of the distance with gpu.js</a></li>
<li><a href="https://beta.observablehq.com/@rveciana/shaded-relief-with-gpujs-and-d3js">Shaded relief with gpu.js and d3.js</a></li>
<li><a href="https://beta.observablehq.com/@rveciana/shaded-relief-with-gpujs-and-d3js/2">Shaded relief with gpu.js drawing the canvas directly</a></li>
<li><a href="https://beta.observablehq.com/@rveciana/shaded-relief">Shaded relief without gpu.js</a></li>
<li><a href="https://beta.observablehq.com/@rveciana/leaflet-gpu-js-canvas">Leaflet + inverse of the distance</a></li>
</ul>
<h3 id="blocks-with-some-of-the-examples">Blocks with some of the examples</h3>
<ul>
<li><a href="https://bl.ocks.org/rveciana/c664dffd8b94f0598543958433d415f4">Basic gpu.js canvas example</a></li>
<li><a href="https://bl.ocks.org/rveciana/7419081f8931227769bae5255579e792">Inverse of the distance with gpu.js</a></li>
</ul>
</article></div></div></main>
<footer class="site-footer"><div class="wrapper"><div class="footer-col-wrapper"><div class="footer-col  footer-col-1"><ul class="contact-list"><li>GeoExamples - Roger Veciana</li></ul></div>

	<div class="footer-col  footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/rveciana"><span class="icon  icon--github"><svg viewBox="0 0 16 16"><path fill="#89b889" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"></path></svg></span>

						<span class="username">rveciana</span></a></li>

			<li><a href="https://twitter.com/rveciana"><span class="icon  icon--twitter"><svg viewBox="0 0 16 16"><path fill="#89b889" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                    c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"></path></svg></span>

						<span class="username">rveciana</span></a></li>
			<li><a href="https://www.linkedin.com/in/rogerveciana"><span class="icon  icon--twitter"><svg width="16" height="15.28958"><path d="M 0,1.77606 Q 0,1.00386 0.54054,0.50193 1.08108,0 1.94595,0 2.79537,0 3.32047,0.49421 3.86101,1.00386 3.86101,1.8224 q 0,0.74131 -0.5251,1.23552 -0.54054,0.50965 -1.42085,0.50965 l -0.0154,0 q -0.84942,0 -1.37452,-0.50965 Q 4e-5,2.54827 4e-5,1.77606 Z m 0.20078,13.51352 0,-10.3166 3.42857,0 0,10.3166 -3.42857,0 z m 5.32818,0 3.42857,0 0,-5.76062 q 0,-0.54054 0.12355,-0.83398 0.21622,-0.52509 0.65638,-0.88803 0.44015,-0.36293 1.10424,-0.36293 1.72973,0 1.72973,2.33205 l 0,5.51351 3.42857,0 0,-5.91506 Q 16,7.08881 14.91892,5.90734 13.83784,4.72587 12.06178,4.72587 q -1.99228,0 -3.10425,1.71429 l 0,0.0309 -0.0154,0 0.0154,-0.0309 0,-1.46718 -3.42857,0 q 0.0309,0.49421 0.0309,3.07336 0,2.57915 -0.0309,7.24324 z"></path></svg></span>

						<span class="username">rogerveciana</span></a></li></ul></div>

	<div class="footer-col  footer-col-3"><p class="text">I am a software developer and meteorologist who likes mapping. I put here the things I learn on my free time.</p>
		<p class="text">Roger Veciana i Rovira</p></div></div></div></footer>



	<script type="svelte-data" url="/summary_pages.json">{"status":200,"statusText":"","headers":{"content-type":"application/json"},"body":"[{\"title\":\"About\",\"permalink\":\"\u002Fabout\",\"excerpt\":\"\u003Cp\u003E{{ site.author.name }}\u003C\u002Fp\u003E\"},{\"title\":\"Projects\",\"permalink\":\"\u002Fprojects\",\"excerpt\":\"\u003Cp\u003ESome of my personal projects:\u003C\u002Fp\u003E\"},{\"title\":\"CV\",\"permalink\":\"\u002Fcv\",\"excerpt\":\"\u003Ch2 id=\\\"jobs\\\"\u003EJobs\u003C\u002Fh2\u003E\",\"avoidMainMenu\":true}]"}</script>

	<script type="svelte-data" url="mapping-with-gpujs.html.json">{"status":200,"statusText":"","headers":{"content-type":"application/json"},"body":"{\"title\":\"Mapping with gpu.js\",\"contents\":\"\u003Cp\u003E\u003Ca href=\\\"http:\u002F\u002Fgpu.rocks\\\"\u003Egpu.js\u003C\u002Fa\u003E is a JavaScript Acceleration library for \u003Ca href=\\\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FGeneral-purpose_computing_on_graphics_processing_units\\\"\u003EGPGPU (General purpose computing on GPUs)\u003C\u002Fa\u003E in Javascript. This means, basically, using the GPU instead of the CPU for the calculations, and coding in simple JavaScript.\u003C\u002Fp\u003E\\n\u003Cp\u003EThe library is awesome, but I found some issues trying to run my things, so I will try to put all my steps here, which will help me in first place.\u003C\u002Fp\u003E\\n\u003Ch2 id=\\\"including-the-library\\\"\u003EIncluding the library\u003C\u002Fh2\u003E\\n\u003Cp\u003EFrom a regular web page, just include:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Escript src\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"\u002Fpath\u002Fto\u002Fjs\u002Fgpu.min.js\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\\n\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003Ethen, initialize the library calling\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E gpu \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"token class-name\\\"\u003EGPU\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EIt&#39;s possible to pass to the GPU constructor the options:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003E{mode: &#39;gpu&#39;} or {mode: &#39;cpu&#39;}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003ESetting it forces the use of the CPU, which can be nice for performance comparison.\u003C\u002Fp\u003E\\n\u003Cp\u003EUsing node, just install it with:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Enpm install gpu.js\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EAnd require the module with:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Econst gpujs = require(&quot;gpu.js&quot;);\\nconst gpu = new gpujs();\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\\\"observablehq\\\"\u003EObservableHQ\u003C\u002Fh3\u003E\\n\u003Cp\u003E\u003Ca href=\\\"https:\u002F\u002Fobservablehq.com\\\"\u003EObservableHQ\u003C\u002Fa\u003E is a new and awesome site to publish interactive examples. Requiring libraries is possible, but they have to be in UMD or AMD, which is not the case of \u003Ca href=\\\"http:\u002F\u002Fgpu.rocks\\\"\u003Egpu.js\u003C\u002Fa\u003E. A working solution is using the \u003Ca href=\\\"https:\u002F\u002Fwzrd.in\u002F\\\"\u003Ewzrd\u003C\u002Fa\u003E service\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token constant\\\"\u003EGPU\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ea href\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"https:\u002F\u002Fwzrd.in\u002Fstandalone\u002Fgpu.js&amp;#39;\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003Ehttps\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Ewzrd\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ein\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Estandalone\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Egpu\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ejs\u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Ea\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Ch2 id=\\\"first-working-example\\\"\u003EFirst working example\u003C\u002Fh2\u003E\\n\u003Cp\u003ELet&#39;s see the simplest calculation using node:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E \u003Cspan class=\\\"token constant\\\"\u003EGPU\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"gpu.js\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E gpu \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"token class-name\\\"\u003EGPU\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E gpuKernel \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E gpu\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EcreateKernel\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex \u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ey\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EsetOutput\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\nconsole\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Einfo\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EgpuKernel\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EAfter initializing the class, a kernel is created with \u003Cem\u003EcreateKernel\u003C\u002Fem\u003E\u003Cul\u003E\\n\u003Cli\u003EThe function that calculates every point is passed as the parameter\\nThis function has the \u003Cem\u003Ethis.thread.x, this.thread.y and this.thread.z\u003C\u002Fem\u003E variables that return the position in the matrix to calculate\u003C\u002Fli\u003E\\n\u003Cli\u003EIn the \u003Cem\u003EsetOutput\u003C\u002Fem\u003E method, the size of the matrix is set\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003C\u002Fli\u003E\\n\u003Cli\u003EJust call the created kernel to calculate the values\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003ESome more things about this functions:\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003E\u003Cp\u003EThey can take array arguments\u003C\u002Fp\u003E\\n\u003Cp\u003Efunction(points){...}\u003C\u002Fp\u003E\\n\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003Eand call it\u003C\u002Fp\u003E\\n\u003Cp\u003EgpuKernel([1,2,3])\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EThe size of the matrix is not accessible, unless a constant is declared\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E gpuKernel \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E gpu\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EcreateKernel\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Efor\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E i \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E i \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Econstants\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003ExSize\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E i\u003Cspan class=\\\"token operator\\\"\u003E++\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E...\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex \u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ey\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EsetOutput\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EsetConstants\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003ExSize\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E ySize\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EThe JavaScript operators that can be called inside the kernel functions are quite limited. \u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Fgpujs\u002Fgpu.js?utm_source=recordnotfound.com#supported-math-functions\\\"\u003EHere&#39;s the list\u003C\u002Fa\u003E. Also, no \u003Cem\u003Econsole.log\u003C\u002Fem\u003E and many other functions can go there.\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Ch2 id=\\\"drawing-directly-on-a-canvas\\\"\u003EDrawing directly on a Canvas\u003C\u002Fh2\u003E\\n\u003Cp\u003EOne of the points that make \u003Ca href=\\\"http:\u002F\u002Fgpu.rocks\\\"\u003Egnu.js\u003C\u002Fa\u003E really interesting is that the gpu function can draw directly on a Canvas element, which is what we need when mapping. Here&#39;s a simple example, to run directly on the browser:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E!\u003C\u002Fspan\u003E\u003Cspan class=\\\"token constant\\\"\u003EDOCTYPE\u003C\u002Fspan\u003E html\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Emeta charset\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"utf-8\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ebody\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Escript src\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token string\\\"\u003E\\\"gpu.min.js\\\"\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E gpu \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"token class-name\\\"\u003EGPU\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E render \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E gpu\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EcreateKernel\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n    \u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ecolor\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E500\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ey\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E500\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0.4\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EsetOutput\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E500\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E500\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n  \u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EsetGraphical\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token boolean\\\"\u003Etrue\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\\n\u003Cspan class=\\\"token function\\\"\u003Erender\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Econst\u003C\u002Fspan\u003E canvas \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E render\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EgetCanvas\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\ndocument\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EgetElementsByTagName\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003Ebody\u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EappendChild\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ecanvas\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Escript\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EThe method \u003Cem\u003EsetGraphical(true)\u003C\u002Fem\u003E has to be called to make the kernel draw on a Canvas. The \u003Cem\u003EsetOutput\u003C\u002Fem\u003E method will set now the Canvas size\u003C\u002Fli\u003E\\n\u003Cli\u003ELater, get the Canvas with \u003Cem\u003EgetCanvas()\u003C\u002Fem\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003EInside the function, set the \u003Cem\u003Ethis.color\u003C\u002Fem\u003E field with four values (rgba) from 0 to 1\u003C\u002Fli\u003E\\n\u003Cli\u003EThe y axis goes bottom to top! This is the opposite of the usual notation\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003EIt&#39;s easy! The result looks like this:\u003C\u002Fp\u003E\\n\u003Cimg src=\\\"\u002Fimages\u002Fother\u002Fgpujs-mapping\u002Fresult1.png\\\"\u002F\u003E\\n\\n\u003Ch2 id=\\\"some-algorithms\\\"\u003ESome algorithms\u003C\u002Fh2\u003E\\n\u003Ch3 id=\\\"inverse-of-the-distance\\\"\u003EInverse of the distance\u003C\u002Fh3\u003E\\n\u003Cp\u003EIn \u003Ca href=\\\"http:\u002F\u002Fgeoexamples.blogspot.com.es\u002F2012\u002F05\u002Fcreating-grid-from-scattered-data-using.html\\\"\u003Eone of the first posts of this blog\u003C\u002Fa\u003E I made a python script for drawing a grid from a set of scattered points. Using gpu.js this can be done at real-time and see the results when changing the parameters, as in \u003Ca href=\\\"https:\u002F\u002Fbeta.observablehq.com\u002F@rveciana\u002Fmost-basic-gpu-js-example\\\"\u003Ethis ObservableHQ notebook\u003C\u002Fa\u003E\u003C\u002Fp\u003E\\n\u003Cp\u003EThe function to calculate the values is:\\n\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token function-variable function\\\"\u003EinvDist\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Expos\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E ypos\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E values\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E smoothing\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E colorScale\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E nominator\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E denominator\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E flagDist \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Efor\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E i \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E i \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Econstants\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003EnumPoints\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E i\u003Cspan class=\\\"token operator\\\"\u003E++\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E dist \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E Math\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esqrt\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003Expos\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003Ei\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Eem\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003Expos\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003Ei\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ey\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003Eypos\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003Ei\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Eem\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ey\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003Eypos\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003Ei\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E smoothing\u003Cspan class=\\\"token operator\\\"\u003E*\u003C\u002Fspan\u003Esmoothing\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\nnominator\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003Enominator\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Evalues\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003Ei\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edist\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\ndenominator\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003Edenominator\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edist\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Edist \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0.1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\nflagDist \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E i\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Epre\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ecode\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E value\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EflagDist \u003Cspan class=\\\"token operator\\\"\u003E\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n    value \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E values\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EflagDist\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n    value \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E nominator\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edenominator\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E c \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E Math\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eceil\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E255\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E*\u003C\u002Fspan\u003E value\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ecolor\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EcolorScale\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003Ec\u003Cspan class=\\\"token operator\\\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E4\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E255\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E colorScale\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E c\u003Cspan class=\\\"token operator\\\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E4\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E255\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E colorScale\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E c\u003Cspan class=\\\"token operator\\\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E4\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E255\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Ecode\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epre\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EWe only iterate the points, but not hte pixels, referenced by \u003Cem\u003Ethis.thread.x\u003C\u002Fem\u003E and \u003Cem\u003Ethis.thread.y\u003C\u002Fem\u003E, that will be done in parallel\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Ch3 id=\\\"hillshade\\\"\u003EHillshade\u003C\u002Fh3\u003E\\n\u003Cp\u003EThe hillshade algorithm depends on the current pixel and the one around it, so it&#39;s possible \u003Ca href=\\\"https:\u002F\u002Fbeta.observablehq.com\u002F@rveciana\u002Fshaded-relief-with-gpujs-and-d3js\\\"\u003Eto use gpu.js easily\u003C\u002Fa\u003E:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\\\"token function\\\"\u003Ehillshade\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003EdemData\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E azimuthrad \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Econstants\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eazimuth _ \u003Cspan class=\\\"token number\\\"\u003E0.017453292519943295\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E altituderad \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Econstants\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003EangleAltitude _ \u003Cspan class=\\\"token number\\\"\u003E0.017453292519943295\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E gradX\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E gradY\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E yPos \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Econstants\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003EySize \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ey\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token operator\\\"\u003E==\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E gradX \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E demData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E demData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token operator\\\"\u003E==\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Econstants\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003ExSize\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E gradX \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E demData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E demData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ey\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eelse\u003C\u002Fspan\u003E gradX \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EdemData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E demData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EdemData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E demData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token operator\\\"\u003E==\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E gradY \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E demData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E demData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token operator\\\"\u003E==\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Econstants\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003EySize\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E gradY \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E demData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E demData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eelse\u003C\u002Fspan\u003E gradY \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EdemData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E demData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EdemData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E demData\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EyPos\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E slope \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E3.141593\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E Math\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eatan\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EMath\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esqrt\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EgradX\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Eem\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003EgradX \u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E gradY\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Eem\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003EgradY\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E aspect \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E Math\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eatan\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003EgradY\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E gradX\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E \u003Cspan class=\\\"token comment\\\"\u003E\u002F\u002Fshould be atan2, but not working!\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E hs\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Eem\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003Evalue \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E Math\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esin\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ealtituderad\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E*\u003C\u002Fspan\u003E Math\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esin\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eslope\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E Math\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ecos\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ealtituderad\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E _ Math\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ecos\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eslope\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \\\\\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Eem\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E Math\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ecos\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eazimuthrad \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E aspect\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ecolor\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ehs_value\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E hs_value\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E hs_value\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0.1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EIf you compare it with the \u003Ca href=\\\"https:\u002F\u002Fbeta.observablehq.com\u002F@rveciana\u002Fshaded-relief\\\"\u003Eoriginal hillshade example\u003C\u002Fa\u003E, the main difference is that no \u003Cem\u003Efor loops\u003C\u002Fem\u003E have to be used to calculate all the pixel values. Instead, the \u003Cem\u003Ethis.thread.x\u003C\u002Fem\u003E and \u003Cem\u003Ethis.thread.y\u003C\u002Fem\u003E variables are used, and all the points will be done at once.\u003C\u002Fli\u003E\\n\u003Cli\u003ENote that \u003Cem\u003EMath.atan\u003C\u002Fem\u003E is used instead of \u003Cem\u003EMath.atan2\u003C\u002Fem\u003E. This is because the \u003Cem\u003EGSLS\u003C\u002Fem\u003E functions have to be used instead of the ones in JavaScript. All the available functions are \u003Ca href=\\\"http:\u002F\u002Fwww.shaderific.com\u002Fglsl-functions\u002F\\\"\u003Ereferenced in their docs\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Ch2 id=\\\"using-it-with-leaflet\\\"\u003EUsing it with Leaflet\u003C\u002Fh2\u003E\\n\u003Cp\u003EUntil now, the examples don&#39;t show an easy way to put a map on the result. A nice option is using Leaflet. Since gpu.js returns a canvas element and Leaflet has the possibility to show it, merging both is not difficult.\\nI&#39;m using \u003Ca href=\\\"https:\u002F\u002Fgist.github.com\u002FSumbera\u002F11114288\\\"\u003Ea small class called canvasOverlay\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\\n\u003Cp\u003EAs you can see in \u003Ca href=\\\"https:\u002F\u002Fbeta.observablehq.com\u002F@rveciana\u002Fleaflet-gpu-js-canvas\\\"\u003Ethis observable\u003C\u002Fa\u003E, the function to call from the canvasOverlay would be like:\\n\u003Cpre\u003E\u003Ccode\u003E\\n\u003Cspan class=\\\"token function-variable function\\\"\u003EdrawCanvas\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003EcanvasOverlay\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E params\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E canvas \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E params\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ecanvas\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E context \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E canvas\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EgetContext\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003Ed\u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\ncontext\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003EglobalAlpha \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0.5\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E gl \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E params\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ecanvas\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EgetContext\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003Ewebgl2\u003Cspan class=\\\"token operator\\\"\u003E&amp;\u003C\u002Fspan\u003E#\u003Cspan class=\\\"token number\\\"\u003E39\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003EpremultipliedAlpha\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\\\"token boolean\\\"\u003Efalse\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E gpu \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\\\"token class-name\\\"\u003EGPU\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\ncanvas\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E\\nwebGl\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E gl\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E krender \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E gpu\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EcreateKernel\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Expos\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E ypos\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E values\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E colorScale\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Epre\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003Ecode\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E nominator\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E denominator\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E flagDist \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Efor\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E i \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E i \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Econstants\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003EnumPoints\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E i\u003Cspan class=\\\"token operator\\\"\u003E++\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n\\n    \u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E dist \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E Math\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Esqrt\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003Expos\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003Ei\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003Expos\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003Ei\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ey\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003Eypos\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003Ei\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ethread\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ey\u003Cspan class=\\\"token operator\\\"\u003E-\u003C\u002Fspan\u003Eypos\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003Ei\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n        nominator\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003Enominator\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Evalues\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003Ei\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edist\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n        denominator\u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003Edenominator\u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edist\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Edist \u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0.1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n            flagDist \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E i\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n        \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E value\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Eif\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EflagDist \u003Cspan class=\\\"token operator\\\"\u003E\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n    value \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E values\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003EflagDist\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E \u003Cspan class=\\\"token keyword\\\"\u003Eelse\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\n    value \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E nominator\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Edenominator\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Evar\u003C\u002Fspan\u003E c \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E Math\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Eceil\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E255\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E*\u003C\u002Fspan\u003E value\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Ethis\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Ecolor\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003EcolorScale\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003Ec\u003Cspan class=\\\"token operator\\\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E4\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E255\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E colorScale\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E c\u003Cspan class=\\\"token operator\\\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E4\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E255\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E colorScale\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E2\u003C\u002Fspan\u003E \u003Cspan class=\\\"token operator\\\"\u003E+\u003C\u002Fspan\u003E c\u003Cspan class=\\\"token operator\\\"\u003E*\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E4\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003E\u003Cspan class=\\\"token number\\\"\u003E255\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Ecode\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E&lt;\u003C\u002Fspan\u003E\u003Cspan class=\\\"token operator\\\"\u003E\u002F\u003C\u002Fspan\u003Epre\u003Cspan class=\\\"token operator\\\"\u003E\u003E\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EsetConstants\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E numPoints\u003Cspan class=\\\"token operator\\\"\u003E:\u003C\u002Fspan\u003E points\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Elength \u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EsetDebug\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token boolean\\\"\u003Etrue\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EsetOutput\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003Ecanvas\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ewidth\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E canvas\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Eheight\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EsetGraphical\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token boolean\\\"\u003Etrue\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E xPos \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E yPos \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E values \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\\\"token punctuation\\\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\npoints\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EforEach\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token keyword\\\"\u003Efunction\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token parameter\\\"\u003Ed\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E{\u003C\u002Fspan\u003E\\nvalues\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Epush\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ed\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Evalue\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E coords \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E canvasOverlay\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E_map\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003ElatLngToContainerPoint\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token constant\\\"\u003EL\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003ElatLng\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ed\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Elat\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E d\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Elon\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\nxPos\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Epush\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ecoords\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ex\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\nyPos\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003Epush\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Ecoords\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003Ey\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\\n\u003Cspan class=\\\"token function\\\"\u003Ekrender\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003ExPos\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E yPos\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E values\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E csImageData\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token keyword\\\"\u003Elet\u003C\u002Fspan\u003E result \u003Cspan class=\\\"token operator\\\"\u003E=\u003C\u002Fspan\u003E krender\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EgetCanvas\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\ncontext\u003Cspan class=\\\"token punctuation\\\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\\\"token function\\\"\u003EdrawImage\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E(\u003C\u002Fspan\u003Eresult\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\\\"token number\\\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\\\"token punctuation\\\"\u003E;\u003C\u002Fspan\u003E\\n\u003Cspan class=\\\"token punctuation\\\"\u003E}\u003C\u002Fspan\u003E\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003EGet the gpujs canvas with \u003Cem\u003EgetCanvas()\u003C\u002Fem\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003EDraw in in the leaflet canvas with \u003Cem\u003Econtext.drawImage(result, 0, 0)\u003C\u002Fem\u003E\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Ch2 id=\\\"links\\\"\u003ELinks\u003C\u002Fh2\u003E\\n\u003Cul\u003E\\n\u003Cli\u003E\u003Ca href=\\\"http:\u002F\u002Fgpu.rocks\\\"\u003EThe gpu.js web site\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FGeneral-purpose_computing_on_graphics_processing_units\\\"\u003EGPGPU Wikipedia page\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fobservablehq.com\\\"\u003EObservableHQ\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fwzrd.in\u002F\\\"\u003Ewzrd.in\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fhackernoon.com\u002Fintroducing-gpu-js-gpu-accelerated-javascript-ba11a6069327\\\"\u003EgenerateMatrices source\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fgithub.com\u002Fgpujs\u002Fgpu.js?utm_source=recordnotfound.com#supported-math-functions\\\"\u003EList of gpu.js supported math functions\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"http:\u002F\u002Fgeoexamples.blogspot.com.es\u002F2012\u002F05\u002Fcreating-grid-from-scattered-data-using.html\\\"\u003ECreating a grid from scattered data using inverse of the distance with python (gdal_grid approach)\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fgist.github.com\u002FSumbera\u002F11114288\\\"\u003EcanvasOverlay\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"http:\u002F\u002Fwww.shaderific.com\u002Fglsl-functions\u002F\\\"\u003EGSLS functions reference\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Ch3 id=\\\"observablehq-notebooks\\\"\u003EObservableHQ notebooks\u003C\u002Fh3\u003E\\n\u003Cul\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fbeta.observablehq.com\u002F@rveciana\u002Fmost-basic-gpu-js-example\\\"\u003EMost basic gpu.js example\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fbeta.observablehq.com\u002F@rveciana\u002Fgpu-js-check-execution-time\\\"\u003EMost basic gpu.js example with performance test\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fbeta.observablehq.com\u002F@rveciana\u002Fbasic-gpu-js-canvas-example\\\"\u003EBasic gpu.js canvas example\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fbeta.observablehq.com\u002F@rveciana\u002Finverse-of-the-distance-with-gpu-js\\\"\u003EInverse of the distance with gpu.js\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fbeta.observablehq.com\u002F@rveciana\u002Fshaded-relief-with-gpujs-and-d3js\\\"\u003EShaded relief with gpu.js and d3.js\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fbeta.observablehq.com\u002F@rveciana\u002Fshaded-relief-with-gpujs-and-d3js\u002F2\\\"\u003EShaded relief with gpu.js drawing the canvas directly\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fbeta.observablehq.com\u002F@rveciana\u002Fshaded-relief\\\"\u003EShaded relief without gpu.js\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fbeta.observablehq.com\u002F@rveciana\u002Fleaflet-gpu-js-canvas\\\"\u003ELeaflet + inverse of the distance\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Ch3 id=\\\"blocks-with-some-of-the-examples\\\"\u003EBlocks with some of the examples\u003C\u002Fh3\u003E\\n\u003Cul\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fbl.ocks.org\u002Frveciana\u002Fc664dffd8b94f0598543958433d415f4\\\"\u003EBasic gpu.js canvas example\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Ca href=\\\"https:\u002F\u002Fbl.ocks.org\u002Frveciana\u002F7419081f8931227769bae5255579e792\\\"\u003EInverse of the distance with gpu.js\u003C\u002Fa\u003E\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\",\"tags\":[\"GPU\",\"gpujs\",\"canvas\"],\"date\":\"2018-04-30T00:00:00.000Z\"}"}</script>
</div>
	</body>
</html>
